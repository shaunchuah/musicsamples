{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to Orca","text":"<p>Meet our friendly Orca, your companion in navigating the data waves. Orca is a collaborative data platform that unifies diverse scientific and clinical datasets. Just as orcas work together in pods to achieve their goals, our platform harnesses the power of teamwork to accelerate scientific discovery and innovation. This documentation guides you through effectively utilizing our integrated datasets.</p> <p></p>"},{"location":"attribution_policy/","title":"Attribution Policy","text":""},{"location":"attribution_policy/#overview","title":"Overview","text":"<p>This document outlines the attribution policy for the use of the datasets provided within the Orca Data Platform. Clinical datasets take a significant amount of time and effort to collect and curate, and it is important that the individuals responsible for this work are acknowledged.</p>"},{"location":"attribution_policy/#policy","title":"Policy","text":"<p>Draft to be completed.</p>"},{"location":"dataset_governance/","title":"Dataset Governance","text":"<p>Here is the list of key contacts for each dataset:</p> Dataset Type Study Source Data Contact Clinical GI-DAMPs Shaun Chuah, Peter Cartlidge Clinical MUSIC Shaun Chuah, Peter Cartlidge Clinical Mini-MUSIC David Wands <p>If there are any errors/omissions please contact Shaun.</p>"},{"location":"issues/","title":"Data Issues","text":"<p>Here is a list of data issues to be aware about:</p>"},{"location":"issues/#disease-activity-definitions-vary-between-studies","title":"Disease activity definitions vary between studies","text":"<p>The <code>disease_activity</code> and <code>physician_global_assessment</code> variables differ between GI-DAMPs, MUSIC, and Mini-MUSIC.</p>"},{"location":"issues/#current-variations-in-disease-activity-classifications-by-study","title":"Current Variations in Disease Activity Classifications by Study","text":"Study Field Name Categories GI-DAMPs ibd_status - Biochemical remission (normal CRP AND FC&lt; 250)- Remission- Active- Highly active (admission for IV steroids)- Not applicable MUSIC physician_global_assessment - Remission- Mildly active- Moderately active- Severely active disease_activity - Biochemical remission- Remission- Active- Biochemically Active- Not applicable Mini-MUSIC physician_global_assessment - Biochemical remission- Clinical remission- Mildly active- Moderately active- Severely active disease_activity - Remission- Mild- Moderate- Severe- Not applicable"},{"location":"issues/#potential-standardized-definition","title":"Potential Standardized Definition","text":"<p>Disease activity could be standardised using these common variables:</p> <ul> <li><code>has_active_symptoms</code> (Boolean)</li> <li><code>crp</code> (mg/L, threshold &gt; 5)</li> <li><code>calprotectin</code> (\u03bcg/g, threshold &gt; 250)</li> </ul>"},{"location":"issues/#example-implementation-logic","title":"Example Implementation Logic","text":"Python<pre><code>def calculate_disease_activity(row):\n    \"\"\"\n    Returns: 'biochem_active' if has_active_symptoms and CRP &gt; 5 and calprotectin &gt; 250, \n            'active' if has_active_symptoms but CRP or calprotectin do not meet above threshold,\n            'remission' if not has_active_symptoms but CRP &gt; 5 or calprotectin &gt; 250,\n            'biochem_remission' if not has_active_symptoms and CRP &lt; 5 and calprotectin &lt; 250.\n    \"\"\"\n    has_active_symptoms = row['has_active_symptoms']\n    crp = row['crp']\n    calprotectin = row['calprotectin']\n\n    if has_active_symptoms:\n        if crp &gt; 5 and calprotectin &gt; 250:\n            return 'biochem_active'\n        else:\n            return 'active'\n    else:\n        if crp &gt; 5 or calprotectin &gt; 250:\n            return 'remission'\n        else:\n            return 'biochem_remission'\n</code></pre>"},{"location":"issues/#example-usage-with-dataframe","title":"Example Usage with DataFrame","text":"Python<pre><code>import pandas as pd\n\ndata = {\n    'has_active_symptoms': [True, False, True, False],\n    'crp': [6.2, 2.1, 7.8, 1.5],\n    'calprotectin': [300, 150, 180, 100]\n}\ndf = pd.DataFrame(data)\n\n# Apply function to DataFrame\ndf['standardised_disease_activity'] = df.apply(calculate_disease_activity, axis=1)\nprint(df)\n</code></pre>"},{"location":"issues/#gi-damps-study-id-format-evolution","title":"GI-DAMPs Study ID Format Evolution","text":""},{"location":"issues/#historical-format","title":"Historical Format","text":"<ul> <li>Initial format: <code>GID-xxx-P</code> or <code>GID-xxx-HC</code></li> <li>xxx: integer with inconsistent leading zeros (e.g., <code>GID-001-P</code> vs <code>GID-1-P</code>)</li> <li>P: Patient, HC: Healthy Control</li> </ul>"},{"location":"issues/#multi-center-expansion","title":"Multi-Center Expansion","text":"<ul> <li>Center-specific formats introduced:</li> <li>Edinburgh: <code>GID-x</code></li> <li>Glasgow: <code>GID-136-x</code></li> <li>Dundee: <code>GID-138-x</code></li> </ul>"},{"location":"issues/#known-issues","title":"Known Issues","text":"<ol> <li>Potential conflicts with Edinburgh legacy IDs <code>GID-136-P</code> and <code>GID-138-P</code></li> <li>Inconsistent formats at Glasgow/Dundee sites (e.g., <code>GID-136-x-P</code>)</li> </ol>"},{"location":"issues/#current-standard-december-2024","title":"Current Standard (December 2024)","text":"<ul> <li>Remove <code>-P</code> and <code>-HC</code> suffixes (use <code>study_group</code> column instead)</li> <li>Use <code>GID-</code> prefix only</li> <li>No leading zeros</li> <li>Center-specific formats:</li> <li>Edinburgh: <code>GID-x</code></li> <li>Glasgow: <code>GID-136-x</code></li> <li>Dundee: <code>GID-138-x</code></li> </ul> <p>\u26a0\ufe0f Important: When merging GI-DAMPs data, carefully check <code>study_id</code> column for legacy formats.</p>"},{"location":"data_dictionary/","title":"Unified Data Dictionary","text":"<p>This standardized data dictionary is used for datasets within G-Trac. Only the common variables across datasets are standardized as shown below. Each study dataset will also include its own study-specific data fields.</p> <p>As a standard style guide, all variables in datasets will follow the snake_case naming convention. All characters will be in lower case, and underscores will be used instead of spaces.</p> Variable Type Values Comments age int bmi float body mass index height int height in cm montreal_cd_behaviour string <code>B1</code>, <code>B2</code>, <code>B3</code> L1: non-stricturing, non-penetrating, L2: stricturing disease, L3: penetrating disease montreal_cd_location string <code>L1</code>, <code>L2</code>, <code>L3</code> L1: ileal only disease, L2: colonic only, L3: ileocolonic involvement montreal_perianal bool 1 or 0 Perianal disease modifier (+p) montreal_uc_extent string <code>E1</code>, <code>E2</code>, <code>E3</code> E1: proctitis only, E2: left-sided disease, E3: extensive montreal_uc_severity string <code>S1</code>, <code>S2</code>, <code>S3</code> S1: mild activity, S2: moderate activity, S3: severe activity (search Montreal UC for full definitions) montreal_upper_gi bool 1 or 0 Upper GI disease modifier (+/- L4) new_diagnosis_of_ibd string <code>yes</code>, <code>no</code> This field previously known as incident_case in mini-music and bl_new_diagnosis in gi-damps sex string <code>male</code>, <code>female</code> study_center string <code>edinburgh</code>, <code>glasgow</code>, <code>dundee</code> study_group string <code>cd</code>, <code>uc</code>, <code>ibdu</code>, <code>non_ibd</code>, <code>await_dx</code>, <code>hc</code> cd: Crohn's disease, uc: Ulcerative colitis, ibdu: Inflammatory bowel disease unclassified, hc: healthy controls, non-ibd: other medical diagnosis possible so not entirely healthy, await_dx: awaiting diagnostic confirmation study_id string <code>MINI-</code> prefix for Mini-MUSIC, <code>MID-</code> prefix for MUSIC, <code>GID-</code> prefix for GI-DAMPs; Note for GI-DAMPs we will drop the suffix of '-P' or '-HC' going forwards. Older samples may require some tweaking before merging. weight float weight in kg"},{"location":"data_dictionary/abbreviations/","title":"Abbreviations","text":"<p>Here is a reference of common abbreviations seen.</p> Abbreviation Definition asa 5-aminosalicylic acid, generally referencing a class of drugs such as mesalazine in its various formulations axr Abdominal X-ray ada Adalimumab tnf Anti-TNFs including infliximab, adalimumab, certolizumab and golimumab abx Antibiotics aza Azathioprine bmi Body mass index crp C-reactive protein ct Computed tomography cucq Crohn's and ulcerative colitis questionnaire-32 cd Crohn's disease esr Erythrocyte sedimentation rate egfr Estimated glomerular filtration rate een Exclusive enteral nutrition eims Extra-intestinal manifestations fh Family history filgo Filgotinib goli Golimumab hbi Harvey-Bradshaw index (clinical activity score for Crohn's disease) hc Healthy control imm Immunomodulators generally defined as azathioprine and mercaptopurine ibd Inflammatory bowel disease ibdu Inflammatory bowel disease unclassified ifx Infliximab ibs Irritable bowel syndrome jaki JAK inhibitors including filgotinib, upadacitinib and tofacitinib mri Magnetic resonance imaging mcv Mean corpuscular volume mp Mercaptopurine mtx Methotrexate pcdai Paediatric Crohn's disease activity index pucai Paediatric ulcerative colitis activity index non_ibd Participants attending hospital but not diagnosed with IBD. Therefore could comprise patients with other medical conditions, not exactly a healthy control pmh Past medical history promis Patient reported outcome measurement information system ppi Proton pump inhibitor/Patient public involvement (context-dependent) qfit Quantitative faecal immunohistochemical test risa Risankizumab sccai Simple clinical colitis activity index (clinical activity score for ulcerative colitis) sescd Simple endoscopic score for Crohn's disease tofa Tofacitinib uc Ulcerative colitis uceis Ulcerative colitis endoscopic index of severity upa Upadacitinib uste Ustekinumab vedo Vedolizumab"},{"location":"data_dictionary/gidamps_columns/","title":"GI-DAMPs","text":"Python<pre><code>[\n    \"study_id\",\n    \"redcap_repeat_instrument\",\n    \"redcap_repeat_instance\",\n    \"study_group\",\n    \"diagnosis_note\",\n    \"baseline_recruitment_type\",\n    \"age\",\n    \"sex\",\n    \"height\",\n    \"weight\",\n    \"bmi\",\n    \"sampling_date\",\n    \"sampling_setting\",\n    \"comment\",\n    \"has_active_symptoms\",\n    \"symptoms_description\",\n    \"sccai_general_well_being\",\n    \"sccai_bowel_frequency_day\",\n    \"sccai_bowel_frequency_night\",\n    \"sccai_urgency\",\n    \"sccai_blood_in_stool\",\n    \"sccai_arthralgia\",\n    \"sccai_uveitis\",\n    \"sccai_erythema_nodosum\",\n    \"sccai_pyoderma\",\n    \"sccai_total\",\n    \"hbi_total\",\n    \"hbi_arthralgia\",\n    \"hbi_uveitis\",\n    \"hbi_erythema_nodosum\",\n    \"hbi_apthous_ulcers\",\n    \"hbi_pyoderma\",\n    \"hbi_anal_fissures\",\n    \"hbi_new_fistula\",\n    \"hbi_abscess\",\n    \"hbi_liquid_stools\",\n    \"hbi_abdominal_mass\",\n    \"hbi_general_well_being\",\n    \"hbi_abdominal_pain\",\n    \"nhs_bloods_date\",\n    \"haemoglobin\",\n    \"haematocrit\",\n    \"red_cell_count\",\n    \"white_cell_count\",\n    \"neutrophils\",\n    \"lymphocytes\",\n    \"monocytes\",\n    \"basophils\",\n    \"eosinophils\",\n    \"platelets\",\n    \"urea\",\n    \"sodium\",\n    \"potassium\",\n    \"creatinine\",\n    \"egfr\",\n    \"crp\",\n    \"albumin\",\n    \"calprotectin_date\",\n    \"calprotectin\",\n    \"drug_level_date\",\n    \"ada_level\",\n    \"ada_antibody\",\n    \"ifx_level\",\n    \"ifx_antibody\",\n    \"sampling_steroids\",\n    \"steroids_detail\",\n    \"iv_steroids\",\n    \"iv_steroids_day\",\n    \"rescue_therapy\",\n    \"rescue_therapy_detail\",\n    \"sampling_asa\",\n    \"sampling_aza\",\n    \"sampling_mp\",\n    \"sampling_ifx\",\n    \"sampling_ada\",\n    \"sampling_vedo\",\n    \"sampling_uste\",\n    \"sampling_tofa\",\n    \"sampling_mtx\",\n    \"sampling_goli\",\n    \"sampling_ciclosporin\",\n    \"sampling_filgo\",\n    \"sampling_upa\",\n    \"sampling_risa\",\n    \"sampling_abx\",\n    \"antibiotics_detail\",\n    \"medication_comments\",\n    \"endoscopy_date\",\n    \"endoscopy_report\",\n    \"pathology_report\",\n    \"mayo_total\",\n    \"uceis_total\",\n    \"sescd_total\",\n    \"endoscopy_active\",\n    \"radiology_test_date\",\n    \"ct_abdomen\",\n    \"mri_small_bowel\",\n    \"mri_pelvis\",\n    \"ct_abdomen_report\",\n    \"mri_small_bowel_report\",\n    \"mri_pelvis_report\",\n    \"radiology_comments\",\n    \"radiology_active\",\n    \"ibd_status\",\n    \"date_of_diagnosis\",\n    \"age_at_diagnosis\",\n    \"new_diagnosis_of_ibd\",\n    \"montreal_uc_extent\",\n    \"montreal_uc_severity\",\n    \"baseline_eims_arthralgia\",\n    \"baseline_eims_ank_spon\",\n    \"baseline_eims_erythema_nodosum\",\n    \"baseline_eims_pyoderma\",\n    \"baseline_eims_uveitis\",\n    \"baseline_eims_episcleritis\",\n    \"baseline_eims_sacroileitis\",\n    \"baseline_eims_none\",\n    \"past_medical_history\",\n    \"past_medical_history_detail\",\n    \"past_ibd_surgery\",\n    \"past_ibd_surgery_detail\",\n    \"ifx\",\n    \"ciclo\",\n    \"ifx_start\",\n    \"ciclo_start\",\n    \"ifx_stop\",\n    \"ciclo_stop\",\n    \"ada\",\n    \"ada_start\",\n    \"ada_stop\",\n    \"vedo\",\n    \"vedo_start\",\n    \"vedo_stop\",\n    \"uste\",\n    \"uste_start\",\n    \"uste_stop\",\n    \"tofa\",\n    \"tofa_start\",\n    \"tofa_stop\",\n    \"golim\",\n    \"golim_start\",\n    \"golim_stop\",\n    \"filgo\",\n    \"filgo_start\",\n    \"filgo_stop\",\n    \"upa\",\n    \"upa_start\",\n    \"upa_stop\",\n    \"risa\",\n    \"risa_start\",\n    \"risa_stop\",\n    \"aza\",\n    \"aza_start\",\n    \"aza_stop\",\n    \"mp\",\n    \"mp_start\",\n    \"mp_stop\",\n    \"mtx\",\n    \"mtx_start\",\n    \"mtx_stop\",\n    \"gi_questionnaire_date\",\n    \"giq_ethnicity\",\n    \"giq_ethicity_text\",\n    \"giq_are_you_in_good_health\",\n    \"giq_good_health_text\",\n    \"giq_long_term_medication\",\n    \"giq_long_term_medication_text\",\n    \"smoking_status\",\n    \"giq_smoking_status_at_diagnosis\",\n    \"giq_strenous_exercise_last_48h\",\n    \"giq_strenous_exercise_last_48h_text\",\n    \"giq_do_you_drink_alcohol\",\n    \"giq_alcohol_consumption\",\n    \"family_history_of_ibd\",\n    \"family_history_relationship\",\n    \"family_history_diagnosis\",\n    \"other_family_diagnosis\",\n    \"previous_tonsillectomy\",\n    \"age_or_year_of_tonsillectomy\",\n    \"previous_appendicectomy\",\n    \"age_or_year_of_appendicectomy\",\n    \"patient_reported_health_status\",\n    \"participant_questionnaire_comments\",\n    \"cucq_date\",\n    \"cucq_1\",\n    \"cucq_2\",\n    \"cucq_3\",\n    \"cucq_4\",\n    \"cucq_5\",\n    \"cucq_6\",\n    \"cucq_7\",\n    \"cucq_8\",\n    \"cucq_9\",\n    \"cucq_10\",\n    \"cucq_11\",\n    \"cucq_12\",\n    \"cucq_13\",\n    \"cucq_14\",\n    \"cucq_15\",\n    \"cucq_16\",\n    \"cucq_17\",\n    \"cucq_18\",\n    \"cucq_19\",\n    \"cucq_20\",\n    \"cucq_21\",\n    \"cucq_22\",\n    \"cucq_23\",\n    \"cucq_24\",\n    \"cucq_25\",\n    \"cucq_26\",\n    \"cucq_27\",\n    \"cucq_28\",\n    \"cucq_29\",\n    \"cucq_30\",\n    \"cucq_31\",\n    \"cucq_32\",\n    \"cucq_comments\",\n    \"cucq_total\",\n    \"cucq32_complete\",\n    \"diagnosis_duration_in_days\",\n    \"montreal_cd_behaviour\",\n    \"montreal_perianal\",\n    \"montreal_cd_location\",\n    \"montreal_upper_gi\",\n    \"endoscopy_type\",\n    \"baseline_thiopurine_exposure\",\n    \"baseline_anti_tnf_exposure\",\n    \"baseline_biologic_exposure\",\n    \"baseline_jak_exposure\",\n    \"study_center\",\n]\n</code></pre>"},{"location":"data_dictionary/mini_music_columns/","title":"Mini-MUSIC","text":"Python<pre><code>[\n    \"study_id\",\n    \"redcap_event_name\",\n    \"study_center\",\n    \"age\",\n    \"patient_age_group\",\n    \"sex\",\n    \"study_group\",\n    \"new_diagnosis_of_ibd\",\n    \"diagnosis_comments\",\n    \"date_of_diagnosis\",\n    \"age_at_diagnosis\",\n    \"promis_fatigue_score\",\n    \"impact3_score\",\n    \"impact_wellbeing\",\n    \"impact_emotional\",\n    \"impact_social\",\n    \"impact_bodyimage\",\n    \"pucai_score\",\n    \"pucai_pain\",\n    \"pucai_bleeding\",\n    \"pucai_consistency\",\n    \"pucai_stools\",\n    \"pucai_nocturnal\",\n    \"pucai_activity\",\n    \"pcdai_pain\",\n    \"pcdai_general\",\n    \"pcdai_frequency\",\n    \"pcdai_esr\",\n    \"pcdai_alb\",\n    \"pcdai_weight\",\n    \"pcdai_perianal\",\n    \"pcdai_eim\",\n    \"pcdai_eim_fever\",\n    \"pcdai_eim_arthritis\",\n    \"pcdai_eim_uveitis\",\n    \"pcdai_eim_erythema_nodosum\",\n    \"pcdai_eim_pyoderma\",\n    \"pcdai_eim_other\",\n    \"pcdai_score\",\n    \"cdparis_upper_gi\",\n    \"cdparis_behaviour\",\n    \"cdparis_location\",\n    \"cdparis_growth\",\n    \"cdparis_perianal\",\n    \"ucparis_severity\",\n    \"ucparis_extent\",\n    \"een_use\",\n    \"een_formula_type\",\n    \"een_formula_type_text\",\n    \"een_start_date\",\n    \"een_end_date\",\n    \"een_still_taken\",\n    \"height\",\n    \"weight\",\n    \"bmi\",\n    \"has_active_symptoms\",\n    \"physician_global_assessment\",\n    \"disease_activity\",\n    \"symptoms_abdominal_pain\",\n    \"symptoms_diarrhoea\",\n    \"symptoms_urgency\",\n    \"symptoms_pr_bleeding\",\n    \"symptoms_weight_loss\",\n    \"symptoms_fatigue\",\n    \"symptoms_perianal\",\n    \"symptoms_other_text\",\n    \"impact3_total\",\n    \"paris_change\",\n    \"disease_activity_score_comments\",\n    \"unplanned_hospital_admission\",\n    \"new_flare_up\",\n    \"flare_up_1_date\",\n    \"flare_up_1_description_abdominal_pain\",\n    \"flare_up_1_description_diarrhoea\",\n    \"flare_up_1_description_urgency\",\n    \"flare_up_1_description_pr_bleeding\",\n    \"flare_up_1_description_weight_loss\",\n    \"flare_up_1_description_fever\",\n    \"flare_up_1_description_perianal\",\n    \"flare_up_1_setting\",\n    \"flare_up_1_management_iv_steroids\",\n    \"flare_up_1_management_oral_steroids\",\n    \"flare_up_1_management_een\",\n    \"flare_up_1_management_new_biologic\",\n    \"flare_up_1_management_other\",\n    \"flare_up_1_management_other_text\",\n    \"flare_up_2_description_abdominal_pain\",\n    \"flare_up_2_description_diarrhoea\",\n    \"flare_up_2_description_urgency\",\n    \"flare_up_2_description_pr_bleeding\",\n    \"flare_up_2_description_weight_loss\",\n    \"flare_up_2_description_fever\",\n    \"flare_up_2_description_perianal\",\n    \"flare_up_2_management_iv_steroids\",\n    \"flare_up_2_management_oral_steroids\",\n    \"flare_up_2_management_een\",\n    \"flare_up_2_management_new_biologic\",\n    \"flare_up_2_management_other\",\n    \"steroid_use_1_reason\",\n    \"steroid_use_1_reason_text\",\n    \"steroid_use_1_drug\",\n    \"steroid_use_1_start_date\",\n    \"steroid_use_1_still_taking\",\n    \"steroid_use_1_end_date\",\n    \"steroid_use_1_reason_stopped\",\n    \"steroid_use_1_reason_changed_text\",\n    \"steroid_use_2_drug\",\n    \"steroid_use_2_start_date\",\n    \"steroid_use_2_still_taking\",\n    \"steroid_use_2_end_date\",\n    \"steroid_use_2_reason_stopped\",\n    \"hospital_admission_1_for_acute_severe_colitis\",\n    \"hospital_admission_1_for_ibd_flare_not_asc\",\n    \"hospital_admission_1_for_perianal_disease\",\n    \"hospital_admission_1_for_surgery\",\n    \"hospital_admission_1_for_investigation_not_meeting_other_criteria\",\n    \"hospital_admission_1_for_other\",\n    \"hospital_admission_2_for_acute_severe_colitis\",\n    \"hospital_admission_2_for_ibd_flare_not_asc\",\n    \"hospital_admission_2_for_perianal_disease\",\n    \"hospital_admission_2_for_surgery\",\n    \"hospital_admission_2_for_investigation_not_meeting_other_criteria\",\n    \"hospital_admission_2_for_other\",\n    \"hospital_admission_1_admission_date\",\n    \"hospital_admission_1_discharge_date\",\n    \"hospital_admission_comments\",\n    \"new_oral_steroids_since_last_visit\",\n    \"baseline_previous_ibd_treatment\",\n    \"baseline_eims_none\",\n    \"baseline_eims_arthritis\",\n    \"baseline_eims_erythema_nodosum\",\n    \"baseline_eims_pyoderma\",\n    \"baseline_eims_uveitis\",\n    \"baseline_eims_episcleritis\",\n    \"baseline_eims_iritis_scleritis\",\n    \"baseline_eims_sacroileitis\",\n    \"baseline_eims_conjunctivitis\",\n    \"baseline_eims_angular_cheilitis\",\n    \"baseline_eims_other\",\n    \"baseline_ibd_drug_1\",\n    \"baseline_ibd_drug_1_other\",\n    \"baseline_ibd_drug_1_other_text\",\n    \"baseline_ibd_drug_1_dose\",\n    \"baseline_ibd_drug_1_frequency\",\n    \"baseline_ibd_drug_1_start_date\",\n    \"baseline_ibd_drug_1_end_date\",\n    \"baseline_ibd_drug_1_reason_stopped\",\n    \"baseline_ibd_drug_1_reason_stopped_text\",\n    \"baseline_ibd_drug_2\",\n    \"baseline_ibd_drug_2_other\",\n    \"baseline_ibd_drug_2_other_text\",\n    \"baseline_ibd_drug_2_dose\",\n    \"baseline_ibd_drug_2_frequency\",\n    \"baseline_ibd_drug_2_start_date\",\n    \"baseline_ibd_drug_2_end_date\",\n    \"baseline_ibd_drug_2_reason_stopped\",\n    \"baseline_ibd_drug_3\",\n    \"baseline_ibd_drug_3_dose\",\n    \"baseline_ibd_drug_3_frequency\",\n    \"baseline_ibd_drug_3_frequency_other\",\n    \"baseline_ibd_drug_3_start_date\",\n    \"baseline_ibd_drug_3_end_date\",\n    \"baseline_ibd_drug_3_reason_stopped\",\n    \"baseline_ibd_drug_3_reason_stopped_text\",\n    \"surgery_histology_comments\",\n    \"previous_appendicectomy\",\n    \"previous_tonsillectomy\",\n    \"baseline_eims_psc\",\n    \"tonsillectomy_age\",\n    \"pmh_1_diagnosis\",\n    \"pmh_1_active\",\n    \"pmh_2_active\",\n    \"pmh_2_diagnosis\",\n    \"pmh_comments\",\n    \"fh_number_brothers\",\n    \"fh_number_sisters\",\n    \"fh_number_siblings\",\n    \"fh_of_ibd_present\",\n    \"fh_of_ibd_number_affected\",\n    \"fh_1_relationship\",\n    \"fh_1_age_at_diagnosis\",\n    \"fh_1_diagnosis\",\n    \"fh_2_relationship\",\n    \"fh_2_age_at_diagnosis\",\n    \"fh_2_diagnosis\",\n    \"fh_2_diagnosis_other\",\n    \"fh_2_diagnosis_other_text\",\n    \"fh_comments\",\n    \"sampling_on_no_meds\",\n    \"sampling_asa\",\n    \"sampling_een\",\n    \"sampling_steroids_oral\",\n    \"sampling_steroids_iv\",\n    \"sampling_steroids_topical\",\n    \"sampling_imm\",\n    \"sampling_mtx\",\n    \"sampling_ifx\",\n    \"sampling_ada\",\n    \"sampling_vedo\",\n    \"sampling_uste\",\n    \"sampling_other\",\n    \"sampling_other_text\",\n    \"ibd_drug_1_reason_stopped\",\n    \"ibd_drug_1_name\",\n    \"ibd_drug_1_name_other\",\n    \"ibd_drug_1_dose\",\n    \"ibd_drug_1_frequency\",\n    \"ibd_drug_1_frequency_other\",\n    \"ibd_drug_1_start_date\",\n    \"ibd_drug_1_end_date\",\n    \"ibd_drug_1_reason_stopped_text\",\n    \"ibd_drug_2_name\",\n    \"ibd_drug_2_name_other\",\n    \"ibd_drug_2_dose\",\n    \"ibd_drug_2_frequency\",\n    \"ibd_drug_2_frequency_other\",\n    \"ibd_drug_2_start_date\",\n    \"ibd_drug_2_still_taking\",\n    \"ibd_drug_1_still_taking\",\n    \"ibd_drug_2_end_date\",\n    \"ibd_drug_2_reason_stopped\",\n    \"ibd_drug_2_reason_stopped_text\",\n    \"ibd_drug_3_name\",\n    \"ibd_drug_3_name_other\",\n    \"ibd_drug_3_dose\",\n    \"ibd_drug_3_frequency\",\n    \"ibd_drug_3_start_date\",\n    \"ibd_drug_3_still_taking\",\n    \"ibd_drug_3_end_date\",\n    \"ibd_drug_3_reason_stopped\",\n    \"ibd_drug_4_name\",\n    \"ibd_drug_4_dose\",\n    \"ibd_drug_4_frequency\",\n    \"ibd_drug_4_start_date\",\n    \"ibd_drug_4_still_taking\",\n    \"ibd_drug_4_reason_stopped\",\n    \"ibd_drug_4_reason_stopped_text\",\n    \"ibd_drug_5_name\",\n    \"ibd_drug_5_name_other\",\n    \"ibd_drug_5_dose\",\n    \"ibd_drug_5_frequency\",\n    \"ibd_drug_5_start_date\",\n    \"ibd_drug_5_still_taking\",\n    \"concomitant_non_ibd_drug\",\n    \"concomitant_drug_1_name\",\n    \"concomitant_drug_1_name_other\",\n    \"concomitant_drug_1_dose\",\n    \"concomitant_drug_1_frequency\",\n    \"concomitant_drug_2_name\",\n    \"concomitant_drug_2_name_other\",\n    \"concomitant_drug_2_dose\",\n    \"concomitant_drug_2_frequency\",\n    \"concomitant_drug_2_frequency_other\",\n    \"concomitant_drug_3_name\",\n    \"concomitant_drug_3_name_other\",\n    \"concomitant_drug_3_dose\",\n    \"concomitant_drug_3_frequency\",\n    \"concomitant_drug_4_name\",\n    \"concomitant_drug_4_name_other\",\n    \"concomitant_drug_4_dose\",\n    \"concomitant_drug_4_frequency\",\n    \"current_drugs_comments\",\n    \"endoscopy_date\",\n    \"endoscopy_type_colonoscopy\",\n    \"endoscopy_type_upper_gi_endoscopy\",\n    \"endoscopy_report\",\n    \"pathology_report\",\n    \"mayo_endoscopic_findings\",\n    \"sescd_calc\",\n    \"sescd_noncalc\",\n    \"physician_endoscopic_severity\",\n    \"ct_abdomen_pelvis\",\n    \"axr\",\n    \"uss_abdomen\",\n    \"mri_small_bowel\",\n    \"mri_pelvis\",\n    \"uss_abdomen_date\",\n    \"uss_abdomen_report\",\n    \"mri_small_bowel_date\",\n    \"mri_small_bowel_report\",\n    \"ibd_surgery_performed\",\n    \"saliva_sample\",\n    \"saliva_setting\",\n    \"sample_date\",\n    \"saliva_eim\",\n    \"eims_details\",\n    \"saliva_abx\",\n    \"abx_detail\",\n    \"saliva_abx3m\",\n    \"abx3m_detail\",\n    \"saliva_piercing\",\n    \"saliva_brushing\",\n    \"saliva_brush_tongue\",\n    \"saliva_dietibd\",\n    \"saliva_diet_details\",\n    \"saliva_cs\",\n    \"saliva_denture\",\n    \"dentures_details\",\n    \"comments_saliva\",\n    \"esr\",\n    \"albumin\",\n    \"crp\",\n    \"nhs_bloods_date\",\n    \"haemoglobin\",\n    \"mcv\",\n    \"haematocrit\",\n    \"white_cell_count\",\n    \"neutrophils\",\n    \"lymphocytes\",\n    \"monocytes\",\n    \"eosinophils\",\n    \"basophils\",\n    \"platelets\",\n    \"urea\",\n    \"creatinine\",\n    \"sodium\",\n    \"potassium\",\n    \"bilirubin\",\n    \"calprotectin_date\",\n    \"calprotectin\",\n    \"other_drug_level\",\n    \"drug_level_date\",\n    \"ada_level\",\n    \"ada_antibody\",\n    \"ifx_level\",\n    \"ifx_antibody\",\n    \"lab_tests_comments\",\n    \"impactq1\",\n    \"impactq2\",\n    \"impactq3\",\n    \"impactq4\",\n    \"impactq5\",\n    \"impactq6\",\n    \"impactq7\",\n    \"impactq8\",\n    \"impactq9\",\n    \"impactq10\",\n    \"impactq11\",\n    \"impactq12\",\n    \"impactq13\",\n    \"impactq14\",\n    \"impactq15\",\n    \"impactq16\",\n    \"impactq17\",\n    \"impactq18\",\n    \"impactq19\",\n    \"impactq20\",\n    \"impactq21\",\n    \"impactq22\",\n    \"impactq23\",\n    \"impactq24\",\n    \"impactq25\",\n    \"impactq26\",\n    \"impactq27\",\n    \"impactq28\",\n    \"impactq29\",\n    \"impactq30\",\n    \"impactq31\",\n    \"impactq32\",\n    \"impactq33\",\n    \"impactq34\",\n    \"impactq35\",\n    \"fatigueq1\",\n    \"fatigueq2\",\n    \"fatigueq3\",\n    \"fatigueq4\",\n    \"fatigueq5\",\n    \"fatigueq6\",\n    \"fatigueq7\",\n    \"fatigueq8\",\n    \"fatigueq9\",\n    \"fatigueq10\",\n    \"proms_comments\",\n]\n</code></pre>"},{"location":"data_dictionary/music_columns/","title":"MUSIC","text":""},{"location":"data_dictionary/music_columns/#music-main-dataframe-columns","title":"MUSIC Main DataFrame Columns","text":"Python<pre><code>[\n  \"study_id\",\n  \"redcap_event_name\",\n  \"age\",\n  \"sex\",\n  \"study_group\",\n  \"diagnosis_comments\",\n  \"date_of_diagnosis\",\n  \"age_at_diagnosis\",\n  \"cucq_date\",\n  \"cucq_1\",\n  \"cucq_2\",\n  \"cucq_3\",\n  \"cucq_4\",\n  \"cucq_5\",\n  \"cucq_6\",\n  \"cucq_7\",\n  \"cucq_8\",\n  \"cucq_9\",\n  \"cucq_10\",\n  \"cucq_11\",\n  \"cucq_12\",\n  \"cucq_13\",\n  \"cucq_14\",\n  \"cucq_15\",\n  \"cucq_16\",\n  \"cucq_17\",\n  \"cucq_18\",\n  \"cucq_19\",\n  \"cucq_20\",\n  \"cucq_21\",\n  \"cucq_22\",\n  \"cucq_23\",\n  \"cucq_24\",\n  \"cucq_25\",\n  \"cucq_26\",\n  \"cucq_27\",\n  \"cucq_28\",\n  \"cucq_29\",\n  \"cucq_30\",\n  \"cucq_31\",\n  \"cucq_32\",\n  \"proms_comments\",\n  \"smoking_status\",\n  \"when_smoking_stopped\",\n  \"when_smoking_stopped_units\",\n  \"height\",\n  \"weight\",\n  \"bmi\",\n  \"has_active_symptoms\",\n  \"visit_date\",\n  \"physician_global_assessment\",\n  \"disease_activity\",\n  \"symptoms_description\",\n  \"cucq_total\",\n  \"change_in_montreal\",\n  \"disease_activity_score_date\",\n  \"hbi_general_well_being\",\n  \"hbi_abdominal_pain\",\n  \"hbi_abdominal_mass\",\n  \"hbi_liquid_stools_present\",\n  \"hbi_liquid_stools\",\n  \"hbi_no_complications\",\n  \"hbi_arthralgia\",\n  \"hbi_uveitis\",\n  \"hbi_erythema_nodosum\",\n  \"hbi_apthous_ulcers\",\n  \"hbi_pyoderma\",\n  \"hbi_anal_fissures\",\n  \"hbi_new_fistula\",\n  \"hbi_abscess\",\n  \"sccai_bowel_frequency_day\",\n  \"sccai_bowel_frequency_night\",\n  \"sccai_urgency\",\n  \"sccai_blood_in_stool\",\n  \"sccai_general_well_being\",\n  \"sccai_no_complications\",\n  \"sccai_erythema_nodosum\",\n  \"sccai_pyoderma\",\n  \"sccai_arthralgia\",\n  \"sccai_uveitis\",\n  \"sccai_total\",\n  \"hbi_total\",\n  \"disease_activity_score_comments\",\n  \"mayo_stool_frequency\",\n  \"mayo_rectal_bleeding\",\n  \"mayo_physician_global_assessment\",\n  \"mayo_total\",\n  \"unplanned_hospital_admission\",\n  \"new_flare_up\",\n  \"flare_up_1_date\",\n  \"flare_up_1_description\",\n  \"flare_up_1_management_community\",\n  \"flare_up_1_management_inpatient\",\n  \"flare_up_1_management_oral_steroids\",\n  \"flare_up_1_management_asa\",\n  \"flare_up_1_management_dietetics\",\n  \"flare_up_1_management_other\",\n  \"flare_up_1_management_other_text\",\n  \"flare_up_2_date\",\n  \"flare_up_2_description\",\n  \"flare_up_2_management_community\",\n  \"flare_up_2_management_inpatient\",\n  \"flare_up_2_management_oral_steroids\",\n  \"flare_up_2_management_asa\",\n  \"flare_up_2_management_dietetics\",\n  \"flare_up_2_management_other\",\n  \"flare_up_2_management_other_text\",\n  \"flare_up_comments\",\n  \"steroid_use_1_reason\",\n  \"steroid_use_1_reason_text\",\n  \"steroid_use_1_drug\",\n  \"steroid_use_1_dose\",\n  \"steroid_use_1_frequency\",\n  \"steroid_use_1_frequency_text\",\n  \"steroid_use_1_start_date\",\n  \"steroid_use_1_still_taking\",\n  \"steroid_use_1_end_date\",\n  \"steroid_use_1_reason_stopped\",\n  \"steroid_use_1_reason_changed_text\",\n  \"steroid_use_2_reason\",\n  \"steroid_use_2_drug\",\n  \"steroid_use_2_dose\",\n  \"steroid_use_2_frequency\",\n  \"steroid_use_2_frequency_text\",\n  \"steroid_use_2_start_date\",\n  \"steroid_use_2_still_taking\",\n  \"steroid_use_2_end_date\",\n  \"steroid_use_2_reason_stopped\",\n  \"steroid_use_2_reason_changed_text\",\n  \"hospital_admission_1_for_acute_severe_colitis\",\n  \"hospital_admission_1_for_ibd_flare_not_asc\",\n  \"hospital_admission_1_for_perianal_disease\",\n  \"hospital_admission_1_for_surgery\",\n  \"hospital_admission_1_for_investigation_not_meeting_other_criteria\",\n  \"hospital_admission_1_for_other\",\n  \"hospital_admission_1_for_other_text\",\n  \"hospital_admission_2_for_other_text\",\n  \"hospital_admission_2_for_acute_severe_colitis\",\n  \"hospital_admission_2_for_ibd_flare_not_asc\",\n  \"hospital_admission_2_for_perianal_disease\",\n  \"hospital_admission_2_for_surgery\",\n  \"hospital_admission_2_for_investigation_not_meeting_other_criteria\",\n  \"hospital_admission_2_for_other\",\n  \"hospital_admission_1_admission_date\",\n  \"hospital_admission_2_admission_date\",\n  \"hospital_admission_1_discharge_date\",\n  \"hospital_admission_2_discharge_date\",\n  \"hospital_admission_comments\",\n  \"new_oral_steroids_since_last_visit\",\n  \"montreal_classification_date\",\n  \"montreal_cd_location\",\n  \"montreal_cd_behaviour\",\n  \"montreal_perianal\",\n  \"montreal_upper_gi\",\n  \"montreal_uc_extent\",\n  \"montreal_uc_severity\",\n  \"montreal_classification_comments\",\n  \"baseline_previous_ibd_treatment\",\n  \"baseline_eims_arthralgia\",\n  \"baseline_eims_ank_spon\",\n  \"baseline_eims_erythema_nodosum\",\n  \"baseline_eims_pyoderma\",\n  \"baseline_eims_uveitis\",\n  \"baseline_eims_episcleritis\",\n  \"baseline_eims_none\",\n  \"baseline_eims_iritis_scleritis\",\n  \"baseline_eims_sacroileitis\",\n  \"baseline_eims_conjunctivitis\",\n  \"baseline_eims_angular_cheilitis\",\n  \"baseline_eims_other\",\n  \"baseline_eims_other_text\",\n  \"baseline_surgical_history\",\n  \"endoscopy_prior_to_recruitment_date\",\n  \"endoscopy_prior_to_recruitment_colonoscopy\",\n  \"endoscopy_prior_to_recruitment_flexible_sigmoidoscopy\",\n  \"endoscopy_prior_to_recruitment_report\",\n  \"endoscopy_prior_to_recruitment_mayo_score\",\n  \"endoscopy_prior_to_recruitment_uceis_score\",\n  \"radiology_prior_to_recruitment_date\",\n  \"radiology_prior_to_recruitment_ctap\",\n  \"radiology_prior_to_recruitment_mri_sb\",\n  \"radiology_prior_to_recruitment_mri_pelvis\",\n  \"radiology_prior_to_recruitment_report\",\n  \"histology_prior_to_recruitment_date\",\n  \"histology_prior_to_recruitment_report\",\n  \"surgical_history_number\",\n  \"surgical_history_1_date\",\n  \"surgical_history_1_report\",\n  \"surgical_history_2_date\",\n  \"surgical_history_2_report\",\n  \"surgical_history_3_date\",\n  \"surgical_history_3_report\",\n  \"phenotyping_comments\",\n  \"previous_appendicectomy\",\n  \"previous_tonsillectomy\",\n  \"appendicectomy_age\",\n  \"tonsillectomy_age\",\n  \"pmh_1_start_date\",\n  \"pmh_1_end_date\",\n  \"pmh_1_diagnosis\",\n  \"pmh_2_start_date\",\n  \"pmh_2_end_date\",\n  \"pmh_2_diagnosis\",\n  \"pmh_3_start_date\",\n  \"pmh_3_end_date\",\n  \"pmh_3_diagnosis\",\n  \"pmh_4_start_date\",\n  \"pmh_4_end_date\",\n  \"pmh_4_diagnosis\",\n  \"pmh_5_start_date\",\n  \"pmh_5_end_date\",\n  \"pmh_5_diagnosis\",\n  \"pmh_comments\",\n  \"fh_number_brothers\",\n  \"fh_number_sisters\",\n  \"fh_number_siblings\",\n  \"fh_number_daughters\",\n  \"fh_number_sons\",\n  \"fh_number_children\",\n  \"fh_of_ibd_present\",\n  \"fh_of_ibd_number_affected\",\n  \"fh_1_relationship\",\n  \"fh_1_age_at_diagnosis\",\n  \"fh_1_diagnosis\",\n  \"fh_1_diagnosis_other\",\n  \"fh_2_relationship\",\n  \"fh_2_age_at_diagnosis\",\n  \"fh_2_diagnosis\",\n  \"fh_2_diagnosis_other\",\n  \"fh_2_diagnosis_other_text\",\n  \"fh_3_relationship\",\n  \"fh_3_age_at_diagnosis\",\n  \"fh_3_diagnosis\",\n  \"fh_3_diagnosis_other\",\n  \"fh_4_relationship\",\n  \"fh_4_age_at_diagnosis\",\n  \"fh_4_diagnosis\",\n  \"fh_comments\",\n  \"endoscopy_date\",\n  \"endoscopy_type_colonoscopy\",\n  \"endoscopy_type_flexible_sigmoidoscopy\",\n  \"upload_endoscopic_image\",\n  \"endoscopy_report\",\n  \"pathology_report\",\n  \"mayo_endoscopic_score\",\n  \"uceis\",\n  \"sescd\",\n  \"physician_endoscopic_severity\",\n  \"endoscopy_comments\",\n  \"endoscopic_mucosal_healing\",\n  \"complete_mucosal_healing\",\n  \"radiology_test_date\",\n  \"ct_abdomen_pelvis\",\n  \"axr\",\n  \"uss_abdomen\",\n  \"mri_small_bowel\",\n  \"mri_pelvis\",\n  \"ct_abdomen_pelvis_report\",\n  \"axr_report\",\n  \"uss_abdomen_report\",\n  \"mri_small_bowel_report\",\n  \"mri_pelvis_report\",\n  \"radiology_report_summary\",\n  \"ibd_surgery_performed\",\n  \"ibd_surgery_date\",\n  \"ibd_surgery_procedure\",\n  \"ibd_surgery_procedure_other\",\n  \"ibd_surgery_procedure_other_text\",\n  \"ibd_surgery_comments\",\n  \"ibd_surgery_histology_report\",\n  \"saliva_sample_complete\",\n  \"sampling_imm\",\n  \"sampling_tnf\",\n  \"sampling_jaki\",\n  \"sampling_steroids\",\n  \"sampling_abx\",\n  \"sampling_asa\",\n  \"sampling_ppi\",\n  \"sampling_steroid_details\",\n  \"sampling_aza\",\n  \"sampling_mp\",\n  \"sampling_ifx\",\n  \"sampling_ada\",\n  \"sampling_vedo\",\n  \"sampling_uste\",\n  \"sampling_tofa\",\n  \"sampling_mtx\",\n  \"sampling_ciclosporin\",\n  \"sampling_filgo\",\n  \"sampling_upa\",\n  \"sampling_risa\",\n  \"baseline_asa\",\n  \"baseline_mtx\",\n  \"baseline_ifx\",\n  \"baseline_ada\",\n  \"baseline_aza\",\n  \"baseline_mp\",\n  \"baseline_uste\",\n  \"baseline_vedo\",\n  \"baseline_goli\",\n  \"baseline_tofa\",\n  \"baseline_filgo\",\n  \"baseline_risa\",\n  \"qfit_result\",\n  \"qfit_result_date\",\n  \"albumin\",\n  \"crp\",\n  \"nhs_bloods_date\",\n  \"haemoglobin\",\n  \"red_cell_count\",\n  \"haematocrit\",\n  \"white_cell_count\",\n  \"neutrophils\",\n  \"lymphocytes\",\n  \"monocytes\",\n  \"eosinophils\",\n  \"basophils\",\n  \"platelets\",\n  \"egfr\",\n  \"qfit_comment\",\n  \"urea\",\n  \"creatinine\",\n  \"sodium\",\n  \"potassium\",\n  \"bilirubin\",\n  \"calprotectin_date\",\n  \"calprotectin\",\n  \"drug_level_date\",\n  \"ada_level\",\n  \"ada_antibody\",\n  \"ifx_level\",\n  \"ifx_antibody\",\n  \"lab_tests_comments\",\n  \"saliva_rev_date\",\n  \"saliva_sample\",\n  \"saliva_setting\",\n  \"sample_date\",\n  \"saliva_eim\",\n  \"eims_details\",\n  \"saliva_abx\",\n  \"abx_detail\",\n  \"saliva_abx3m\",\n  \"abx3m_detail\",\n  \"saliva_piercing\",\n  \"saliva_brushing\",\n  \"saliva_brush_tongue\",\n  \"saliva_dietibd\",\n  \"diet_details\",\n  \"saliva_cs\",\n  \"saliva_denture\",\n  \"dentures_details\",\n  \"comments_saliva\",\n  \"surgical_history_1_procedure\",\n  \"surgical_history_2_procedure\",\n  \"surgical_history_3_procedure\",\n  \"study_center\",\n  \"endoscopic_mucosal_healing_at_3_6_months\",\n  \"complete_mucosal_healing_at_3_6_months\",\n  \"endoscopic_mucosal_healing_at_12_months\",\n  \"complete_mucosal_healing_at_12_months\"\n]\n</code></pre>"},{"location":"data_dictionary/music_columns/#music-demographics-dataframe-columns","title":"MUSIC Demographics DataFrame Columns","text":"<p>This is a subset of the main music dataframe, keeping only <code>timepoint_1</code> and reducing the number of columns retrieved.</p> Python<pre><code>[\n  \"study_id\",\n  \"redcap_event_name\",\n  \"age\",\n  \"sex\",\n  \"study_group\",\n  \"diagnosis_comments\",\n  \"date_of_diagnosis\",\n  \"age_at_diagnosis\",\n  \"smoking_status\",\n  \"when_smoking_stopped\",\n  \"when_smoking_stopped_units\",\n  \"height\",\n  \"weight\",\n  \"bmi\",\n  \"has_active_symptoms\",\n  \"visit_date\",\n  \"physician_global_assessment\",\n  \"disease_activity\",\n  \"symptoms_description\",\n  \"cucq_total\",\n  \"change_in_montreal\",\n  \"disease_activity_score_date\",\n  \"sccai_total\",\n  \"hbi_total\",\n  \"disease_activity_score_comments\",\n  \"mayo_total\",\n  \"montreal_classification_date\",\n  \"montreal_cd_location\",\n  \"montreal_cd_behaviour\",\n  \"montreal_perianal\",\n  \"montreal_upper_gi\",\n  \"montreal_uc_extent\",\n  \"montreal_uc_severity\",\n  \"montreal_classification_comments\",\n  \"baseline_previous_ibd_treatment\",\n  \"baseline_eims_arthralgia\",\n  \"baseline_eims_ank_spon\",\n  \"baseline_eims_erythema_nodosum\",\n  \"baseline_eims_pyoderma\",\n  \"baseline_eims_uveitis\",\n  \"baseline_eims_episcleritis\",\n  \"baseline_eims_none\",\n  \"baseline_eims_iritis_scleritis\",\n  \"baseline_eims_sacroileitis\",\n  \"baseline_eims_conjunctivitis\",\n  \"baseline_eims_angular_cheilitis\",\n  \"baseline_eims_other\",\n  \"baseline_eims_other_text\",\n  \"baseline_surgical_history\",\n  \"endoscopy_prior_to_recruitment_date\",\n  \"endoscopy_prior_to_recruitment_colonoscopy\",\n  \"endoscopy_prior_to_recruitment_flexible_sigmoidoscopy\",\n  \"endoscopy_prior_to_recruitment_report\",\n  \"endoscopy_prior_to_recruitment_mayo_score\",\n  \"endoscopy_prior_to_recruitment_uceis_score\",\n  \"radiology_prior_to_recruitment_date\",\n  \"radiology_prior_to_recruitment_ctap\",\n  \"radiology_prior_to_recruitment_mri_sb\",\n  \"radiology_prior_to_recruitment_mri_pelvis\",\n  \"radiology_prior_to_recruitment_report\",\n  \"histology_prior_to_recruitment_date\",\n  \"histology_prior_to_recruitment_report\",\n  \"surgical_history_number\",\n  \"surgical_history_1_date\",\n  \"surgical_history_1_report\",\n  \"surgical_history_2_date\",\n  \"surgical_history_2_report\",\n  \"surgical_history_3_date\",\n  \"surgical_history_3_report\",\n  \"phenotyping_comments\",\n  \"previous_appendicectomy\",\n  \"previous_tonsillectomy\",\n  \"appendicectomy_age\",\n  \"tonsillectomy_age\",\n  \"pmh_1_start_date\",\n  \"pmh_1_end_date\",\n  \"pmh_1_diagnosis\",\n  \"pmh_2_start_date\",\n  \"pmh_2_end_date\",\n  \"pmh_2_diagnosis\",\n  \"pmh_3_start_date\",\n  \"pmh_3_end_date\",\n  \"pmh_3_diagnosis\",\n  \"pmh_4_start_date\",\n  \"pmh_4_end_date\",\n  \"pmh_4_diagnosis\",\n  \"pmh_5_start_date\",\n  \"pmh_5_end_date\",\n  \"pmh_5_diagnosis\",\n  \"pmh_comments\",\n  \"fh_number_brothers\",\n  \"fh_number_sisters\",\n  \"fh_number_siblings\",\n  \"fh_number_daughters\",\n  \"fh_number_sons\",\n  \"fh_number_children\",\n  \"fh_of_ibd_present\",\n  \"fh_of_ibd_number_affected\",\n  \"fh_1_relationship\",\n  \"fh_1_age_at_diagnosis\",\n  \"fh_1_diagnosis\",\n  \"fh_2_relationship\",\n  \"fh_2_age_at_diagnosis\",\n  \"fh_2_diagnosis\",\n  \"fh_2_diagnosis_other\",\n  \"fh_2_diagnosis_other_text\",\n  \"fh_3_relationship\",\n  \"fh_3_age_at_diagnosis\",\n  \"fh_3_diagnosis\",\n  \"fh_3_diagnosis_other\",\n  \"fh_4_relationship\",\n  \"fh_4_age_at_diagnosis\",\n  \"fh_4_diagnosis\",\n  \"fh_comments\",\n  \"baseline_asa\",\n  \"baseline_mtx\",\n  \"baseline_ifx\",\n  \"baseline_ada\",\n  \"baseline_aza\",\n  \"baseline_mp\",\n  \"baseline_uste\",\n  \"baseline_vedo\",\n  \"baseline_goli\",\n  \"baseline_tofa\",\n  \"baseline_filgo\",\n  \"baseline_risa\",\n  \"surgical_history_1_procedure\",\n  \"surgical_history_2_procedure\",\n  \"surgical_history_3_procedure\",\n  \"sescd\",\n  \"uceis\",\n  \"mayo_endoscopic_score\",\n  \"physician_endoscopic_severity\",\n  \"endoscopic_mucosal_healing_at_3_6_months\",\n  \"complete_mucosal_healing_at_3_6_months\",\n  \"endoscopic_mucosal_healing_at_12_months\",\n  \"complete_mucosal_healing_at_12_months\"\n  \"cd_pro2_raw\",\n  \"cd_pro2_weighted\",\n  \"uc_pro2\",\n  \"ibdresponse_criteria_cd_met\",\n  \"ibdresponse_criteria_uc_met\",\n]\n</code></pre>"},{"location":"data_dictionary/music_columns/#column-construction-comments","title":"Column Construction Comments","text":""},{"location":"data_dictionary/music_columns/#mucosal-healing-definitions","title":"Mucosal Healing Definitions","text":"<ol> <li>Endoscopic Mucosal Healing: SES-CD or UCEIS score of 0. <code>yes</code> or <code>no</code>.</li> <li>Complete Mucosal Healing: Endoscopic Mucosal Healing + Normal Pathology. <code>yes</code>/<code>no</code>/<code>partial</code>.</li> </ol>"},{"location":"data_dictionary/music_columns/#mucosal-healing-columns","title":"Mucosal Healing Columns","text":"<ul> <li><code>sescd</code> was created by merging <code>sescd_noncalc</code> into <code>sescd_calc</code> and renamed.</li> <li><code>uceis</code> was created by merging <code>uceis_noncalc</code> and <code>uceis_calc</code> and renamed.</li> <li><code>endo_healing</code> was renamed to <code>endoscopic_mucosal_healing</code></li> <li><code>cmh</code> was renamed to <code>complete_mucosal_healing</code></li> <li><code>endoscopic_mucosal_healing_at_3_6_months</code> was created by taking the <code>endoscopic_mucosal_healing</code> value at <code>timepoint_2</code> and populating it to <code>timepoint_1</code> to <code>timepoint_5</code>.</li> <li><code>complete_mucosal_healing_at_3_6_months</code> was created by taking the <code>complete_mucosal_healing</code> value at <code>timepoint_2</code> and populating it to <code>timepoint_1</code> to <code>timepoint_5</code>.</li> <li><code>endoscopic_mucosal_healing_at_12_months</code> was created by taking the <code>endoscopic_mucosal_healing</code> value at <code>timepoint_5</code> and populating it to <code>timepoint_1</code> to <code>timepoint_5</code>.</li> <li><code>complete_mucosal_healing_at_12_months</code> was created by taking the <code>complete_mucosal_healing</code> value at <code>timepoint_5</code> and populating it to <code>timepoint_1</code> to <code>timepoint_5</code>.</li> </ul>"},{"location":"data_dictionary/music_columns/#pro2-columns","title":"PRO2 Columns","text":"<ul> <li><code>cd_pro2_raw</code> is the raw PRO2 score for Crohn's disease calculated by hbi_liquid_stools + hbi_abdominal_pain where pain is scored 0-3 corresponding to none, mild, moderate, severe.</li> <li><code>cd_pro2_weighted</code> is the weighted PRO2 score for Crohn's disease calculated by hbi_liquid_stools + (hbi_abdominal_pain * 2) where pain is scored 0-3 corresponding to none, mild, moderate, severe and multiplied by 5.</li> <li><code>uc_pro2</code> is the PRO2 score for Ulcerative Colitis calculated by scoring mayo_stool_frequency 0-3 based on the categories + mayo_rectal_bleeding 0-3.</li> <li><code>ibdresponse_criteria_cd_met</code> is a boolean indicating if the PRO2 score meets the IBD Response Study Criteria, where hbi_liquid_stools &gt;= 4 and hbi_abdominal_pain &gt;= 2.</li> <li><code>ibdresponse_criteria_uc_met</code> is a boolean indicating if the PRO2 score meets the IBD Response Study Criteria, where mayo_stool_frequency = 3 and mayo_rectal_bleeding &gt; 0.</li> </ul>"},{"location":"pipeline/","title":"Data Pipelines","text":"<p>This section provides references for the code used in data transformation and extraction.</p> <p>If you need to trace the changes made to a variable, you can search within the pipeline to find the relevant transformations.</p>"},{"location":"pipeline/combined_music/","title":"Combined Mini-MUSIC and MUSIC pipeline","text":"assets/combined_music_mini_music.py<pre><code>import pandas as pd\nfrom dagster import AssetExecutionContext, MaterializeResult, asset\n\nfrom music_dagster.resources import GTracResource\n\n\n@asset(\n    group_name=\"combined_music_mini_music\",\n    description=\"Merges music and mini-music dataframes\",\n)\ndef combined_music_mini_music_dataframe(\n    context: AssetExecutionContext,\n    music_cleaned_dataframe: pd.DataFrame,\n    mini_music_cleaned_dataframe: pd.DataFrame,\n) -&gt; pd.DataFrame:\n    music_df = music_cleaned_dataframe\n    mini_music_df = mini_music_cleaned_dataframe\n\n    overlapping_columns = set(music_df.columns).intersection(set(mini_music_df.columns))\n    music_only_columns = set(music_df.columns).difference(set(mini_music_df.columns))\n    mini_music_only_columns = set(mini_music_df.columns).difference(\n        set(music_df.columns)\n    )\n\n    df = pd.concat([music_df, mini_music_df])\n\n    context.add_output_metadata(\n        {\n            \"dagster/row_count\": df.shape[0],\n            \"input_music_df_dimension\": f\"{music_df.shape[0]} rows x {music_df.shape[1]} columns\",\n            \"input_mini_music_df_dimension\": f\"{mini_music_df.shape[0]} rows x {mini_music_df.shape[1]} columns\",\n            \"output_df_dimension\": f\"{df.shape[0]} rows x {df.shape[1]} columns\",\n            \"overlapping_column_count\": len(overlapping_columns),\n            \"overlapping_column_list\": sorted(list(overlapping_columns)),\n            \"music_only_columns\": sorted(list(music_only_columns)),\n            \"mini_music_only_columns\": sorted(list(mini_music_only_columns)),\n        }\n    )\n    return df\n</code></pre>"},{"location":"pipeline/gidamps/","title":"GI-DAMPs","text":"assets/gidamps.py<pre><code>import datetime\n\nimport numpy as np\nimport pandas as pd\nimport requests\nfrom dagster import (\n    AssetExecutionContext,\n    EnvVar,\n    MaterializeResult,\n    MetadataValue,\n    asset,\n)\n\nfrom music_dagster.resources import GTracResource\n\n\n@asset(\n    io_manager_key=\"io_manager\",\n    description=\"Fetches GI-DAMPs data from IGMM RedCap Server\",\n    group_name=\"gidamps\",\n)\ndef gidamps_raw_dataframe() -&gt; pd.DataFrame:\n    \"\"\"\n    Fetches raw data from the GIDAMPS REDCap API and returns it as a pandas DataFrame.\n    The function performs the following steps:\n    1. Retrieves the GIDAMPS API token from environment variables.\n    2. Defines the REDCap API URL and the data payload for the API request.\n    3. Sends a POST request to the REDCap API to fetch the data.\n    4. Converts the JSON response into a pandas DataFrame.\n    5. Drops specific columns from the DataFrame that are not needed.\n    Returns:\n        pd.DataFrame: A pandas DataFrame containing the raw data from the GIDAMPS REDCap API.\n    \"\"\"\n\n    GIDAMPS_API_TOKEN = EnvVar(\"GIDAMPS_API_TOKEN\").get_value()\n    gidamps_redcap_url = \"https://ecrf.igmm.ed.ac.uk/api/\"\n    redcap_api_data = {\n        \"token\": f\"{GIDAMPS_API_TOKEN}\",\n        \"content\": \"record\",\n        \"action\": \"export\",\n        \"format\": \"json\",\n        \"type\": \"flat\",\n        \"csvDelimiter\": \"\",\n        \"rawOrLabel\": \"raw\",\n        \"rawOrLabelHeaders\": \"raw\",\n        \"exportCheckboxLabel\": \"false\",\n        \"exportSurveyFields\": \"false\",\n        \"exportDataAccessGroups\": \"false\",\n        \"returnFormat\": \"json\",\n    }\n    response = requests.post(gidamps_redcap_url, data=redcap_api_data)\n    response.raise_for_status()\n    data = response.json()\n    df = pd.DataFrame.from_records(data)\n    df.drop(\n        columns=[\n            \"email\",\n            \"chi_no\",\n            \"consent\",\n            \"initial\",\n            \"dob\",\n            \"legacy_study_id\",\n            \"patient_details_complete\",\n            \"pd_gi_participant_category\",\n            \"registration_location\",\n            \"date_enrolledconsent\",\n            \"data_entry_date\",\n            \"study_group\",\n            \"study_group_hc\",\n            \"blood_experiment\",\n            \"faecal_experiment\",\n            \"biopsy_experiment\",\n            \"bloodtestdate_as_lbt\",\n            \"blood_sample_collected___5\",\n            \"blood_sample_collected___6\",\n            \"blood_sample_collected___3\",\n            \"blood_sample_collected___4\",\n            \"blood_sample_collected___100\",\n            \"blood_sample_collected___200\",\n            \"blood_sample_collected___99\",\n            \"blood_sample_collected___2\",\n            \"blood_sample_collected___1\",\n            \"blood_sample_collected____1000\",\n            \"blood_sample_optinal_set___1\",\n            \"blood_sample_optinal_set____1000\",\n            \"blood_sample_additional___1\",\n            \"blood_sample_additional___2\",\n            \"blood_sample_additional____1000\",\n            \"faecal_test_date\",\n            \"faecal_sample_collected___1\",\n            \"faecal_sample_collected___2\",\n            \"faecal_sample_collected___3\",\n            \"faecal_sample_collected___4\",\n            \"faecal_sample_collected___99\",\n            \"faecal_sample_collected____1000\",\n            \"sampls_date_experiment4\",\n            \"biopsy_sample_collected___1\",\n            \"biopsy_sample_collected___2\",\n            \"biopsy_sample_collected___99\",\n            \"biopsy_sample_collected____1000\",\n            \"sampling_complete\",\n            \"baseline_eims____1000\",\n            \"sccai_complications____1000\",\n            \"hbicomplications____1000\",\n            \"adalimumab_test\",\n            \"infliximab_test\",\n            \"vedolizumab_test\",\n            \"ustekinumab_test\",\n            \"drug_level_uste\",\n            \"drug_level_antibody_uste\",\n            \"drug_level_vedo\",\n            \"drug_level_antibody_vedo\",\n            \"endoscopy_yn\",\n            \"endoscopy_type____1000\",\n            \"gidamps_participant_questionnaire_complete\",\n            \"baseline_mont_cd_loc____1000\",\n            \"baseline_mont_cd_beh____1000\",\n            \"radiology\",\n            \"ibd_background_clinician_complete\",\n        ],\n        inplace=True,\n    )\n    return df\n\n\n@asset(\n    description=\"Data cleaning - Renames columns and maps values.\", group_name=\"gidamps\"\n)\ndef gidamps_cleaned_dataframe(\n    context: AssetExecutionContext, gidamps_raw_dataframe: pd.DataFrame\n) -&gt; pd.DataFrame:\n    \"\"\"\n    Cleans and transforms the raw GIDAMPS dataframe.\n    This function performs the following operations:\n    1. Renames columns to more readable names.\n    2. Converts specified columns to numeric types, coercing errors.\n    3. Converts date columns to datetime objects and calculates diagnosis duration.\n    4. Maps categorical columns to more readable values.\n    5. Creates new columns based on existing data.\n    6. Drops unnecessary columns.\n    7. Replaces empty strings with NaN values.\n    Args:\n        gidamps_raw_dataframe (pd.DataFrame): The raw dataframe containing GIDAMPS data.\n    Returns:\n        pd.DataFrame: The cleaned and transformed dataframe.\n    \"\"\"\n    df = gidamps_raw_dataframe\n\n    df.rename(\n        columns={\n            \"bl_new_diagnosis\": \"new_diagnosis_of_ibd\",\n            \"smokeryn1\": \"smoking_status\",\n            \"bmi_height\": \"height\",\n            \"bmi_weight\": \"weight\",\n            \"diagnosis_age\": \"age_at_diagnosis\",\n            \"smokeryn1_y\": \"is_smoker\",\n            \"patient_active_symptomyn1\": \"has_active_symptoms\",\n            \"antibiotics\": \"sampling_abx\",\n            \"steroids\": \"sampling_steroids\",\n            \"haematocrit_lab\": \"haematocrit\",\n            \"neutrophils_lab\": \"neutrophils\",\n            \"lymphocytes_lab\": \"lymphocytes\",\n            \"monocytes_lab\": \"monocytes\",\n            \"eosinophils_lab\": \"eosinophils\",\n            \"basophils_lab\": \"basophils\",\n            \"plt_lab\": \"platelets\",\n            \"urea_lab\": \"urea\",\n            \"creatinine_lab\": \"creatinine\",\n            \"sodium_lab\": \"sodium\",\n            \"potassium_lab\": \"potassium\",\n            \"egfr_lab\": \"egfr\",\n            \"faecal_test_date_2\": \"calprotectin_date\",\n            \"drug_level_inflxi\": \"ifx_level\",\n            \"drug_level_adalimumab\": \"ada_level\",\n            \"drug_level_antibody_adali\": \"ada_antibody\",\n            \"drug_level_antibody_inflx\": \"ifx_antibody\",\n            \"baseline_mont_uc_extent\": \"montreal_uc_extent\",\n            \"baseline_mont_seve_uc\": \"montreal_uc_severity\",\n            \"baseline_eims___2\": \"baseline_eims_arthralgia\",\n            \"baseline_eims___3\": \"baseline_eims_ank_spon\",\n            \"baseline_eims___5\": \"baseline_eims_erythema_nodosum\",\n            \"baseline_eims___6\": \"baseline_eims_pyoderma\",\n            \"baseline_eims___10\": \"baseline_eims_uveitis\",\n            \"baseline_eims___12\": \"baseline_eims_episcleritis\",\n            \"baseline_eims___8\": \"baseline_eims_sacroileitis\",\n            \"baseline_eims___15\": \"baseline_eims_none\",\n            \"sccai_complications___1\": \"sccai_arthralgia\",\n            \"sccai_complications___2\": \"sccai_uveitis\",\n            \"sccai_complications___3\": \"sccai_erythema_nodosum\",\n            \"sccai_complications___4\": \"sccai_pyoderma\",\n            \"hbicomplications___1\": \"hbi_arthralgia\",\n            \"hbicomplications___2\": \"hbi_uveitis\",\n            \"hbicomplications___3\": \"hbi_erythema_nodosum\",\n            \"hbicomplications___4\": \"hbi_apthous_ulcers\",\n            \"hbicomplications___5\": \"hbi_pyoderma\",\n            \"hbicomplications___6\": \"hbi_anal_fissures\",\n            \"hbicomplications___7\": \"hbi_new_fistula\",\n            \"hbicomplications___8\": \"hbi_abscess\",\n            \"baseline_gi_symptoms_desc\": \"symptoms_description\",\n            \"sccai_bowel_freqday\": \"sccai_bowel_frequency_day\",\n            \"sccai_bowel_frequency_nigh\": \"sccai_bowel_frequency_night\",\n            \"sccai_urgency_of_defecatio\": \"sccai_urgency\",\n            \"hbinumber_of_liquid_stools\": \"hbi_liquid_stools\",\n            \"hbiabdominal_mass1\": \"hbi_abdominal_mass\",\n            \"hbigeneral_well_being_as\": \"hbi_general_well_being\",\n            \"hbiabdominal_pain\": \"hbi_abdominal_pain\",\n            \"blood_test_date_red\": \"nhs_bloods_date\",\n            \"date_test_adali_inflixi\": \"drug_level_date\",\n            \"endoscopy_result_endcospy\": \"endoscopy_report\",\n            \"histopathology_report_text\": \"pathology_report\",\n            \"ct_abdomen_and_or_pelvis\": \"ct_abdomen\",\n            \"radilogy_r_ctabdo_pelvic\": \"ct_abdomen_report\",\n            \"radiology_r_mri_sml_bowel\": \"mri_small_bowel_report\",\n            \"radiology_r_mri_pelvis\": \"mri_pelvis_report\",\n            \"comment_if_any_of_these_qu\": \"participant_questionnaire_comments\",\n            \"mh_appendx1\": \"previous_appendicectomy\",\n            \"mh_tonsilout1\": \"previous_tonsillectomy\",\n            \"mh_tonsil_date1\": \"age_or_year_of_tonsillectomy\",\n            \"mh_appendix_date1\": \"age_or_year_of_appendicectomy\",\n            \"fhdiagnosis_pfh_1\": \"family_history_diagnosis\",\n            \"relationship_pfh\": \"family_history_relationship\",\n            \"family_history_pfh\": \"family_history_of_ibd\",\n            \"gi_q1\": \"giq_ethnicity\",\n            \"gi_q1_other_3\": \"giq_ethicity_text\",\n            \"q_hc_goodhealth\": \"giq_are_you_in_good_health\",\n            \"gi_q1_other_2\": \"giq_good_health_text\",\n            \"q_hc_longterm_medication\": \"giq_long_term_medication\",\n            \"gi_q1_other\": \"giq_long_term_medication_text\",\n            \"q3_gi\": \"giq_smoking_status_at_diagnosis\",\n            \"q5_gi\": \"giq_strenous_exercise_last_48h\",\n            \"q5_gi_yes\": \"giq_strenous_exercise_last_48h_text\",\n            \"q4_gi\": \"giq_do_you_drink_alcohol\",\n            \"q4_gi_yes\": \"giq_alcohol_consumption\",\n            \"sccai_total_calculation\": \"sccai_total\",\n            \"hbi_total_calculation\": \"hbi_total\",\n        },\n        inplace=True,\n    )\n\n    columns_to_convert = [\n        \"study_group_name\",\n        \"baseline_recruitment_type\",\n        \"sex\",\n        \"ibd_status\",\n        \"new_diagnosis_of_ibd\",\n        \"smoking_status\",\n        \"sccai_general_well_being\",\n        \"sccai_bowel_frequency_day\",\n        \"sccai_bowel_frequency_night\",\n        \"sccai_urgency\",\n        \"sccai_blood_in_stool\",\n        \"montreal_uc_extent\",\n        \"montreal_uc_severity\",\n        \"hbi_abdominal_mass\",\n        \"hbi_general_well_being\",\n        \"hbi_abdominal_pain\",\n        \"endoscopy_type___1\",\n        \"endoscopy_type___2\",\n        \"endoscopy_type___3\",\n        \"baseline_mont_cd_loc___0\",\n        \"baseline_mont_cd_loc___1\",\n        \"baseline_mont_cd_loc___2\",\n        \"baseline_mont_cd_loc___3\",\n        \"baseline_mont_cd_beh___0\",\n        \"baseline_mont_cd_beh___1\",\n        \"baseline_mont_cd_beh___2\",\n        \"baseline_mont_cd_beh___3\",\n        \"ct_abdomen\",\n        \"mri_small_bowel\",\n        \"mri_pelvis\",\n        \"ada_antibody\",\n        \"ifx_antibody\",\n        \"past_ibd_surgery\",\n        \"ifx\",\n        \"ciclo\",\n        \"aza\",\n        \"mp\",\n        \"mtx\",\n        \"ada\",\n        \"uste\",\n        \"vedo\",\n        \"filgo\",\n        \"risa\",\n        \"upa\",\n        \"golim\",\n        \"tofa\",\n        \"previous_appendicectomy\",\n        \"family_history_of_ibd\",\n        \"giq_smoking_status_at_diagnosis\",\n        \"giq_alcohol_consumption\",\n        \"family_history_diagnosis\",\n        \"giq_ethnicity\",\n    ]\n    df[columns_to_convert] = df[columns_to_convert].apply(\n        pd.to_numeric, errors=\"coerce\"\n    )\n\n    df[\"diagnosis_duration_in_days\"] = (\n        pd.to_datetime(datetime.date.today()) - pd.to_datetime(df[\"date_of_diagnosis\"])\n    ).dt.days\n\n    df[\"ct_abdomen\"] = df[\"ct_abdomen\"].map({1: 1, 2: 0})\n    df[\"mri_small_bowel\"] = df[\"mri_small_bowel\"].map({1: 1, 2: 0})\n    df[\"mri_pelvis\"] = df[\"mri_pelvis\"].map({1: 1, 2: 0})\n    df[\"past_ibd_surgery\"] = df[\"past_ibd_surgery\"].map({1: 1, 2: 0})\n    df[\"ifx\"] = df[\"ifx\"].map({1: 1, 2: 0})\n    df[\"ciclo\"] = df[\"ciclo\"].map({1: 1, 2: 0})\n    df[\"previous_appendicectomy\"] = df[\"previous_appendicectomy\"].map({1: 1, 2: 0})\n\n    df[\"family_history_of_ibd\"] = df[\"family_history_of_ibd\"].map(\n        {1: \"yes\", 2: \"no\", 3: \"not_available\"}\n    )\n    df[\"giq_smoking_status_at_diagnosis\"] = df[\"giq_smoking_status_at_diagnosis\"].map(\n        {1: \"yes\", 2: \"no\", 3: \"unsure\"}\n    )\n    df[\"giq_alcohol_consumption\"] = df[\"giq_alcohol_consumption\"].map(\n        {\n            1: \"most_days\",\n            2: \"weekends_only\",\n            3: \"once_or_twice_a_week\",\n            4: \"once_or_twice_a_month\",\n            5: \"once_or_twice_a_year\",\n        }\n    )\n    df[\"family_history_diagnosis\"] = df[\"family_history_diagnosis\"].map(\n        {\n            6: \"cd\",\n            7: \"uc\",\n            9: \"ibdu\",\n            10: \"possible_cd\",\n            11: \"possible_uc\",\n            12: \"possible_ibdu\",\n            99: \"other_diagnosis\",\n        }\n    )\n    df[\"giq_ethnicity\"] = df[\"giq_ethnicity\"].map(\n        {1: \"white_european\", 99: \"other_see_text\"}\n    )\n    df[\"ada_antibody\"] = df[\"ada_antibody\"].map(\n        {1: \"&lt;10\", 2: \"10-40\", 3: \"40-200\", 4: \"&gt;200\", 5: \"not_tested\"}\n    )\n    df[\"ifx_antibody\"] = df[\"ifx_antibody\"].map(\n        {1: \"&lt;10\", 2: \"10-40\", 3: \"40-200\", 4: \"&gt;200\", 5: \"not_tested\"}\n    )\n    df[\"study_group_name\"] = df[\"study_group_name\"].map(\n        {\n            1: \"cd\",\n            2: \"uc\",\n            3: \"ibdu\",\n            4: \"non_ibd\",\n            5: \"await_dx\",\n            6: \"hc\",\n        }\n    )\n    df[\"baseline_recruitment_type\"] = df[\"baseline_recruitment_type\"].map(\n        {\n            1: \"endoscopy\",\n            2: \"outpatient\",\n            3: \"inpatient\",\n        }\n    )\n    df[\"sex\"] = df[\"sex\"].map({1: \"male\", 2: \"female\"})\n    df[\"ibd_status\"] = df[\"ibd_status\"].map(\n        {\n            0: \"biochem_remission\",\n            1: \"remission\",\n            2: \"active\",\n            3: \"highly_active\",\n            4: \"not_applicable\",\n        }\n    )\n\n    df[\"new_diagnosis_of_ibd\"] = df[\"new_diagnosis_of_ibd\"].map(\n        {\n            1: \"yes\",\n            0: \"no\",\n        }\n    )\n\n    df[\"smoking_status\"] = df[\"smoking_status\"].map(\n        {\n            1: \"smoker\",\n            2: \"ex_smoker\",\n            3: \"non_smoker\",\n        }\n    )\n\n    df[\"sccai_general_well_being\"] = df[\"sccai_general_well_being\"].map(\n        {\n            0: \"very_well\",\n            1: \"slightly_below_par\",\n            2: \"poor\",\n            3: \"very_poor\",\n            4: \"terrible\",\n        }\n    )\n    df[\"sccai_bowel_frequency_day\"] = df[\"sccai_bowel_frequency_day\"].map(\n        {0: \"0-3\", 1: \"4-6\", 2: \"7-9\", 3: \"&gt;9\"}\n    )\n    df[\"sccai_bowel_frequency_night\"] = df[\"sccai_bowel_frequency_night\"].map(\n        {\n            0: \"0\",\n            1: \"1-3\",\n            2: \"4-6\",\n        }\n    )\n    df[\"sccai_urgency\"] = df[\"sccai_urgency\"].map(\n        {\n            0: \"none\",\n            1: \"hurry\",\n            2: \"immediately\",\n            3: \"incontinence\",\n        }\n    )\n    df[\"sccai_blood_in_stool\"] = df[\"sccai_blood_in_stool\"].map(\n        {\n            0: \"none\",\n            1: \"trace\",\n            2: \"occasionally_frank\",\n            3: \"usually_frank\",\n        }\n    )\n    df[\"hbi_abdominal_mass\"] = df[\"hbi_abdominal_mass\"].map(\n        {\n            0: \"none\",\n            1: \"dubious\",\n            2: \"definite\",\n            3: \"definite_and_tender\",\n        }\n    )\n    df[\"hbi_general_well_being\"] = df[\"hbi_general_well_being\"].map(\n        {\n            0: \"very_well\",\n            1: \"slightly_below_par\",\n            2: \"poor\",\n            3: \"very_poor\",\n            4: \"terrible\",\n        }\n    )\n    df[\"hbi_abdominal_pain\"] = df[\"hbi_abdominal_pain\"].map(\n        {\n            0: \"none\",\n            1: \"mild\",\n            2: \"moderate\",\n            3: \"severe\",\n        }\n    )\n\n    df[\"montreal_uc_extent\"] = df[\"montreal_uc_extent\"].map({0: \"E1\", 1: \"E2\", 2: \"E3\"})\n    df[\"montreal_uc_severity\"] = df[\"montreal_uc_severity\"].map(\n        {0: \"S0\", 1: \"S1\", 2: \"S2\", 3: \"S3\"}\n    )\n\n    df.loc[df[\"baseline_mont_cd_beh___0\"] == 1, \"montreal_cd_behaviour\"] = \"B1\"\n    df.loc[df[\"baseline_mont_cd_beh___1\"] == 1, \"montreal_cd_behaviour\"] = \"B2\"\n    df.loc[df[\"baseline_mont_cd_beh___2\"] == 1, \"montreal_cd_behaviour\"] = \"B3\"\n    df.loc[df[\"baseline_mont_cd_beh___3\"] == 1, \"montreal_perianal\"] = 1\n    df.loc[df[\"baseline_mont_cd_loc___0\"] == 1, \"montreal_cd_location\"] = \"L1\"\n    df.loc[df[\"baseline_mont_cd_loc___1\"] == 1, \"montreal_cd_location\"] = \"L2\"\n    df.loc[df[\"baseline_mont_cd_loc___2\"] == 1, \"montreal_cd_location\"] = \"L3\"\n    df.loc[df[\"baseline_mont_cd_loc___3\"] == 1, \"montreal_upper_gi\"] = 1\n\n    df.loc[df[\"endoscopy_type___1\"] == 1, \"endoscopy_type\"] = \"other\"\n    df.loc[df[\"endoscopy_type___2\"] == 1, \"endoscopy_type\"] = \"colonoscopy\"\n    df.loc[df[\"endoscopy_type___3\"] == 1, \"endoscopy_type\"] = \"flexi_sig\"\n\n    df.loc[df[\"aza\"] == 1, \"baseline_thiopurine_exposure\"] = 1\n    df.loc[df[\"mp\"] == 1, \"baseline_thiopurine_exposure\"] = 1\n\n    df.loc[df[\"ada\"] == 1, \"baseline_anti_tnf_exposure\"] = 1\n    df.loc[df[\"ifx\"] == 1, \"baseline_anti_tnf_exposure\"] = 1\n    df.loc[df[\"golim\"] == 1, \"baseline_anti_tnf_exposure\"] = 1\n\n    df.loc[df[\"ada\"] == 1, \"baseline_biologic_exposure\"] = 1\n    df.loc[df[\"ifx\"] == 1, \"baseline_biologic_exposure\"] = 1\n    df.loc[df[\"golim\"] == 1, \"baseline_biologic_exposure\"] = 1\n    df.loc[df[\"uste\"] == 1, \"baseline_biologic_exposure\"] = 1\n    df.loc[df[\"vedo\"] == 1, \"baseline_biologic_exposure\"] = 1\n    df.loc[df[\"filgo\"] == 1, \"baseline_biologic_exposure\"] = 1\n    df.loc[df[\"risa\"] == 1, \"baseline_biologic_exposure\"] = 1\n    df.loc[df[\"upa\"] == 1, \"baseline_biologic_exposure\"] = 1\n    df.loc[df[\"tofa\"] == 1, \"baseline_biologic_exposure\"] = 1\n\n    df.loc[df[\"upa\"] == 1, \"baseline_jak_exposure\"] = 1\n    df.loc[df[\"tofa\"] == 1, \"baseline_jak_exposure\"] = 1\n    df.loc[df[\"filgo\"] == 1, \"baseline_jak_exposure\"] = 1\n    cols_to_fill = [\n        \"baseline_thiopurine_exposure\",\n        \"baseline_anti_tnf_exposure\",\n        \"baseline_biologic_exposure\",\n        \"baseline_jak_exposure\",\n    ]\n    df[cols_to_fill] = df[cols_to_fill].fillna(0)\n\n    df.drop(\n        columns=[\n            \"baseline_mont_cd_loc___0\",\n            \"baseline_mont_cd_loc___1\",\n            \"baseline_mont_cd_loc___2\",\n            \"baseline_mont_cd_loc___3\",\n            \"baseline_mont_cd_beh___0\",\n            \"baseline_mont_cd_beh___1\",\n            \"baseline_mont_cd_beh___2\",\n            \"baseline_mont_cd_beh___3\",\n            \"endoscopy_type___1\",\n            \"endoscopy_type___2\",\n            \"endoscopy_type___3\",\n        ],\n        inplace=True,\n    )\n\n    df[\"study_center\"] = df[\"study_id\"].apply(\n        lambda x: \"glasgow\"\n        if \"136-\" in x\n        else (\"dundee\" if \"138-\" in x else \"edinburgh\")\n    )\n    # Data Harmonization\n    df.rename(columns={\"study_group_name\": \"study_group\"}, inplace=True)\n\n    df.replace(r\"^\\s*$\", np.nan, regex=True, inplace=True)\n\n    rows, columns = df.shape\n    context.add_output_metadata(\n        {\n            \"dagster/row_count\": rows,\n            \"column_count\": columns,\n            \"columns\": df.columns.to_list(),\n            \"preview\": MetadataValue.md(df.head(10).to_markdown()),\n        }\n    )\n\n    return df\n\n\n@asset(description=\"Creates demographics dataframe\", group_name=\"gidamps\")\ndef gidamps_demographics_dataframe(\n    context: AssetExecutionContext,\n    gidamps_cleaned_dataframe: pd.DataFrame,\n) -&gt; pd.DataFrame:\n    \"\"\"\n    Filters the given GIDAMPS cleaned dataframe to produce a demographics dataframe.\n    This function removes rows where the 'redcap_repeat_instrument' column has the values 'sampling' or 'cucq32'.\n    It also drops columns that contain only NaN values.\n    \"\"\"\n    df = gidamps_cleaned_dataframe\n    demographics_df = df[df[\"redcap_repeat_instrument\"] != \"sampling\"]\n    demographics_df = demographics_df[\n        demographics_df[\"redcap_repeat_instrument\"] != \"cucq32\"\n    ]\n    demographics_df.dropna(axis=1, how=\"all\", inplace=True)\n\n    rows, columns = demographics_df.shape\n    context.add_output_metadata(\n        {\n            \"dagster/row_count\": rows,\n            \"column_count\": columns,\n            \"columns\": demographics_df.columns.to_list(),\n            \"preview\": MetadataValue.md(demographics_df.head(10).to_markdown()),\n        }\n    )\n    return demographics_df\n\n\n@asset(\n    description=\"Creates sampling dataframe\",\n    group_name=\"gidamps\",\n)\ndef gidamps_sampling_dataframe(\n    context: AssetExecutionContext, gidamps_cleaned_dataframe: pd.DataFrame\n) -&gt; pd.DataFrame:\n    \"\"\"\n    Processes and merges different subsets of a given DataFrame based on specific conditions.\n    Args:\n        gidamps_cleaned_dataframe (pd.DataFrame): The input DataFrame containing GIDAMPS data.\n    Returns:\n        pd.DataFrame: The processed and merged DataFrame.\n    The function performs the following steps:\n    1. Filters out rows where 'redcap_repeat_instrument' is 'sampling' or 'cucq32' to create a demographics DataFrame.\n    2. Drops columns with all NaN values from the demographics DataFrame.\n    3. Creates separate DataFrames for 'sampling' and 'cucq32' instruments.\n    4. Drops columns with all NaN values from the 'sampling' and 'cucq32' DataFrames.\n    5. Drops specific columns from the 'sampling' and 'cucq32' DataFrames.\n    6. Renames the 'cucq_date' column to 'sampling_date' in the 'cucq32' DataFrame.\n    7. Merges the 'sampling' DataFrame with the demographics DataFrame on 'study_id'.\n    8. Merges the resulting DataFrame with the 'cucq32' DataFrame on 'study_id' and 'sampling_date'.\n    Note:\n        The function assumes that the input DataFrame contains the columns 'redcap_repeat_instrument',\n        'study_id', 'cucq_date', and other columns mentioned in the code.\n    \"\"\"\n\n    df = gidamps_cleaned_dataframe\n    demographics_df = df[df[\"redcap_repeat_instrument\"] != \"sampling\"]\n    demographics_df = demographics_df[\n        demographics_df[\"redcap_repeat_instrument\"] != \"cucq32\"\n    ]\n    demographics_df.dropna(axis=1, how=\"all\", inplace=True)\n    sampling_df = df[df[\"redcap_repeat_instrument\"] == \"sampling\"].copy()\n    cucq_df = df[df[\"redcap_repeat_instrument\"] == \"cucq32\"].copy()\n    sampling_df.dropna(axis=1, how=\"all\", inplace=True)\n    cucq_df.dropna(axis=1, how=\"all\", inplace=True)\n    cols_to_drop = [\n        \"baseline_thiopurine_exposure\",\n        \"baseline_anti_tnf_exposure\",\n        \"baseline_biologic_exposure\",\n        \"baseline_jak_exposure\",\n        \"redcap_repeat_instrument\",\n        \"study_center\",\n    ]\n    sampling_df.drop(columns=cols_to_drop, inplace=True)\n    cucq_df.drop(columns=cols_to_drop, inplace=True)\n    cucq_df.drop(columns=[\"redcap_repeat_instance\"], inplace=True)\n    cucq_df.rename(columns={\"cucq_date\": \"sampling_date\"}, inplace=True)\n    merged_df = pd.merge(sampling_df, demographics_df, how=\"left\", on=\"study_id\")\n    merged_df = pd.merge(\n        merged_df, cucq_df, how=\"left\", on=[\"study_id\", \"sampling_date\"]\n    )\n\n    rows, columns = merged_df.shape\n    context.add_output_metadata(\n        {\n            \"dagster/row_count\": rows,\n            \"column_count\": columns,\n            \"columns\": merged_df.columns.to_list(),\n            \"preview\": MetadataValue.md(merged_df.head(10).to_markdown()),\n        }\n    )\n    return merged_df\n</code></pre>"},{"location":"pipeline/mini_music/","title":"Mini-MUSIC","text":"assets/mini_music.py<pre><code>import numpy as np\nimport pandas as pd\nimport requests\nfrom dagster import (\n    AssetExecutionContext,\n    EnvVar,\n    MaterializeResult,\n    MetadataValue,\n    asset,\n)\n\nfrom music_dagster.resources import GTracResource\n\n\n@asset(\n    description=\"Fetches Mini-MUSIC data from IGMM RedCap Server\",\n    group_name=\"mini_music\",\n)\ndef mini_music_raw_dataframe(context: AssetExecutionContext) -&gt; pd.DataFrame:\n    MINI_MUSIC_API_TOKEN = EnvVar(\"MINI_MUSIC_API_TOKEN\").get_value()\n    mini_music_redcap_url = \"https://ecrf.igmm.ed.ac.uk/api/\"\n    redcap_api_data = {\n        \"token\": f\"{MINI_MUSIC_API_TOKEN}\",\n        \"content\": \"record\",\n        \"action\": \"export\",\n        \"format\": \"json\",\n        \"type\": \"flat\",\n        \"csvDelimiter\": \"\",\n        \"forms[0]\": \"patient_details\",\n        \"forms[1]\": \"diagnosis\",\n        \"forms[2]\": \"timepoints\",\n        \"forms[3]\": \"phenotyping\",\n        \"forms[4]\": \"current_drug_treatment\",\n        \"forms[5]\": \"endoscopic_disease_activity\",\n        \"forms[6]\": \"radiologic_disease_activity\",\n        \"forms[7]\": \"surgical_intervention\",\n        \"forms[8]\": \"saliva_sample\",\n        \"forms[9]\": \"laboratory_tests_for_disease_activity\",\n        \"forms[10]\": \"impact_iiipromis_fatigue_score\",\n        \"rawOrLabel\": \"raw\",\n        \"rawOrLabelHeaders\": \"raw\",\n        \"exportCheckboxLabel\": \"false\",\n        \"exportSurveyFields\": \"false\",\n        \"exportDataAccessGroups\": \"false\",\n        \"returnFormat\": \"json\",\n    }\n    response = requests.post(mini_music_redcap_url, data=redcap_api_data)\n    response.raise_for_status()\n    data = response.json()\n    df = pd.DataFrame.from_records(data)\n\n    df.drop(\n        columns=[\n            \"redcap_repeat_instrument\",\n            \"redcap_repeat_instance\",\n            \"study_name\",\n            \"other_site\",\n            \"consent_point8\",\n            \"assent_type\",\n            \"consent_type___1\",\n            \"consent_type___2\",\n            \"consent_type____1000\",\n            \"pis_type___1\",\n            \"pis_type___2\",\n            \"pis_type___3\",\n            \"pis_type___4\",\n            \"pis_type____1000\",\n            \"date_data_entry\",\n            \"consent_date\",\n            \"consenter_initial\",\n            \"recruitment_setting\",\n            \"consenter_initials\",\n            \"assent_version\",\n            \"consent_version\",\n            \"patient_pis_version\",\n            \"parent_pis_version\",\n            \"parent_pis_yn\",\n            \"patient_pis_yn\",\n            \"gp_yn\",\n            \"par_tel_no\",\n            \"parent_email\",\n            \"chi_no\",\n            \"initial\",\n            \"dob\",\n            \"patient_email\",\n            \"pat_tel_no\",\n            \"patdetailscomments\",\n            \"fuvisit_yn\",\n            \"patient_details_complete\",\n            \"diagnosis_complete\",\n            \"unit_bilirubin\",\n            \"unit_potassium\",\n            \"unit_sodium\",\n            \"unit_creatinine\",\n            \"unit_urea\",\n            \"unit_plt\",\n            \"unit_basophils\",\n            \"unit_eosinophils\",\n            \"unit_monocytes\",\n            \"unit_lymphocytes\",\n            \"unit_neutrophils\",\n            \"unit_wcc\",\n            \"unit_haematocrit\",\n            \"unit_hb\",\n            \"unit_mcv\",\n            \"drug_level_vedo\",\n            \"drug_level_antibody_vedo\",\n            \"drug_level_uste\",\n            \"drug_level_antibody_uste\",\n            \"vedolizumab_level\",\n            \"ustekinumab_level\",\n            \"surgical_intervention_complete\",\n            \"radiologic_disease_activity_complete\",\n            \"type_eim____1000\",\n            \"baseline_symptoms_desc2____1000\",\n            \"visit1\",\n            \"timepoints_complete\",\n            \"flare_up_description1____1000\",\n            \"flare_up_description2____1000\",\n            \"flare_up_management1____1000\",\n            \"flare_up_management2____1000\",\n            \"unplanned_hospital_reason1____1000\",\n            \"unplanned_hospital_reason2____1000\",\n            \"baseline_eims___99\",\n            \"baseline_eims____1000\",\n            \"baseline_eims_subother____1000\",\n            \"baseline_surgical_history\",\n            \"baseline_ibd_drug_entry\",\n            \"baseline_ibd_date_1\",\n            \"mh_any\",\n            \"mh_num\",\n            \"mh_system1\",\n            \"mh_term_other1\",\n            \"mh_system2\",\n            \"mh_term_other2\",\n            \"mh_system3\",\n            \"mh_term_other3\",\n            \"mh_system4\",\n            \"mh_term_other4\",\n            \"mh_system5\",\n            \"mh_term_other5\",\n            \"mh_system6\",\n            \"mh_term_other6\",\n            \"mh_system7\",\n            \"mh_term_other7\",\n            \"phenotyping_complete\",\n            \"other_endoscopy_type____1000\",\n            \"endoscopic_score\",\n            \"endoscopy_yn\",\n            \"endoscopy_type___1\",\n            \"endoscopy_type____1000\",\n            \"other_endoscopy_type___4\",\n            \"other_endoscopy_type___5\",\n            \"other_endoscopy_type___6\",\n            \"other_endoscopy_type____1000\",\n            \"upload_endoscopic_image\",\n            \"uceisvascular_pattern\",\n            \"uceisbleeding\",\n            \"uceiserosions_and_ulcers\",\n            \"score_ileum\",\n            \"score_right\",\n            \"score_transverse\",\n            \"score_left\",\n            \"score_rectum\",\n            \"endoscopic_disease_activity_complete\",\n            \"radiology\",\n            \"mrisb_image\",\n            \"saliva_sample_complete\",\n            \"adalimumab_level\",\n            \"infliximab_level\",\n            \"vedolizumab_level\",\n            \"ustekinumab_level\",\n            \"otherdruglevel\",\n            \"laboratory_tests_for_disease_activity_complete\",\n            \"impact_iiipromis_fatigue_score_complete\",\n            \"meds_summary____1000\",\n            \"current_drug_treatment_complete\",\n        ],\n        inplace=True,\n    )\n    rows, columns = df.shape\n    context.add_output_metadata(\n        {\n            \"dagster/row_count\": rows,\n            \"column_count\": columns,\n        }\n    )\n    return df\n\n\n@asset(\n    description=\"Performs data cleaning on Mini-MUSIC data\",\n    group_name=\"mini_music\",\n)\ndef mini_music_cleaned_dataframe(\n    context: AssetExecutionContext, mini_music_raw_dataframe: pd.DataFrame\n) -&gt; pd.DataFrame:\n    df = mini_music_raw_dataframe\n\n    df.rename(\n        columns={\n            \"haematocrit_lab\": \"haematocrit\",\n            \"neutrophils_lab\": \"neutrophils\",\n            \"lymphocytes_lab\": \"lymphocytes\",\n            \"monocytes_lab\": \"monocytes\",\n            \"eosinophils_lab\": \"eosinophils\",\n            \"basophils_lab\": \"basophils\",\n            \"plt_lab\": \"platelets\",\n            \"bilirubin_lab\": \"bilirubin\",\n            \"urea_lab\": \"urea\",\n            \"creatinine_lab\": \"creatinine\",\n            \"sodium_lab\": \"sodium\",\n            \"potassium_lab\": \"potassium\",\n            \"diagnosis_comment\": \"diagnosis_comments\",\n            \"flare_up_timeframe1\": \"flare_up_1_date\",\n            \"flare_up_description1___1\": \"flare_up_1_description_abdominal_pain\",\n            \"flare_up_description1___2\": \"flare_up_1_description_diarrhoea\",\n            \"flare_up_description1___3\": \"flare_up_1_description_urgency\",\n            \"flare_up_description1___4\": \"flare_up_1_description_pr_bleeding\",\n            \"flare_up_description1___5\": \"flare_up_1_description_weight_loss\",\n            \"flare_up_description1___6\": \"flare_up_1_description_fever\",\n            \"flare_up_description1___7\": \"flare_up_1_description_perianal\",\n            \"flare_setting1\": \"flare_up_1_setting\",\n            \"flare_setting2\": \"flare_up_2_setting\",\n            \"flare_up_management1___1\": \"flare_up_1_management_iv_steroids\",\n            \"flare_up_management1___3\": \"flare_up_1_management_oral_steroids\",\n            \"flare_up_management1___5\": \"flare_up_1_management_een\",\n            \"flare_up_management1___6\": \"flare_up_1_management_new_biologic\",\n            \"flare_up_management1___99\": \"flare_up_1_management_other\",\n            \"flare_up_management_other1\": \"flare_up_1_management_other_text\",\n            \"flare_up_timeframe2\": \"flare_up_2_date\",\n            \"flare_up_description2___1\": \"flare_up_2_description_abdominal_pain\",\n            \"flare_up_description2___2\": \"flare_up_2_description_diarrhoea\",\n            \"flare_up_description2___3\": \"flare_up_2_description_urgency\",\n            \"flare_up_description2___4\": \"flare_up_2_description_pr_bleeding\",\n            \"flare_up_description2___5\": \"flare_up_2_description_weight_loss\",\n            \"flare_up_description2___6\": \"flare_up_2_description_fever\",\n            \"flare_up_description2___7\": \"flare_up_2_description_perianal\",\n            \"flare_up_management2___1\": \"flare_up_2_management_iv_steroids\",\n            \"flare_up_management2___3\": \"flare_up_2_management_oral_steroids\",\n            \"flare_up_management2___5\": \"flare_up_2_management_een\",\n            \"flare_up_management2___6\": \"flare_up_2_management_new_biologic\",\n            \"flare_up_management2___99\": \"flare_up_2_management_other\",\n            \"flare_up_management_other2\": \"flare_up_2_management_other_text\",\n            \"unplanned_hospital\": \"unplanned_hospital_admission\",\n            \"flare_up_comment\": \"flare_up_comments\",\n            \"reason_of_use_steroid1\": \"steroid_use_1_reason\",\n            \"other_reason_use_steroid1\": \"steroid_use_1_reason_text\",\n            \"steroid_type_cu1\": \"steroid_use_1_drug\",\n            \"steroid_other_drug_cu1\": \"steroid_use_1_drug_text\",\n            \"steroid_startdate1\": \"steroid_use_1_start_date\",\n            \"still_taken_steroid1\": \"steroid_use_1_still_taking\",\n            \"steroid_enddate1\": \"steroid_use_1_end_date\",\n            \"stop_steroid_res1\": \"steroid_use_1_reason_stopped\",\n            \"steroid_change_dose1\": \"steroid_use_1_reason_changed\",\n            \"other_stop_steroid_res1\": \"steroid_use_1_reason_changed_text\",\n            \"reason_of_use_steroid2\": \"steroid_use_2_reason\",\n            \"other_reason_use_steroid2\": \"steroid_use_2_reason_text\",\n            \"steroid_type_cu2\": \"steroid_use_2_drug\",\n            \"steroid_other_drug_cu2\": \"steroid_use_2_drug_text\",\n            \"steroid_startdate2\": \"steroid_use_2_start_date\",\n            \"still_taken_steroid2\": \"steroid_use_2_still_taking\",\n            \"steroid_enddate2\": \"steroid_use_2_end_date\",\n            \"steroid_stop_reason2\": \"steroid_use_2_reason_stopped\",\n            \"steroid_change_dose2\": \"steroid_use_2_reason_changed\",\n            \"other_steroid_stop_reason2\": \"steroid_use_2_reason_changed_text\",\n            \"unplanned_hospital_reason1___1\": \"hospital_admission_1_for_acute_severe_colitis\",\n            \"unplanned_hospital_reason1___2\": \"hospital_admission_1_for_ibd_flare_not_asc\",\n            \"unplanned_hospital_reason1___3\": \"hospital_admission_1_for_perianal_disease\",\n            \"unplanned_hospital_reason1___4\": \"hospital_admission_1_for_surgery\",\n            \"unplanned_hospital_reason1___5\": \"hospital_admission_1_for_investigation_not_meeting_other_criteria\",\n            \"unplanned_hospital_reason1___99\": \"hospital_admission_1_for_other\",\n            \"unplan_adm_hosp_other1\": \"hospital_admission_1_for_other_text\",\n            \"unplaned_hos_adm_date1\": \"hospital_admission_1_admission_date\",\n            \"hospital_discharge_date1\": \"hospital_admission_1_discharge_date\",\n            \"unplanned_hospital_reason2___1\": \"hospital_admission_2_for_acute_severe_colitis\",\n            \"unplanned_hospital_reason2___2\": \"hospital_admission_2_for_ibd_flare_not_asc\",\n            \"unplanned_hospital_reason2___3\": \"hospital_admission_2_for_perianal_disease\",\n            \"unplanned_hospital_reason2___4\": \"hospital_admission_2_for_surgery\",\n            \"unplanned_hospital_reason2___5\": \"hospital_admission_2_for_investigation_not_meeting_other_criteria\",\n            \"unplanned_hospital_reason2___99\": \"hospital_admission_2_for_other\",\n            \"unplan_adm_hosp_other2\": \"hospital_admission_2_for_other_text\",\n            \"unplaned_hos_adm_date2\": \"hospital_admission_2_admission_date\",\n            \"hospital_discharge_date2\": \"hospital_admission_2_discharge_date\",\n            \"unplanned_hospital_comment\": \"hospital_admission_comments\",\n            \"dt_current_ibd_steroid\": \"new_oral_steroids_since_last_visit\",\n            \"baseline_drug_check\": \"baseline_previous_ibd_treatment\",\n            \"baseline_eims___1\": \"baseline_eims_none\",\n            \"baseline_eims___2\": \"baseline_eims_arthritis\",\n            \"baseline_eims___5\": \"baseline_eims_erythema_nodosum\",\n            \"baseline_eims___6\": \"baseline_eims_pyoderma\",\n            \"baseline_eims___10\": \"baseline_eims_uveitis\",\n            \"baseline_eims___12\": \"baseline_eims_episcleritis\",\n            \"baseline_eims_subother___1\": \"baseline_eims_iritis_scleritis\",\n            \"baseline_eims_subother___8\": \"baseline_eims_sacroileitis\",\n            \"baseline_eims_subother___11\": \"baseline_eims_conjunctivitis\",\n            \"baseline_eims_subother___14\": \"baseline_eims_angular_cheilitis\",\n            \"baseline_eims_subother___99\": \"baseline_eims_other\",\n            \"baseline_eims_other\": \"baseline_eims_other_text\",\n            \"mh_appendix1\": \"previous_appendicectomy\",\n            \"mh_tonsilout1\": \"previous_tonsillectomy\",\n            \"eims_psc\": \"baseline_eims_psc\",\n            \"mh_appendicetomy_age\": \"appendicectomy_age\",\n            \"mh_tonsilectomy_age\": \"tonsillectomy_age\",\n            \"mh_diagnosis_1\": \"pmh_1_diagnosis\",\n            \"active_diagnosis1\": \"pmh_1_active\",\n            \"mh_diagnosis_2\": \"pmh_2_diagnosis\",\n            \"active_diagnosis2\": \"pmh_2_active\",\n            \"mh_diagnosis_3\": \"pmh_3_diagnosis\",\n            \"active_diagnosis3\": \"pmh_3_active\",\n            \"mh_diagnosis_4\": \"pmh_4_diagnosis\",\n            \"active_diagnosis4\": \"pmh_4_active\",\n            \"mh_diagnosis_5\": \"pmh_5_diagnosis\",\n            \"active_diagnosis5\": \"pmh_5_active\",\n            \"mh_diagnosis_6\": \"pmh_6_diagnosis\",\n            \"active_diagnosis6\": \"pmh_6_active\",\n            \"mh_diagnosis_7\": \"pmh_7_diagnosis\",\n            \"active_diagnosis7\": \"pmh_7_active\",\n            \"mh_comments\": \"pmh_comments\",\n            \"fh_total_siblings\": \"fh_number_siblings\",\n            \"family_history_ibd\": \"fh_of_ibd_present\",\n            \"number_fh_ibd\": \"fh_of_ibd_number_affected\",\n            \"relationship_fh_ibd\": \"fh_1_relationship\",\n            \"fh_age_at_diagnosis\": \"fh_1_age_at_diagnosis\",\n            \"family_diagnosis_1\": \"fh_1_diagnosis\",\n            \"family_diagnosis_other1\": \"fh_1_diagnosis_other\",\n            \"fh_other_immune_condition1\": \"fh_1_diagnosis_other_text\",\n            \"relationship_fh_ibd_2\": \"fh_2_relationship\",\n            \"fh_age_at_diagnosis_2\": \"fh_2_age_at_diagnosis\",\n            \"family_diagnosis_2\": \"fh_2_diagnosis\",\n            \"family_diagnosis_other2\": \"fh_2_diagnosis_other\",\n            \"fh_other_immune_condition2\": \"fh_2_diagnosis_other_text\",\n            \"relationship_fh_ibd_3\": \"fh_3_relationship\",\n            \"fh_age_at_diagnosis_3\": \"fh_3_age_at_diagnosis\",\n            \"family_diagnosis_3\": \"fh_3_diagnosis\",\n            \"family_diagnosis_other3\": \"fh_3_diagnosis_other\",\n            \"fh_other_immune_condition3\": \"fh_3_diagnosis_other_text\",\n            \"relationship_fh_ibd_4\": \"fh_4_relationship\",\n            \"fh_age_at_diagnosis_4\": \"fh_4_age_at_diagnosis\",\n            \"family_diagnosis_4\": \"fh_4_diagnosis\",\n            \"family_diagnosis_other4\": \"fh_4_diagnosis_other\",\n            \"fh_other_immune_condition4\": \"fh_4_diagnosis_other_text\",\n            \"relationship_fh_ibd_5\": \"fh_5_relationship\",\n            \"fh_age_at_diagnosis_5\": \"fh_5_age_at_diagnosis\",\n            \"family_diagnosis_5\": \"fh_5_diagnosis\",\n            \"family_diagnosis_other5\": \"fh_5_diagnosis_other\",\n            \"fh_other_immune_condition5\": \"fh_5_diagnosis_other_text\",\n            \"fh_patdetailscomments\": \"fh_comments\",\n            \"gender\": \"sex\",\n            \"ibd_diagnosis_category\": \"study_group\",\n            \"incident_case\": \"new_diagnosis_of_ibd\",\n            \"fatigue_score\": \"promis_fatigue_score\",\n            \"study_site\": \"study_center\",\n            \"patient_age_diagnosis\": \"age_at_diagnosis\",\n            \"pucaiscore\": \"pucai_score\",\n            \"pcdaiscore\": \"pcdai_score\",\n            \"pcdai_freq\": \"pcdai_frequency\",\n            \"type_eim___1\": \"pcdai_eim_fever\",\n            \"type_eim___2\": \"pcdai_eim_arthritis\",\n            \"type_eim___3\": \"pcdai_eim_uveitis\",\n            \"type_eim___4\": \"pcdai_eim_erythema_nodosum\",\n            \"type_eim___5\": \"pcdai_eim_pyoderma\",\n            \"type_eim___6\": \"pcdai_eim_other\",\n            \"other_eim\": \"pcdai_eim_other_text\",\n            \"cdparis_ugidisease\": \"cdparis_upper_gi\",\n            \"een_useyn\": \"een_use\",\n            \"other_formula\": \"een_formula_type_text\",\n            \"een_startdate\": \"een_start_date\",\n            \"een_enddate\": \"een_end_date\",\n            \"still_taken_een\": \"een_still_taken\",\n            \"ucpariscomments\": \"ucparis_comments\",\n            \"patient_active_symptomyn\": \"has_active_symptoms\",\n            \"pgassessment\": \"physician_global_assessment\",\n            \"baseline_symptoms_desc2___1\": \"symptoms_abdominal_pain\",\n            \"baseline_symptoms_desc2___2\": \"symptoms_diarrhoea\",\n            \"baseline_symptoms_desc2___3\": \"symptoms_urgency\",\n            \"baseline_symptoms_desc2___4\": \"symptoms_pr_bleeding\",\n            \"baseline_symptoms_desc2___5\": \"symptoms_weight_loss\",\n            \"baseline_symptoms_desc2___6\": \"symptoms_fatigue\",\n            \"baseline_symptoms_desc2___7\": \"symptoms_perianal\",\n            \"other_symptoms\": \"symptoms_other_text\",\n            \"paris_changeyn\": \"paris_change\",\n            \"activityassesscomments\": \"disease_activity_score_comments\",\n            \"endoscopy_type___2\": \"endoscopy_type_colonoscopy\",\n            \"endoscopy_type___3\": \"endoscopy_type_upper_gi_endoscopy\",\n            \"endoscopy_result\": \"endoscopy_report\",\n            \"histopathology_report_text\": \"pathology_report\",\n            \"uceis_total_score\": \"uceis_calc\",\n            \"sescd_total_score\": \"sescd_calc\",\n            \"est_endoscopic_severity\": \"physician_endoscopic_severity\",\n            \"ct_abdomen_and_or_pelvis\": \"ct_abdomen_pelvis\",\n            \"abdominal_uss\": \"uss_abdomen\",\n            \"abdominal_x_ray\": \"axr\",\n            \"abdous_date\": \"uss_abdomen_date\",\n            \"abdous_report\": \"uss_abdomen_report\",\n            \"mrisb_date\": \"mri_small_bowel_date\",\n            \"mrisb_report\": \"mri_small_bowel_report\",\n            \"ibd_surgery_si\": \"ibd_surgery_performed\",\n            \"surgery_date_si\": \"ibd_surgery_date\",\n            \"ibd_procedure_type\": \"ibd_surgery_procedure\",\n            \"ibd_procedure_type_other\": \"ibd_surgery_procedure_other\",\n            \"ibd_other_specify_proc\": \"ibd_surgery_procedure_other_text\",\n            \"ibd_procedure_result\": \"ibd_surgery_comments\",\n            \"histologycomments_si\": \"ibd_surgery_histology_report\",\n            \"blood_test_date1\": \"nhs_bloods_date\",\n            \"faecal_test_date_2\": \"calprotectin_date\",\n            \"other_drug_level_assessed\": \"other_drug_level\",\n            \"date_biologic_level\": \"drug_level_date\",\n            \"drug_level_inflxi\": \"ifx_level\",\n            \"drug_level_adalimumab\": \"ada_level\",\n            \"drug_level_antibody_adali\": \"ada_antibody\",\n            \"drug_level_antibody_inflx\": \"ifx_antibody\",\n            \"patdetailscomments_as_lbt\": \"lab_tests_comments\",\n            \"comment_if_any_of_these_qu\": \"proms_comments\",\n            \"meds_summary___1\": \"sampling_asa\",\n            \"meds_summary___2\": \"sampling_een\",\n            \"meds_summary___13\": \"sampling_on_no_meds\",\n            \"meds_summary___3\": \"sampling_steroids_oral\",\n            \"meds_summary___4\": \"sampling_steroids_iv\",\n            \"meds_summary___5\": \"sampling_steroids_topical\",\n            \"meds_summary___6\": \"sampling_imm\",\n            \"meds_summary___7\": \"sampling_mtx\",\n            \"meds_summary___8\": \"sampling_ifx\",\n            \"meds_summary___9\": \"sampling_ada\",\n            \"meds_summary___10\": \"sampling_vedo\",\n            \"meds_summary___11\": \"sampling_uste\",\n            \"meds_summary___12\": \"sampling_other\",\n            \"other_drug_summary\": \"sampling_other_text\",\n            \"drug\": \"ibd_drug_1_name\",\n            \"other_drug\": \"ibd_drug_1_name_other\",\n            \"drug_dose\": \"ibd_drug_1_dose\",\n            \"drug_frequency\": \"ibd_drug_1_frequency\",\n            \"drug_other_frequency\": \"ibd_drug_1_frequency_other\",\n            \"drug_start_date\": \"ibd_drug_1_start_date\",\n            \"still_taken_drug0\": \"ibd_drug_1_still_taking\",\n            \"drug_end_date\": \"ibd_drug_1_end_date\",\n            \"reason_stop_drug_0\": \"ibd_drug_1_reason_stopped\",\n            \"bpt_other_reason_0\": \"ibd_drug_1_reason_stopped_text\",\n            \"drug_1\": \"ibd_drug_2_name\",\n            \"other_drug_1\": \"ibd_drug_2_name_other\",\n            \"drug_dose_1\": \"ibd_drug_2_dose\",\n            \"currently_frequency_use_1\": \"ibd_drug_2_frequency\",\n            \"drug_other_frequency_1\": \"ibd_drug_2_frequency_other\",\n            \"drug_startdate1\": \"ibd_drug_2_start_date\",\n            \"still_taken_drug1\": \"ibd_drug_2_still_taking\",\n            \"other_drug_enddate\": \"ibd_drug_2_end_date\",\n            \"reason_stop_drug_1\": \"ibd_drug_2_reason_stopped\",\n            \"bpt_other_reason_1\": \"ibd_drug_2_reason_stopped_text\",\n            \"drug_2\": \"ibd_drug_3_name\",\n            \"other_drug_2\": \"ibd_drug_3_name_other\",\n            \"drug_dose_2\": \"ibd_drug_3_dose\",\n            \"currently_frequency_use_2\": \"ibd_drug_3_frequency\",\n            \"drug_other_frequency_2\": \"ibd_drug_3_frequency_other\",\n            \"drug_startdate_2\": \"ibd_drug_3_start_date\",\n            \"still_taken_drug2\": \"ibd_drug_3_still_taking\",\n            \"drug_enddate_2\": \"ibd_drug_3_end_date\",\n            \"reason_stop_drug_2\": \"ibd_drug_3_reason_stopped\",\n            \"bpt_other_reason_2\": \"ibd_drug_3_reason_stopped_text\",\n            \"drug_3\": \"ibd_drug_4_name\",\n            \"other_drug_3\": \"ibd_drug_4_name_other\",\n            \"drug_dose_3\": \"ibd_drug_4_dose\",\n            \"currently_frequency_use_3\": \"ibd_drug_4_frequency\",\n            \"drug_other_frequency_3\": \"ibd_drug_4_frequency_other\",\n            \"drug_startdate_3\": \"ibd_drug_4_start_date\",\n            \"still_taken_drug3\": \"ibd_drug_4_still_taking\",\n            \"drug_enddate_3\": \"ibd_drug_4_end_date\",\n            \"reason_stop_drug_3\": \"ibd_drug_4_reason_stopped\",\n            \"bpt_other_reason_3\": \"ibd_drug_4_reason_stopped_text\",\n            \"drug_4\": \"ibd_drug_5_name\",\n            \"other_drug_4\": \"ibd_drug_5_name_other\",\n            \"drug_dose_4\": \"ibd_drug_5_dose\",\n            \"currently_frequency_use_4\": \"ibd_drug_5_frequency\",\n            \"drug_other_frequency_4\": \"ibd_drug_5_frequency_other\",\n            \"drug_startdate_4\": \"ibd_drug_5_start_date\",\n            \"still_taken_drug4\": \"ibd_drug_5_still_taking\",\n            \"drug_enddate_4\": \"ibd_drug_5_end_date\",\n            \"reason_stop_drug_4\": \"ibd_drug_5_reason_stopped\",\n            \"bpt_other_reason_4\": \"ibd_drug_5_reason_stopped_text\",\n            \"non_ibddrugyn\": \"concomitant_non_ibd_drug\",\n            \"conc_drug_cm1\": \"concomitant_drug_1_name\",\n            \"concomit_other_drug_cm1\": \"concomitant_drug_1_name_other\",\n            \"dt_conc_dose\": \"concomitant_drug_1_dose\",\n            \"conc_frequency1\": \"concomitant_drug_1_frequency\",\n            \"conc_frequencyother1\": \"concomitant_drug_1_frequency_other\",\n            \"conc_drug_cm2\": \"concomitant_drug_2_name\",\n            \"concomit_other_drug_cm2\": \"concomitant_drug_2_name_other\",\n            \"dt_conc_dose_2\": \"concomitant_drug_2_dose\",\n            \"conc_frequency2\": \"concomitant_drug_2_frequency\",\n            \"conc_frequencyother2\": \"concomitant_drug_2_frequency_other\",\n            \"conc_drug_cm3\": \"concomitant_drug_3_name\",\n            \"concomit_other_drug_cm3\": \"concomitant_drug_3_name_other\",\n            \"dt_conc_dose_3\": \"concomitant_drug_3_dose\",\n            \"conc_frequency3\": \"concomitant_drug_3_frequency\",\n            \"conc_frequencyother3\": \"concomitant_drug_3_frequency_other\",\n            \"conc_drug_cm4\": \"concomitant_drug_4_name\",\n            \"concomit_other_drug_cm4\": \"concomitant_drug_4_name_other\",\n            \"dt_conc_dose_4\": \"concomitant_drug_4_dose\",\n            \"conc_frequency4\": \"concomitant_drug_4_frequency\",\n            \"conc_frequencyother4\": \"concomitant_drug_4_frequency_other\",\n            \"conc_drug_cm5\": \"concomitant_drug_5_name\",\n            \"concomit_other_drug_cm5\": \"concomitant_drug_5_name_other\",\n            \"dt_conc_dose_5\": \"concomitant_drug_5_dose\",\n            \"conc_frequency5\": \"concomitant_drug_5_frequency\",\n            \"conc_frequencyother5\": \"concomitant_drug_5_frequency_other\",\n            \"drug_comments_prvcm\": \"current_drugs_comments\",\n            \"baseline_current_drug\": \"baseline_ibd_drug_1\",\n            \"baseline_current_other1\": \"baseline_ibd_drug_1_other\",\n            \"baseline_current_otherx1\": \"baseline_ibd_drug_1_other_text\",\n            \"baseline_current_ibd_dose1\": \"baseline_ibd_drug_1_dose\",\n            \"bl_current_frequency_use1\": \"baseline_ibd_drug_1_frequency\",\n            \"bl_prev_frequency_other1\": \"baseline_ibd_drug_1_frequency_other\",\n            \"baseline_start_date_ibd1\": \"baseline_ibd_drug_1_start_date\",\n            \"baseline_end_date1\": \"baseline_ibd_drug_1_end_date\",\n            \"baseline_drug_stop1\": \"baseline_ibd_drug_1_reason_stopped\",\n            \"baseline_other_reason1\": \"baseline_ibd_drug_1_reason_stopped_text\",\n            \"baseline_current_drug_2\": \"baseline_ibd_drug_2\",\n            \"baseline_current_other2\": \"baseline_ibd_drug_2_other\",\n            \"baseline_current_otherx2\": \"baseline_ibd_drug_2_other_text\",\n            \"baseline_current_ibd_dose2\": \"baseline_ibd_drug_2_dose\",\n            \"bl_current_frequency_use2\": \"baseline_ibd_drug_2_frequency\",\n            \"bl_prev_frequency_other2\": \"baseline_ibd_drug_2_frequency_other\",\n            \"baseline_start_date_ibd2\": \"baseline_ibd_drug_2_start_date\",\n            \"baseline_end_date2\": \"baseline_ibd_drug_2_end_date\",\n            \"baseline_drug_stop2\": \"baseline_ibd_drug_2_reason_stopped\",\n            \"baseline_other_reason2\": \"baseline_ibd_drug_2_reason_stopped_text\",\n            \"baseline_current_drug_3\": \"baseline_ibd_drug_3\",\n            \"baseline_current_other3\": \"baseline_ibd_drug_3_other\",\n            \"baseline_current_otherx3\": \"baseline_ibd_drug_3_other_text\",\n            \"baseline_current_ibd_dose3\": \"baseline_ibd_drug_3_dose\",\n            \"bl_current_frequency_use3\": \"baseline_ibd_drug_3_frequency\",\n            \"bl_prev_frequency_other3\": \"baseline_ibd_drug_3_frequency_other\",\n            \"baseline_start_date_ibd3\": \"baseline_ibd_drug_3_start_date\",\n            \"baseline_end_date3\": \"baseline_ibd_drug_3_end_date\",\n            \"baseline_drug_stop3\": \"baseline_ibd_drug_3_reason_stopped\",\n            \"baseline_other_reason3\": \"baseline_ibd_drug_3_reason_stopped_text\",\n            \"baseline_current_drug_4\": \"baseline_ibd_drug_4\",\n            \"baseline_current_other4\": \"baseline_ibd_drug_4_other\",\n            \"baseline_current_otherx4\": \"baseline_ibd_drug_4_other_text\",\n            \"baseline_current_ibd_dose4\": \"baseline_ibd_drug_4_dose\",\n            \"bl_current_frequency_use4\": \"baseline_ibd_drug_4_frequency\",\n            \"bl_prev_frequency_other4\": \"baseline_ibd_drug_4_frequency_other\",\n            \"baseline_start_date_ibd4\": \"baseline_ibd_drug_4_start_date\",\n            \"baseline_end_date4\": \"baseline_ibd_drug_4_end_date\",\n            \"baseline_drug_stop4\": \"baseline_ibd_drug_4_reason_stopped\",\n            \"baseline_other_reason4\": \"baseline_ibd_drug_4_reason_stopped_text\",\n            \"baseline_current_drug_5\": \"baseline_ibd_drug_5\",\n            \"baseline_current_other5\": \"baseline_ibd_drug_5_other\",\n            \"baseline_current_otherx5\": \"baseline_ibd_drug_5_other_text\",\n            \"baseline_current_ibd_dose5\": \"baseline_ibd_drug_5_dose\",\n            \"bl_current_frequency_use5\": \"baseline_ibd_drug_5_frequency\",\n            \"bl_prev_frequency_other5\": \"baseline_ibd_drug_5_frequency_other\",\n            \"baseline_start_date_ibd5\": \"baseline_ibd_drug_5_start_date\",\n            \"baseline_end_date5\": \"baseline_ibd_drug_5_end_date\",\n            \"baseline_drug_stop5\": \"baseline_ibd_drug_5_reason_stopped\",\n            \"baseline_other_reason5\": \"baseline_ibd_drug_5_reason_stopped_text\",\n        },\n        inplace=True,\n    )\n\n    # Drug Mapping\n    baseline_ibd_drug_map = {\n        \"21\": \"asa\",\n        \"1\": \"ada\",\n        \"2\": \"aza\",\n        \"16\": \"mp\",\n        \"3\": \"ifx\",\n        \"11\": \"uste\",\n        \"12\": \"vedo\",\n        \"15\": \"goli\",\n        \"10\": \"tofa\",\n        \"13\": \"een\",\n        \"99\": \"other\",\n    }\n\n    df[\"baseline_ibd_drug_1\"] = df[\"baseline_ibd_drug_1\"].map(baseline_ibd_drug_map)\n    df[\"baseline_ibd_drug_2\"] = df[\"baseline_ibd_drug_2\"].map(baseline_ibd_drug_map)\n    df[\"baseline_ibd_drug_3\"] = df[\"baseline_ibd_drug_3\"].map(baseline_ibd_drug_map)\n    df[\"baseline_ibd_drug_4\"] = df[\"baseline_ibd_drug_4\"].map(baseline_ibd_drug_map)\n    df[\"baseline_ibd_drug_5\"] = df[\"baseline_ibd_drug_5\"].map(baseline_ibd_drug_map)\n\n    baseline_ibd_other_drug_map = {\n        \"14\": \"mtx\",\n        \"8\": \"steroid_enema\",\n        \"9\": \"steroid_suppositories\",\n        \"4\": \"mesalazine_enema\",\n        \"5\": \"asa\",\n        \"6\": \"mesalazine_suppositories\",\n        \"19\": \"methylprednisolone\",\n        \"7\": \"prednisolone\",\n        \"13\": \"budesonide\",\n        \"99\": \"other\",\n    }\n\n    df[\"baseline_ibd_drug_1_other\"] = df[\"baseline_ibd_drug_1_other\"].map(\n        baseline_ibd_other_drug_map\n    )\n    df[\"baseline_ibd_drug_2_other\"] = df[\"baseline_ibd_drug_2_other\"].map(\n        baseline_ibd_other_drug_map\n    )\n    df[\"baseline_ibd_drug_3_other\"] = df[\"baseline_ibd_drug_3_other\"].map(\n        baseline_ibd_other_drug_map\n    )\n    df[\"baseline_ibd_drug_4_other\"] = df[\"baseline_ibd_drug_4_other\"].map(\n        baseline_ibd_other_drug_map\n    )\n    df[\"baseline_ibd_drug_5_other\"] = df[\"baseline_ibd_drug_5_other\"].map(\n        baseline_ibd_other_drug_map\n    )\n\n    ibd_drug_map = {\n        \"1\": \"ada\",\n        \"2\": \"aza\",\n        \"57\": \"een\",\n        \"16\": \"mp\",\n        \"14\": \"mtx\",\n        \"3\": \"ifx\",\n        \"11\": \"uste\",\n        \"12\": \"vedo\",\n        \"15\": \"goli\",\n        \"10\": \"tofa\",\n        \"17\": \"filgo\",\n        \"18\": \"upa\",\n        \"8\": \"steroid_enema\",\n        \"9\": \"steroid_suppositories\",\n        \"4\": \"mesalazine_enema\",\n        \"5\": \"asa\",\n        \"6\": \"mesalazine_suppositories\",\n        \"19\": \"methylprednisolone\",\n        \"7\": \"prednisolone\",\n        \"13\": \"budesonide\",\n        \"99\": \"other\",\n    }\n\n    df[\"ibd_drug_1_name\"] = df[\"ibd_drug_1_name\"].map(ibd_drug_map)\n    df[\"ibd_drug_2_name\"] = df[\"ibd_drug_2_name\"].map(ibd_drug_map)\n    df[\"ibd_drug_3_name\"] = df[\"ibd_drug_3_name\"].map(ibd_drug_map)\n    df[\"ibd_drug_4_name\"] = df[\"ibd_drug_4_name\"].map(ibd_drug_map)\n    df[\"ibd_drug_5_name\"] = df[\"ibd_drug_5_name\"].map(ibd_drug_map)\n\n    concomitant_drug_map = {\n        \"1\": \"opiates\",\n        \"2\": \"antibiotics\",\n        \"3\": \"proton_pump_inhibitors\",\n        \"4\": \"non_steroidals\",\n        \"99\": \"other\",\n    }\n\n    df[\"concomitant_drug_1_name\"] = df[\"concomitant_drug_1_name\"].map(\n        concomitant_drug_map\n    )\n    df[\"concomitant_drug_2_name\"] = df[\"concomitant_drug_2_name\"].map(\n        concomitant_drug_map\n    )\n    df[\"concomitant_drug_3_name\"] = df[\"concomitant_drug_3_name\"].map(\n        concomitant_drug_map\n    )\n    df[\"concomitant_drug_4_name\"] = df[\"concomitant_drug_4_name\"].map(\n        concomitant_drug_map\n    )\n    df[\"concomitant_drug_5_name\"] = df[\"concomitant_drug_5_name\"].map(\n        concomitant_drug_map\n    )\n\n    drug_frequency_map = {\n        \"1\": \"od\",\n        \"2\": \"bd\",\n        \"3\": \"tds\",\n        \"4\": \"qds\",\n        \"5\": \"once_a_week\",\n        \"6\": \"fortnightly\",\n        \"7\": \"monthly\",\n        \"8\": \"six_weekly\",\n        \"9\": \"eight_weekly\",\n        \"10\": \"three_monthly\",\n        \"11\": \"prn\",\n        \"12\": \"alternate_days\",\n        \"13\": \"six_times_a_day\",\n        \"14\": \"five_times_a_day\",\n        \"99\": \"other\",\n    }\n\n    df[\"ibd_drug_1_frequency\"] = df[\"ibd_drug_1_frequency\"].map(drug_frequency_map)\n    df[\"ibd_drug_2_frequency\"] = df[\"ibd_drug_2_frequency\"].map(drug_frequency_map)\n    df[\"ibd_drug_3_frequency\"] = df[\"ibd_drug_3_frequency\"].map(drug_frequency_map)\n    df[\"ibd_drug_4_frequency\"] = df[\"ibd_drug_4_frequency\"].map(drug_frequency_map)\n    df[\"ibd_drug_5_frequency\"] = df[\"ibd_drug_5_frequency\"].map(drug_frequency_map)\n    df[\"concomitant_drug_1_frequency\"] = df[\"concomitant_drug_1_frequency\"].map(\n        drug_frequency_map\n    )\n    df[\"concomitant_drug_2_frequency\"] = df[\"concomitant_drug_2_frequency\"].map(\n        drug_frequency_map\n    )\n    df[\"concomitant_drug_3_frequency\"] = df[\"concomitant_drug_3_frequency\"].map(\n        drug_frequency_map\n    )\n    df[\"concomitant_drug_4_frequency\"] = df[\"concomitant_drug_4_frequency\"].map(\n        drug_frequency_map\n    )\n    df[\"concomitant_drug_5_frequency\"] = df[\"concomitant_drug_5_frequency\"].map(\n        drug_frequency_map\n    )\n    df[\"baseline_ibd_drug_1_frequency\"] = df[\"baseline_ibd_drug_1_frequency\"].map(\n        drug_frequency_map\n    )\n    df[\"baseline_ibd_drug_2_frequency\"] = df[\"baseline_ibd_drug_2_frequency\"].map(\n        drug_frequency_map\n    )\n    df[\"baseline_ibd_drug_3_frequency\"] = df[\"baseline_ibd_drug_3_frequency\"].map(\n        drug_frequency_map\n    )\n    df[\"baseline_ibd_drug_4_frequency\"] = df[\"baseline_ibd_drug_4_frequency\"].map(\n        drug_frequency_map\n    )\n    df[\"baseline_ibd_drug_5_frequency\"] = df[\"baseline_ibd_drug_5_frequency\"].map(\n        drug_frequency_map\n    )\n\n    reason_stopped_map = {\n        \"1\": \"primary_non_response\",\n        \"2\": \"secondary_non_response\",\n        \"3\": \"treatment_completed\",\n        \"9\": \"intolerance\",\n        \"7\": \"adverse_effects\",\n        \"10\": \"confirmed_immunogenicity\",\n        \"99\": \"other\",\n    }\n\n    df[\"ibd_drug_1_reason_stopped\"] = df[\"ibd_drug_1_reason_stopped\"].map(\n        reason_stopped_map\n    )\n    df[\"ibd_drug_2_reason_stopped\"] = df[\"ibd_drug_2_reason_stopped\"].map(\n        reason_stopped_map\n    )\n    df[\"ibd_drug_3_reason_stopped\"] = df[\"ibd_drug_3_reason_stopped\"].map(\n        reason_stopped_map\n    )\n    df[\"ibd_drug_4_reason_stopped\"] = df[\"ibd_drug_4_reason_stopped\"].map(\n        reason_stopped_map\n    )\n    df[\"ibd_drug_5_reason_stopped\"] = df[\"ibd_drug_5_reason_stopped\"].map(\n        reason_stopped_map\n    )\n    df[\"baseline_ibd_drug_1_reason_stopped\"] = df[\n        \"baseline_ibd_drug_1_reason_stopped\"\n    ].map(reason_stopped_map)\n    df[\"baseline_ibd_drug_2_reason_stopped\"] = df[\n        \"baseline_ibd_drug_2_reason_stopped\"\n    ].map(reason_stopped_map)\n    df[\"baseline_ibd_drug_3_reason_stopped\"] = df[\n        \"baseline_ibd_drug_3_reason_stopped\"\n    ].map(reason_stopped_map)\n    df[\"baseline_ibd_drug_4_reason_stopped\"] = df[\n        \"baseline_ibd_drug_4_reason_stopped\"\n    ].map(reason_stopped_map)\n    df[\"baseline_ibd_drug_5_reason_stopped\"] = df[\n        \"baseline_ibd_drug_5_reason_stopped\"\n    ].map(reason_stopped_map)\n\n    df[\"fh_of_ibd_present\"] = df[\"fh_of_ibd_present\"].map(\n        {\"1\": \"yes\", \"2\": \"no\", \"3\": \"unclear\"}\n    )\n\n    fh_diagnosis_map = {\n        \"6\": \"cd\",\n        \"7\": \"uc\",\n        \"9\": \"ibdu\",\n        \"10\": \"possible_cd\",\n        \"11\": \"possible_uc\",\n        \"12\": \"possible_ibd\",\n        \"99\": \"other\",\n    }\n\n    fh_diagnosis_other_map = {\n        \"1\": \"multiple_sclerosis\",\n        \"2\": \"psoriasis\",\n        \"3\": \"coeliac_disease\",\n        \"4\": \"ankylosing_spondylitis\",\n        \"5\": \"colorectal_cancer\",\n        \"8\": \"ibs\",\n        \"13\": \"any_cancer\",\n        \"99\": \"other\",\n    }\n\n    fh_relationship_map = {\n        \"1\": \"parent\",\n        \"27\": \"mother\",\n        \"28\": \"father\",\n        \"2\": \"sibling\",\n        \"3\": \"sister\",\n        \"4\": \"brother\",\n        \"5\": \"cousin\",\n        \"6\": \"uncle\",\n        \"7\": \"aunt\",\n        \"8\": \"uncle_maternal\",\n        \"9\": \"aunt_maternal\",\n        \"10\": \"uncle_paternal\",\n        \"11\": \"aunt_paternal\",\n        \"29\": \"grandparent\",\n        \"12\": \"grandmother_paternal\",\n        \"24\": \"grandmother_maternal\",\n        \"25\": \"grandfather_paternal\",\n        \"26\": \"grandfather_maternal\",\n        \"30\": \"granduncle_paternal\",\n        \"31\": \"granduncle_maternal\",\n        \"13\": \"half_brother\",\n        \"14\": \"half_sister\",\n        \"15\": \"nephew\",\n        \"16\": \"niece\",\n        \"17\": \"grandson\",\n        \"18\": \"granddaughter\",\n        \"19\": \"other_2nd_degree\",\n        \"20\": \"other_3rd_degree\",\n        \"21\": \"other_4th_degree\",\n        \"22\": \"dizygotic_twin\",\n        \"23\": \"monozygotic_twin\",\n    }\n\n    df[\"fh_1_diagnosis\"] = df[\"fh_1_diagnosis\"].map(fh_diagnosis_map)\n    df[\"fh_2_diagnosis\"] = df[\"fh_2_diagnosis\"].map(fh_diagnosis_map)\n    df[\"fh_3_diagnosis\"] = df[\"fh_3_diagnosis\"].map(fh_diagnosis_map)\n    df[\"fh_4_diagnosis\"] = df[\"fh_4_diagnosis\"].map(fh_diagnosis_map)\n    df[\"fh_5_diagnosis\"] = df[\"fh_5_diagnosis\"].map(fh_diagnosis_map)\n\n    df[\"fh_1_diagnosis_other\"] = df[\"fh_1_diagnosis_other\"].map(fh_diagnosis_other_map)\n    df[\"fh_2_diagnosis_other\"] = df[\"fh_2_diagnosis_other\"].map(fh_diagnosis_other_map)\n    df[\"fh_3_diagnosis_other\"] = df[\"fh_3_diagnosis_other\"].map(fh_diagnosis_other_map)\n    df[\"fh_4_diagnosis_other\"] = df[\"fh_4_diagnosis_other\"].map(fh_diagnosis_other_map)\n    df[\"fh_5_diagnosis_other\"] = df[\"fh_5_diagnosis_other\"].map(fh_diagnosis_other_map)\n\n    df[\"fh_1_relationship\"] = df[\"fh_1_relationship\"].map(fh_relationship_map)\n    df[\"fh_2_relationship\"] = df[\"fh_2_relationship\"].map(fh_relationship_map)\n    df[\"fh_3_relationship\"] = df[\"fh_3_relationship\"].map(fh_relationship_map)\n    df[\"fh_4_relationship\"] = df[\"fh_4_relationship\"].map(fh_relationship_map)\n    df[\"fh_5_relationship\"] = df[\"fh_5_relationship\"].map(fh_relationship_map)\n\n    df[\"new_flare_up\"] = df[\"new_flare_up\"].map(\n        {\n            \"0\": \"no\",\n            \"1\": \"yes\",\n            \"3\": \"ongoing_from_previous_visit\",\n        }\n    )\n    df[\"flare_up_1_setting\"] = df[\"flare_up_1_setting\"].map(\n        {\"1\": \"outpatient\", \"2\": \"inpatient\"}\n    )\n    df[\"flare_up_2_setting\"] = df[\"flare_up_2_setting\"].map(\n        {\"1\": \"outpatient\", \"2\": \"inpatient\"}\n    )\n    df[\"steroid_use_1_reason\"] = df[\"steroid_use_1_reason\"].map(\n        {\"1\": \"flare_up\", \"99\": \"other\"}\n    )\n    df[\"steroid_use_2_reason\"] = df[\"steroid_use_2_reason\"].map(\n        {\"1\": \"flare_up\", \"99\": \"other\"}\n    )\n    df[\"steroid_use_1_drug\"] = df[\"steroid_use_1_drug\"].map(\n        {\n            \"8\": \"steroid_enema\",\n            \"9\": \"steroid_suppositories\",\n            \"7\": \"prednisolone\",\n            \"13\": \"budesonide\",\n            \"21\": \"budesonide\",\n            \"20\": \"hydrocortisone\",\n            \"19\": \"methylprednisolone\",\n            \"99\": \"other\",\n        }\n    )\n    df[\"steroid_use_2_drug\"] = df[\"steroid_use_2_drug\"].map(\n        {\n            \"8\": \"steroid_enema\",\n            \"9\": \"steroid_suppositories\",\n            \"7\": \"prednisolone\",\n            \"13\": \"budesonide\",\n            \"21\": \"budesonide\",\n            \"20\": \"hydrocortisone\",\n            \"19\": \"methylprednisolone\",\n            \"99\": \"other\",\n        }\n    )\n    df[\"steroid_use_1_still_taking\"] = df[\"steroid_use_1_still_taking\"].map(\n        {\"1\": \"yes\", \"0\": \"no\"}\n    )\n    df[\"steroid_use_2_still_taking\"] = df[\"steroid_use_2_still_taking\"].map(\n        {\"1\": \"yes\", \"0\": \"no\"}\n    )\n\n    # this differs from music\n    df[\"steroid_use_1_reason_stopped\"] = df[\"steroid_use_1_reason_stopped\"].map(\n        {\n            \"1\": \"primary_non_response\",\n            \"2\": \"successful_steroid_wean\",\n            \"3\": \"change_in_preparation\",\n            \"4\": \"intolerance\",\n            \"5\": \"adverse_effects\",\n            \"99\": \"other\",\n        }\n    )\n    df[\"steroid_use_2_reason_stopped\"] = df[\"steroid_use_2_reason_stopped\"].map(\n        {\n            \"1\": \"primary_non_response\",\n            \"2\": \"successful_steroid_wean\",\n            \"3\": \"change_in_preparation\",\n            \"4\": \"intolerance\",\n            \"5\": \"adverse_effects\",\n            \"99\": \"other\",\n        }\n    )\n    df[\"steroid_use_1_reason_changed\"] = df[\"steroid_use_1_reason_changed\"].map(\n        {\"1\": \"increased_for_symptom_control\", \"2\": \"planned_reduction\", \"99\": \"other\"}\n    )\n    df[\"steroid_use_2_reason_changed\"] = df[\"steroid_use_2_reason_changed\"].map(\n        {\"1\": \"increased_for_symptom_control\", \"2\": \"planned_reduction\", \"99\": \"other\"}\n    )\n\n    df[\"new_oral_steroids_since_last_visit\"] = df[\n        \"new_oral_steroids_since_last_visit\"\n    ].map({\"1\": \"yes\", \"0\": \"no\", \"3\": \"ongoing_since_last_visit\"})\n\n    df[\"has_active_symptoms\"] = df[\"has_active_symptoms\"].map({\"1\": \"yes\", \"0\": \"no\"})\n    df[\"paris_change\"] = df[\"paris_change\"].map({\"1\": \"yes\", \"0\": \"no\"})\n    df[\"symptoms_abdominal_pain\"] = df[\"symptoms_abdominal_pain\"].map(\n        {\"1\": \"yes\", \"0\": \"no\"}\n    )\n    df[\"symptoms_diarrhoea\"] = df[\"symptoms_diarrhoea\"].map({\"1\": \"yes\", \"0\": \"no\"})\n    df[\"symptoms_urgency\"] = df[\"symptoms_urgency\"].map({\"1\": \"yes\", \"0\": \"no\"})\n    df[\"symptoms_pr_bleeding\"] = df[\"symptoms_pr_bleeding\"].map({\"1\": \"yes\", \"0\": \"no\"})\n    df[\"symptoms_weight_loss\"] = df[\"symptoms_weight_loss\"].map({\"1\": \"yes\", \"0\": \"no\"})\n    df[\"symptoms_fatigue\"] = df[\"symptoms_fatigue\"].map({\"1\": \"yes\", \"0\": \"no\"})\n    df[\"symptoms_perianal\"] = df[\"symptoms_perianal\"].map({\"1\": \"yes\", \"0\": \"no\"})\n\n    df[\"een_use\"] = df[\"een_use\"].map({\"1\": \"yes\", \"0\": \"no\"})\n\n    df[\"een_formula_type\"] = df[\"een_formula_type\"].map(\n        {\n            \"1\": \"modulen_ibd\",\n            \"2\": \"fortisip\",\n            \"3\": \"nutrison_energy\",\n            \"4\": \"elemental_eo28\",\n            \"5\": \"pediasure\",\n            \"6\": \"nutrini\",\n            \"7\": \"neocate_jr\",\n            \"8\": \"other\",\n        }\n    )\n    df[\"een_still_taken\"] = df[\"een_still_taken\"].map(\n        {\n            \"1\": \"yes\",\n            \"0\": \"no\",\n        }\n    )\n    df[\"unplanned_hospital_admission\"] = df[\"unplanned_hospital_admission\"].map(\n        {\n            \"0\": \"no\",\n            \"1\": \"yes\",\n        }\n    )\n    df[\"new_diagnosis_of_ibd\"] = df[\"new_diagnosis_of_ibd\"].map({\"1\": \"yes\", \"2\": \"no\"})\n    df[\"redcap_event_name\"] = df[\"redcap_event_name\"].map(\n        {\n            \"timepoint_1_arm_1\": \"timepoint_1\",\n            \"timepoint_2_arm_1\": \"timepoint_2\",\n            \"timepoint_3_arm_1\": \"timepoint_3\",\n        }\n    )\n    df[\"sex\"] = df[\"sex\"].map(\n        {\n            \"1\": \"male\",\n            \"2\": \"female\",\n        }\n    )\n    df[\"study_group\"] = df[\"study_group\"].map(\n        {\n            \"1\": \"cd\",\n            \"2\": \"uc\",\n            \"3\": \"ibdu\",\n            \"4\": \"non_ibd\",\n        }\n    )\n\n    df[\"disease_activity\"] = df[\"disease_activity\"].map(\n        {\n            \"1\": \"remission\",\n            \"2\": \"mild\",\n            \"3\": \"moderate\",\n            \"4\": \"severe\",\n            \"5\": \"not_applicable\",\n        }\n    )\n\n    df[\"physician_global_assessment\"] = df[\"physician_global_assessment\"].map(\n        {\n            \"1\": \"biochem_remission\",\n            \"2\": \"clinical_remission\",\n            \"3\": \"mild\",\n            \"4\": \"moderate\",\n            \"5\": \"severe\",\n            \"-1000\": \"not_applicable\",\n        }\n    )\n\n    df[\"study_center\"] = df[\"study_center\"].map(\n        {\"1\": \"edinburgh\", \"2\": \"glasgow\", \"3\": \"dundee\", \"4\": \"aberdeen\", \"5\": \"other\"}\n    )\n\n    df[\"patient_age_group\"] = df[\"patient_age_group\"].map(\n        {\n            \"0\": \"6-10\",\n            \"1\": \"10-13\",\n            \"2\": \"14-18\",\n            \"99\": \"no_data\",\n        }\n    )\n    df[\"pucai_pain\"] = df[\"pucai_pain\"].map(\n        {\n            \"0\": \"0\",\n            \"1\": \"5\",\n            \"2\": \"10\",\n        }\n    )\n\n    df[\"pucai_bleeding\"] = df[\"pucai_bleeding\"].map(\n        {\n            \"0\": \"0\",\n            \"1\": \"10\",\n            \"2\": \"20\",\n            \"3\": \"30\",\n        }\n    )\n\n    df[\"pucai_consistency\"] = df[\"pucai_consistency\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"5\",\n            \"3\": \"10\",\n        }\n    )\n\n    df[\"pucai_stools\"] = df[\"pucai_stools\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"5\",\n            \"3\": \"10\",\n            \"4\": \"15\",\n        }\n    )\n\n    df[\"pucai_nocturnal\"] = df[\"pucai_nocturnal\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"10\",\n        }\n    )\n\n    df[\"pucai_activity\"] = df[\"pucai_activity\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"5\",\n            \"3\": \"10\",\n        }\n    )\n\n    df[\"pcdai_pain\"] = df[\"pcdai_pain\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"10\",\n            \"3\": \"20\",\n        }\n    )\n\n    df[\"pcdai_general\"] = df[\"pcdai_general\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"10\",\n            \"3\": \"20\",\n        }\n    )\n\n    df[\"pcdai_frequency\"] = df[\"pcdai_frequency\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"7.5\",\n            \"3\": \"15\",\n        }\n    )\n\n    df[\"pcdai_esr\"] = df[\"pcdai_esr\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"7.5\",\n            \"3\": \"15\",\n        }\n    )\n\n    df[\"pcdai_alb\"] = df[\"pcdai_alb\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"10\",\n            \"3\": \"20\",\n        }\n    )\n\n    df[\"pcdai_weight\"] = df[\"pcdai_weight\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"5\",\n            \"3\": \"10\",\n        }\n    )\n\n    df[\"pcdai_perianal\"] = df[\"pcdai_perianal\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"7.5\",\n            \"3\": \"15\",\n        }\n    )\n\n    df[\"pcdai_eim\"] = df[\"pcdai_eim\"].map(\n        {\n            \"1\": \"0\",\n            \"2\": \"10\",\n        }\n    )\n\n    df[\"cdparis_upper_gi\"] = df[\"cdparis_upper_gi\"].map(\n        {\n            \"1\": \"L4a\",\n            \"2\": \"L4b\",\n            \"3\": \"none\",\n        }\n    )\n\n    df[\"cdparis_behaviour\"] = df[\"cdparis_behaviour\"].map(\n        {\n            \"0\": \"B1\",\n            \"1\": \"B2\",\n            \"2\": \"B3\",\n            \"3\": \"B2+B3\",\n        }\n    )\n\n    df[\"cdparis_location\"] = df[\"cdparis_location\"].map(\n        {\n            \"1\": \"L1\",\n            \"2\": \"L2\",\n            \"3\": \"L3\",\n            \"4\": \"L4\",\n        }\n    )\n\n    df[\"cdparis_growth\"] = df[\"cdparis_growth\"].map(\n        {\n            \"0\": \"G0\",\n            \"1\": \"G1\",\n        }\n    )\n\n    df[\"cdparis_perianal\"] = df[\"cdparis_perianal\"].map({\"1\": \"yes\", \"0\": \"no\"})\n\n    df[\"ucparis_severity\"] = df[\"ucparis_severity\"].map(\n        {\n            \"0\": \"S0\",\n            \"1\": \"S1\",\n        }\n    )\n\n    df[\"ucparis_extent\"] = df[\"ucparis_extent\"].map(\n        {\n            \"0\": \"E1\",\n            \"1\": \"E2\",\n            \"2\": \"E3\",\n            \"3\": \"E4\",\n        }\n    )\n\n    df[\"physician_endoscopic_severity\"] = df[\"physician_endoscopic_severity\"].map(\n        {\n            \"1\": \"normal\",\n            \"2\": \"mild\",\n            \"3\": \"moderate\",\n            \"4\": \"severe\",\n        }\n    )\n\n    df.replace(\"\", np.nan, inplace=True)  # Finds blanks and replace with NaN\n    df.dropna(\n        axis=1, how=\"all\", inplace=True\n    )  # Drop all columns where every value is empty\n    df[\"study_id\"] = df[\"study_id\"].apply(lambda x: f\"MINI-{x}\")\n\n    rows, columns = df.shape\n    context.add_output_metadata(\n        {\n            \"dagster/row_count\": rows,\n            \"column_count\": columns,\n            \"columns\": df.columns.to_list(),\n            \"preview\": MetadataValue.md(df.head(3).to_markdown()),\n        }\n    )\n\n    return df\n</code></pre>"},{"location":"pipeline/music/","title":"MUSIC","text":"assets/music.py<pre><code>import numpy as np\nimport pandas as pd\nimport requests\nfrom dagster import (\n    AssetExecutionContext,\n    EnvVar,\n    MaterializeResult,\n    MetadataValue,\n    asset,\n)\n\nfrom music_dagster.resources import GTracResource\n\n\n@asset(\n    io_manager_key=\"io_manager\",\n    description=\"Fetches MUSIC data from IGMM RedCap Server, re-engineers baseline drug columns, and drops unused columns\",\n    group_name=\"music\",\n)\ndef music_raw_dataframe(context: AssetExecutionContext) -&gt; pd.DataFrame:\n    MUSIC_API_TOKEN = EnvVar(\"MUSIC_API_TOKEN\").get_value()\n    music_redcap_url = \"https://ecrf.igmm.ed.ac.uk/api/\"\n    redcap_api_data = {\n        \"token\": f\"{MUSIC_API_TOKEN}\",\n        \"content\": \"record\",\n        \"action\": \"export\",\n        \"format\": \"json\",\n        \"type\": \"flat\",\n        \"csvDelimiter\": \"\",\n        \"forms[0]\": \"patient_details\",\n        \"forms[1]\": \"diagnosis\",\n        \"forms[2]\": \"phenotyping\",\n        \"forms[3]\": \"timepoints\",\n        \"forms[4]\": \"patient_reported_activity_cucq32\",\n        \"forms[5]\": \"laboratory_tests_for_disease_activity\",\n        \"forms[6]\": \"endoscopic_disease_activity\",\n        \"forms[7]\": \"surgical_intervention\",\n        \"forms[8]\": \"saliva_sample\",\n        \"forms[9]\": \"cleaned_drug_data\",\n        \"forms[10]\": \"radiologic_disease_activity\",\n        \"rawOrLabel\": \"raw\",\n        \"rawOrLabelHeaders\": \"raw\",\n        \"exportCheckboxLabel\": \"false\",\n        \"exportSurveyFields\": \"false\",\n        \"exportDataAccessGroups\": \"false\",\n        \"returnFormat\": \"json\",\n    }\n    response = requests.post(music_redcap_url, data=redcap_api_data)\n    response.raise_for_status()\n    data = response.json()\n    df = pd.DataFrame.from_records(data)\n\n    df[\"baseline_asa\"] = df.apply(\n        lambda row: 1\n        if \"21\"\n        in [\n            row[\"baseline_current_drug\"],\n            row[\"baseline_current_drug_2\"],\n            row[\"baseline_current_drug_3\"],\n            row[\"baseline_current_drug_4\"],\n            row[\"baseline_current_drug_5\"],\n            row[\"baseline_current_drug_6\"],\n        ]\n        else (\n            1\n            if any(\n                x in [\"4\", \"5\", \"6\"]\n                for x in [\n                    row[\"baseline_current_other1\"],\n                    row[\"baseline_current_other2\"],\n                    row[\"baseline_current_other3\"],\n                    row[\"baseline_current_other4\"],\n                    row[\"baseline_current_other5\"],\n                    row[\"baseline_current_other6\"],\n                ]\n            )\n            else 0\n        ),\n        axis=1,\n    )\n\n    df[\"baseline_mtx\"] = df.apply(\n        lambda row: 1\n        if \"14\"\n        in [\n            row[\"baseline_current_other1\"],\n            row[\"baseline_current_other2\"],\n            row[\"baseline_current_other3\"],\n            row[\"baseline_current_other4\"],\n            row[\"baseline_current_other5\"],\n            row[\"baseline_current_other6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df[\"baseline_ifx\"] = df.apply(\n        lambda row: 1\n        if \"3\"\n        in [\n            row[\"baseline_current_drug\"],\n            row[\"baseline_current_drug_2\"],\n            row[\"baseline_current_drug_3\"],\n            row[\"baseline_current_drug_4\"],\n            row[\"baseline_current_drug_5\"],\n            row[\"baseline_current_drug_6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df[\"baseline_ada\"] = df.apply(\n        lambda row: 1\n        if \"1\"\n        in [\n            row[\"baseline_current_drug\"],\n            row[\"baseline_current_drug_2\"],\n            row[\"baseline_current_drug_3\"],\n            row[\"baseline_current_drug_4\"],\n            row[\"baseline_current_drug_5\"],\n            row[\"baseline_current_drug_6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df[\"baseline_aza\"] = df.apply(\n        lambda row: 1\n        if \"2\"\n        in [\n            row[\"baseline_current_drug\"],\n            row[\"baseline_current_drug_2\"],\n            row[\"baseline_current_drug_3\"],\n            row[\"baseline_current_drug_4\"],\n            row[\"baseline_current_drug_5\"],\n            row[\"baseline_current_drug_6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df[\"baseline_mp\"] = df.apply(\n        lambda row: 1\n        if \"16\"\n        in [\n            row[\"baseline_current_drug\"],\n            row[\"baseline_current_drug_2\"],\n            row[\"baseline_current_drug_3\"],\n            row[\"baseline_current_drug_4\"],\n            row[\"baseline_current_drug_5\"],\n            row[\"baseline_current_drug_6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df[\"baseline_uste\"] = df.apply(\n        lambda row: 1\n        if \"11\"\n        in [\n            row[\"baseline_current_drug\"],\n            row[\"baseline_current_drug_2\"],\n            row[\"baseline_current_drug_3\"],\n            row[\"baseline_current_drug_4\"],\n            row[\"baseline_current_drug_5\"],\n            row[\"baseline_current_drug_6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df[\"baseline_vedo\"] = df.apply(\n        lambda row: 1\n        if \"12\"\n        in [\n            row[\"baseline_current_drug\"],\n            row[\"baseline_current_drug_2\"],\n            row[\"baseline_current_drug_3\"],\n            row[\"baseline_current_drug_4\"],\n            row[\"baseline_current_drug_5\"],\n            row[\"baseline_current_drug_6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df[\"baseline_goli\"] = df.apply(\n        lambda row: 1\n        if \"15\"\n        in [\n            row[\"baseline_current_drug\"],\n            row[\"baseline_current_drug_2\"],\n            row[\"baseline_current_drug_3\"],\n            row[\"baseline_current_drug_4\"],\n            row[\"baseline_current_drug_5\"],\n            row[\"baseline_current_drug_6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df[\"baseline_tofa\"] = df.apply(\n        lambda row: 1\n        if \"10\"\n        in [\n            row[\"baseline_current_drug\"],\n            row[\"baseline_current_drug_2\"],\n            row[\"baseline_current_drug_3\"],\n            row[\"baseline_current_drug_4\"],\n            row[\"baseline_current_drug_5\"],\n            row[\"baseline_current_drug_6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df[\"baseline_filgo\"] = df.apply(\n        lambda row: 1\n        if \"Filgotinib\"\n        in [\n            row[\"baseline_current_otherx1\"],\n            row[\"baseline_current_otherx2\"],\n            row[\"baseline_current_otherx3\"],\n            row[\"baseline_current_otherx4\"],\n            row[\"baseline_current_otherx5\"],\n            row[\"baseline_current_otherx6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df[\"baseline_risa\"] = df.apply(\n        lambda row: 1\n        if \"Risankisumab\"\n        in [\n            row[\"baseline_current_otherx1\"],\n            row[\"baseline_current_otherx2\"],\n            row[\"baseline_current_otherx3\"],\n            row[\"baseline_current_otherx4\"],\n            row[\"baseline_current_otherx5\"],\n            row[\"baseline_current_otherx6\"],\n        ]\n        else 0,\n        axis=1,\n    )\n\n    df.drop(\n        columns=[\n            \"study_group\",\n            \"pt_recorded_patient_id\",\n            \"consent_person_initial\",\n            \"date_data_entry\",\n            \"date_enrolledconsent\",\n            \"consent_person_initial\",\n            \"baseline_recruitment_type\",\n            \"consent_per_initial_other\",\n            \"consent_form_version\",\n            \"pis_version\",\n            \"chi_no\",\n            \"initial\",\n            \"dob\",\n            \"patemail\",\n            \"pat_tel_no\",\n            \"patdetailscomments\",\n            \"consent_yn\",\n            \"fv_yn\",\n            \"gp_yn\",\n            \"patient_details_complete\",\n            \"diagnosis_complete\",\n            \"patientdetailsage_2\",\n            \"patient_reported_activity_cucq32_complete\",\n            \"hbicomplications____1000\",\n            \"sccaicomplications____1000\",\n            \"timepoints_complete\",\n            \"unplanned_hospital_reason2____1000\",\n            \"unplanned_hospital_reason1____1000\",\n            \"flare_up_manaegment2____1000\",\n            \"flare_up_manaegment1____1000\",\n            \"laboratory_tests_for_disease_activity_complete\",\n            \"other_drug_level_assessed\",\n            \"otherdruglevel\",\n            \"drug_level_antibody_other\",\n            \"unit_bilirubin\",\n            \"unit_potassium\",\n            \"unit_sodium\",\n            \"unit_creatinine\",\n            \"unit_urea\",\n            \"unit_egfr\",\n            \"unit_plt\",\n            \"unit_basophils\",\n            \"unit_eosinophils\",\n            \"unit_monocytes\",\n            \"unit_lymphocytes\",\n            \"unit_neutrophils\",\n            \"unit_wcc\",\n            \"unit_haematocrit\",\n            \"unit_rcc\",\n            \"unit_hb\",\n            \"unit_qfit\",\n            \"cleaned_drug_data_complete\",\n            \"surgical_intervention_complete\",\n            \"endoscopic_disease_activity_complete\",\n            \"other_endoscopy_type____1000\",\n            \"endoscopy_type____1000\",\n            \"phenotyping_complete\",\n            \"baseline_radiology_type_o____1000\",\n            \"baseline_radiology_type____1000\",\n            \"baseline_radiology_type_o___10\",\n            \"other_endoscopy_type_2____1000\",\n            \"endoscopy_type_2____1000\",\n            \"baseline_eims_subother____1000\",\n            \"baseline_eims____1000\",\n            \"montrl_uct_sever_montrl\",\n            \"visit1\",\n            \"sescd_tot\",  # this is the sescd score for the endoscopy done in previous 12 months prior to recruitment. Only 3 patients have it recorded.\n            \"baseline_eims___99\",\n            \"baseline_endoscopy\",\n            \"baseline_radiology\",\n            \"baseline_histologyresult\",\n            \"baseline_ibd_date_1\",\n            \"baseline_record_date_8\",\n            \"baseline_ibd_drug_entry\",\n            \"baseline_current_drug\",\n            \"baseline_current_other1\",\n            \"baseline_current_ibd_dose1\",\n            \"bl_current_frequency_use1\",\n            \"bl_prev_frequency_other1\",\n            \"baseline_start_date_ibd1\",\n            \"baseline_end_date1\",\n            \"baseline_drug_stop1\",\n            \"baseline_other_reason1\",\n            \"baseline_current_drug_2\",\n            \"baseline_current_other2\",\n            \"baseline_current_ibd_dose2\",\n            \"bl_current_frequency_use2\",\n            \"bl_prev_frequency_other2\",\n            \"baseline_start_date_ibd2\",\n            \"baseline_end_date2\",\n            \"baseline_drug_stop2\",\n            \"baseline_other_reason2\",\n            \"baseline_current_drug_3\",\n            \"baseline_current_other3\",\n            \"baseline_current_ibd_dose3\",\n            \"bl_current_frequency_use3\",\n            \"bl_prev_frequency_other3\",\n            \"baseline_start_date_ibd3\",\n            \"baseline_end_date3\",\n            \"baseline_drug_stop3\",\n            \"baseline_other_reason3\",\n            \"baseline_current_drug_4\",\n            \"baseline_current_other4\",\n            \"baseline_current_ibd_dose4\",\n            \"bl_current_frequency_use4\",\n            \"bl_prev_frequency_other4\",\n            \"baseline_start_date_ibd4\",\n            \"baseline_end_date4\",\n            \"baseline_drug_stop4\",\n            \"baseline_other_reason4\",\n            \"baseline_current_drug_5\",\n            \"baseline_current_other5\",\n            \"baseline_current_ibd_dose5\",\n            \"bl_current_frequency_use5\",\n            \"bl_prev_frequency_other5\",\n            \"baseline_start_date_ibd5\",\n            \"baseline_end_date5\",\n            \"baseline_drug_stop5\",\n            \"baseline_other_reason5\",\n            \"baseline_current_drug_6\",\n            \"baseline_current_other6\",\n            \"baseline_current_ibd_dose6\",\n            \"bl_current_frequency_use6\",\n            \"bl_prev_frequency_other6\",\n            \"baseline_start_date_ibd6\",\n            \"baseline_end_date6\",\n            \"baseline_drug_stop6\",\n            \"baseline_other_reason6\",\n            \"baseline_current_otherx1\",\n            \"baseline_current_otherx2\",\n            \"baseline_current_otherx3\",\n            \"baseline_current_otherx4\",\n            \"baseline_current_otherx5\",\n            \"baseline_current_otherx6\",\n            \"endoscopy_type_2___1\",\n            \"other_endoscopy_type_2___4\",\n            \"other_endoscopy_type_2___5\",\n            \"other_endoscopy_type_2___6\",\n            \"baseline_radiology_type___11\",\n            \"baseline_radiology_type_o___1\",\n            \"baseline_radiology_type_o___2\",\n            \"baseline_radiology_type_o___4\",\n            \"baseline_radiology_type_o___5\",\n            \"baseline_radiology_type_o___8\",\n            \"baseline_radiology_type_o___9\",\n            \"baseline_radiology_type_o___10\",\n            \"endoscopy_yn\",\n            \"endoscopy_date_2\",\n            \"endoscopy_type___1\",\n            \"other_endoscopy_type___4\",\n            \"other_endoscopy_type___5\",\n            \"other_endoscopy_type___6\",\n            \"uceisvascular_pattern\",\n            \"uceisbleeding\",\n            \"uceiserosions_and_ulcers\",\n            \"ileum_explored_ses\",\n            \"sesileumulcers\",\n            \"sesnarrowings\",\n            \"sessurfacevas\",\n            \"sessurfaceucvas\",\n            \"sescd_ileum_expl_score\",\n            \"ses_right_colon_explored\",\n            \"ses_caecum_ulcers\",\n            \"ses_caecum_narrowings\",\n            \"ses_caecum_vas\",\n            \"ses_caecum_ucvas\",\n            \"ses_caecum_endcos_score\",\n            \"ses_transverse_colon\",\n            \"ses_transverseulcers\",\n            \"ses_transverse_narrowings\",\n            \"ses_transverse_vas\",\n            \"ses_transverse_ucvas\",\n            \"sescd_transve_colon_score\",\n            \"ses_left_colon_and_sigma\",\n            \"ses_left_colon_sigma_uc\",\n            \"ses_narrpowings_left_colon\",\n            \"ses_narrowng_leftcolonvas\",\n            \"ses_narrow_leftcolonucvas\",\n            \"sescd_left_colon_score\",\n            \"ses_rectum_explored\",\n            \"ses_rectum_explored_ulcers\",\n            \"ses_rectum_narrowing\",\n            \"ses_rectum_vas\",\n            \"ses_rectum_ucvas\",\n            \"sescd_rectum_score\",\n            \"adalimumab_test\",\n            \"infliximab_test\",\n            \"laboratory_rev_date\",\n            \"blood_test_type\",\n            \"faecal_testyn\",\n            \"qfit_testyn\",\n            \"eims_psc\",\n            \"mh_any\",\n            \"mh_num\",\n            \"mh_1bsc\",\n            \"mh_term_other1\",\n            \"mh_2bsc\",\n            \"mh_term_other2\",\n            \"mh_3bsc\",\n            \"mh_term_other3\",\n            \"mh_4bsc\",\n            \"mh_term_other4\",\n            \"mh_5bsc\",\n            \"mh_term_other5\",\n            \"mh_6bsc\",\n            \"mh_term_other6\",\n            \"mh_7bsc\",\n            \"mh_term_other7\",\n            \"radiology_invest_rev_date\",\n            \"radiology\",\n            \"radiology_comments\",\n            \"radiologic_disease_activity_complete\",\n            \"surgical_invest_rev_date\",\n            \"non_ibd_surgery\",\n        ],\n        inplace=True,\n    )\n\n    df.replace(\"\", np.nan, inplace=True)  # Finds blanks and replace with NaN\n    df.dropna(\n        axis=1, how=\"all\", inplace=True\n    )  # Drop all columns where every value is empty\n    rows, columns = df.shape\n    context.add_output_metadata(\n        {\n            \"dagster/row_count\": rows,\n            \"column_count\": columns,\n        }\n    )\n    return df\n\n\n@asset(description=\"Stage 1 Cleaning - Reshape dataframe.\", group_name=\"music\")\ndef music_reshaped_dataframe(\n    context: AssetExecutionContext, music_raw_dataframe: pd.DataFrame\n) -&gt; pd.DataFrame:\n    df = music_raw_dataframe\n\n    # Split the initial df into 3 components; 1 with lab tests, 1 with saliva samples and 1 with the rest\n    intermediate_df = df[df[\"redcap_repeat_instrument\"].isnull()].copy()\n    lab_sampling_df = df[\n        df[\"redcap_repeat_instrument\"] == \"laboratory_tests_for_disease_activity\"\n    ].copy()\n    saliva_sampling_df = df[df[\"saliva_rev_date\"].notnull()].copy()\n    # we have to do this because some have redcap_repeat_instrument\n    # but others don't have the repeat thing tagged onto the data.\n\n    intermediate_df.dropna(axis=1, how=\"all\", inplace=True)\n    lab_sampling_df.dropna(axis=1, how=\"all\", inplace=True)\n    saliva_sampling_df.dropna(axis=1, how=\"all\", inplace=True)\n\n    # Remove the repeating instances. They don't add value.\n    lab_sampling_df = lab_sampling_df[\n        lab_sampling_df[\"redcap_repeat_instance\"] == 1\n    ]  # we lose only 1 row belonging to 92-1\n    saliva_sampling_df = saliva_sampling_df[\n        saliva_sampling_df[\"redcap_repeat_instance\"] != 2\n    ]  # we lose only 2 rows belonging to 90-55 and 90-92\n\n    # Deduplicating columns\n    lab_sampling_df.drop(\n        columns=[\n            \"baseline_asa\",\n            \"baseline_aza\",\n            \"baseline_mp\",\n            \"baseline_uste\",\n            \"baseline_vedo\",\n            \"baseline_goli\",\n            \"baseline_tofa\",\n            \"baseline_filgo\",\n            \"baseline_risa\",\n            \"baseline_mtx\",\n            \"baseline_ifx\",\n            \"baseline_ada\",\n            \"redcap_repeat_instance\",\n            \"redcap_repeat_instrument\",\n        ],\n        inplace=True,\n    )\n\n    saliva_columns = [\n        \"study_id\",\n        \"redcap_event_name\",\n        \"saliva_rev_date\",\n        \"saliva_sample\",\n        \"saliva_setting\",\n        \"sample_date\",\n        \"saliva_eim\",\n        \"eims_details\",\n        \"saliva_abx\",\n        \"abx_detail\",\n        \"saliva_abx3m\",\n        \"abx3m_detail\",\n        \"saliva_piercing\",\n        \"saliva_brushing\",\n        \"saliva_brush_tongue\",\n        \"saliva_dietibd\",\n        \"diet_details\",\n        \"saliva_cs\",\n        \"saliva_denture\",\n        \"dentures_details\",\n        \"comments_saliva\",\n    ]\n\n    saliva_sampling_df = saliva_sampling_df[saliva_columns]\n\n    # First merger of lab_sampling_df into the main df\n    df = pd.merge(\n        intermediate_df,\n        lab_sampling_df,\n        how=\"left\",\n        on=[\"study_id\", \"redcap_event_name\"],\n    )\n\n    saliva_columns_to_remove = [\n        \"saliva_rev_date\",\n        \"saliva_sample\",\n        \"saliva_setting\",\n        \"sample_date\",\n        \"saliva_eim\",\n        \"eims_details\",\n        \"saliva_abx\",\n        \"abx_detail\",\n        \"saliva_abx3m\",\n        \"abx3m_detail\",\n        \"saliva_piercing\",\n        \"saliva_brushing\",\n        \"saliva_brush_tongue\",\n        \"saliva_dietibd\",\n        \"diet_details\",\n        \"saliva_cs\",\n        \"saliva_denture\",\n        \"dentures_details\",\n        \"comments_saliva\",\n    ]\n\n    df.drop(columns=saliva_columns_to_remove, inplace=True)\n\n    # Second stage merger of saliva sampling df into the main df\n    df = pd.merge(\n        df, saliva_sampling_df, how=\"left\", on=[\"study_id\", \"redcap_event_name\"]\n    )\n\n    # Take out withdrawn participants at point of withdrawal.\n    df = df[df[\"withdrawn\"] != \"0\"]  # surprisingly withdrawn is coded as 0 for yes\n    df.drop(columns=[\"withdrawn\"], inplace=True)\n\n    rows, columns = df.shape\n    context.add_output_metadata(\n        {\n            \"dagster/row_count\": rows,\n            \"column_count\": columns,\n        }\n    )\n\n    return df\n\n\n@asset(\n    description=\"Stage 2 Cleaning - Fixing all column and cell values\",\n    group_name=\"music\",\n)\ndef music_cleaned_dataframe(\n    context: AssetExecutionContext, music_reshaped_dataframe: pd.DataFrame\n) -&gt; pd.DataFrame:\n    df = music_reshaped_dataframe\n\n    df.rename(\n        columns={\n            \"montrlcdlocation_montrl\": \"montreal_cd_location\",\n            \"montrlcdbehav_montrl\": \"montreal_cd_behaviour\",\n            \"montrlucextent_montrl\": \"montreal_uc_extent\",\n            \"montrl_uc_server\": \"montreal_uc_severity\",\n            \"patientdetailsage\": \"age\",\n            \"smokeryn\": \"smoking_status\",\n            \"smokingex\": \"when_smoking_stopped\",\n            \"ex_unit\": \"when_smoking_stopped_units\",\n            \"patient_diagnose_age\": \"age_at_diagnosis\",\n            \"bmi_height\": \"height\",\n            \"bmi_weight\": \"weight\",\n            \"patient_active_symptomyn\": \"has_active_symptoms\",\n            \"clinician_perform_stat\": \"physician_global_assessment\",\n            \"total_cucq32_scored\": \"cucq_total\",\n            \"mayo_total_score\": \"mayo_total\",\n            \"sccai_total_calculation\": \"sccai_total\",\n            \"hbi_total_calculation\": \"hbi_total\",\n            \"diagcartecomment\": \"diagnosis_comments\",\n            \"haematocrit_lab\": \"haematocrit\",\n            \"neutrophils_lab\": \"neutrophils\",\n            \"lymphocytes_lab\": \"lymphocytes\",\n            \"monocytes_lab\": \"monocytes\",\n            \"eosinophils_lab\": \"eosinophils\",\n            \"basophils_lab\": \"basophils\",\n            \"plt_lab\": \"platelets\",\n            \"bilirubin_lab\": \"bilirubin\",\n            \"urea_lab\": \"urea\",\n            \"creatinine_lab\": \"creatinine\",\n            \"sodium_lab\": \"sodium\",\n            \"potassium_lab\": \"potassium\",\n            \"egfr_lab\": \"egfr\",\n            \"cucq32q1\": \"cucq_1\",\n            \"cucq32q2\": \"cucq_2\",\n            \"cucq32q3\": \"cucq_3\",\n            \"cucq32q4\": \"cucq_4\",\n            \"cucq32q5\": \"cucq_5\",\n            \"cucq32q6\": \"cucq_6\",\n            \"cucq32q36\": \"cucq_7\",\n            \"cucq32q8\": \"cucq_8\",\n            \"cucq32q9\": \"cucq_9\",\n            \"cucq32q35\": \"cucq_10\",\n            \"cucq32q11\": \"cucq_11\",\n            \"cucq32q12\": \"cucq_12\",\n            \"cucq32q34\": \"cucq_13\",\n            \"cucq32q37\": \"cucq_14\",\n            \"cucq32q47\": \"cucq_15\",\n            \"cucq32q16\": \"cucq_16\",\n            \"cucq32q17\": \"cucq_17\",\n            \"cucq32q18\": \"cucq_18\",\n            \"cucq32q48\": \"cucq_19\",\n            \"cucq32q20\": \"cucq_20\",\n            \"cucq32q44\": \"cucq_21\",\n            \"cucq32q22\": \"cucq_22\",\n            \"cucq32q41\": \"cucq_23\",\n            \"cucq32q38\": \"cucq_24\",\n            \"cucq32q25\": \"cucq_25\",\n            \"cucq32q39\": \"cucq_26\",\n            \"cucq32q33\": \"cucq_27\",\n            \"cucq32q42\": \"cucq_28\",\n            \"cucq32q40\": \"cucq_29\",\n            \"cucq32q43\": \"cucq_30\",\n            \"cucq32q45\": \"cucq_31\",\n            \"cucq32q46\": \"cucq_32\",\n            \"cucq32_rev_date\": \"cucq_date\",\n            \"comment_if_any_of_these_qu\": \"proms_comments\",\n            \"sccaicomplications___0\": \"sccai_no_complications\",\n            \"sccaicomplications___1\": \"sccai_arthralgia\",\n            \"sccaicomplications___2\": \"sccai_uveitis\",\n            \"sccaicomplications___3\": \"sccai_erythema_nodosum\",\n            \"sccaicomplications___4\": \"sccai_pyoderma\",\n            \"sccai_bowel_freqday\": \"sccai_bowel_frequency_day\",\n            \"sccai_bowel_frequency_nigh\": \"sccai_bowel_frequency_night\",\n            \"sccai_urgency_of_defecatio\": \"sccai_urgency\",\n            \"hbicomplications___0\": \"hbi_no_complications\",\n            \"hbicomplications___1\": \"hbi_arthralgia\",\n            \"hbicomplications___2\": \"hbi_uveitis\",\n            \"hbicomplications___3\": \"hbi_erythema_nodosum\",\n            \"hbicomplications___4\": \"hbi_apthous_ulcers\",\n            \"hbicomplications___5\": \"hbi_pyoderma\",\n            \"hbicomplications___6\": \"hbi_anal_fissures\",\n            \"hbicomplications___7\": \"hbi_new_fistula\",\n            \"hbicomplications___8\": \"hbi_abscess\",\n            \"hbiliquid_stools\": \"hbi_liquid_stools_present\",\n            \"hbinumber_of_liquid_stools\": \"hbi_liquid_stools\",\n            \"hbiabdominal_mass1\": \"hbi_abdominal_mass\",\n            \"hbigeneral_well_being_as\": \"hbi_general_well_being\",\n            \"hbiabdominal_pain\": \"hbi_abdominal_pain\",\n            \"activityassesscomments\": \"disease_activity_score_comments\",\n            \"da_rev_date\": \"disease_activity_score_date\",\n            \"mayo_physician_global_asse\": \"mayo_physician_global_assessment\",\n            \"visit_review_date\": \"visit_date\",\n            \"baseline_symptoms_desc2\": \"symptoms_description\",\n            \"patdetailscomments_as_lbt\": \"lab_tests_comments\",\n            \"blood_test_date_red\": \"nhs_bloods_date\",\n            \"endoscopy_result_endcospy\": \"endoscopy_report\",\n            \"histopathology_report_text\": \"pathology_report\",\n            \"flare_up_timeframe1\": \"flare_up_1_date\",\n            \"flare_up_description1\": \"flare_up_1_description\",\n            \"flare_up_manaegment1___1\": \"flare_up_1_management_community\",\n            \"flare_up_manaegment1___2\": \"flare_up_1_management_inpatient\",\n            \"flare_up_manaegment1___3\": \"flare_up_1_management_oral_steroids\",\n            \"flare_up_manaegment1___4\": \"flare_up_1_management_asa\",\n            \"flare_up_manaegment1___5\": \"flare_up_1_management_dietetics\",\n            \"flare_up_manaegment1___99\": \"flare_up_1_management_other\",\n            \"flare_up_managmnt_other1\": \"flare_up_1_management_other_text\",\n            \"flare_up_timeframe2\": \"flare_up_2_date\",\n            \"flare_up_description2\": \"flare_up_2_description\",\n            \"flare_up_manaegment2___1\": \"flare_up_2_management_community\",\n            \"flare_up_manaegment2___2\": \"flare_up_2_management_inpatient\",\n            \"flare_up_manaegment2___3\": \"flare_up_2_management_oral_steroids\",\n            \"flare_up_manaegment2___4\": \"flare_up_2_management_asa\",\n            \"flare_up_manaegment2___5\": \"flare_up_2_management_dietetics\",\n            \"flare_up_manaegment2___99\": \"flare_up_2_management_other\",\n            \"flare_up_managmnt_other2\": \"flare_up_2_management_other_text\",\n            \"unplanned_hospital\": \"unplanned_hospital_admission\",\n            \"flare_up_comment\": \"flare_up_comments\",\n            \"reason_of_use_steroid1\": \"steroid_use_1_reason\",\n            \"other_reason_use_steroid1\": \"steroid_use_1_reason_text\",\n            \"dt_seroid_drug_cu1\": \"steroid_use_1_drug\",\n            \"steroid_other_drug_cu1\": \"steroid_use_1_drug_text\",\n            \"steroid_dose1\": \"steroid_use_1_dose\",\n            \"steroid_freq_of_use1\": \"steroid_use_1_frequency\",\n            \"other_steroid_freofuse1\": \"steroid_use_1_frequency_text\",\n            \"steroid_sd1\": \"steroid_use_1_start_date\",\n            \"still_taken_steroid1\": \"steroid_use_1_still_taking\",\n            \"steroid_ed1\": \"steroid_use_1_end_date\",\n            \"stop_steroid_res1\": \"steroid_use_1_reason_stopped\",\n            # \"steroid_change_dose1\": \"steroid_use_1_reason_changed\",\n            \"other_stop_steroid_res1\": \"steroid_use_1_reason_changed_text\",\n            \"reason_of_use_steroid2\": \"steroid_use_2_reason\",\n            \"other_reason_use_steroid2\": \"steroid_use_2_reason_text\",\n            \"dt_seroid_drug_cu2\": \"steroid_use_2_drug\",\n            \"steroid_other_drug_cu2\": \"steroid_use_2_drug_text\",\n            \"steroid_dose2\": \"steroid_use_2_dose\",\n            \"steroid_freq_of_use2\": \"steroid_use_2_frequency\",\n            \"other_steroid_freofuse2\": \"steroid_use_2_frequency_text\",\n            \"steroid_sd2\": \"steroid_use_2_start_date\",\n            \"still_taken_steroid2\": \"steroid_use_2_still_taking\",\n            \"steroid_ed2\": \"steroid_use_2_end_date\",\n            \"stop_steroid_res2\": \"steroid_use_2_reason_stopped\",\n            # \"steroid_change_dose2\": \"steroid_use_2_reason_changed\",\n            \"other_stop_steroid_res2\": \"steroid_use_2_reason_changed_text\",\n            \"unplanned_hospital_reason1___1\": \"hospital_admission_1_for_acute_severe_colitis\",\n            \"unplanned_hospital_reason1___2\": \"hospital_admission_1_for_ibd_flare_not_asc\",\n            \"unplanned_hospital_reason1___3\": \"hospital_admission_1_for_perianal_disease\",\n            \"unplanned_hospital_reason1___4\": \"hospital_admission_1_for_surgery\",\n            \"unplanned_hospital_reason1___5\": \"hospital_admission_1_for_investigation_not_meeting_other_criteria\",\n            \"unplanned_hospital_reason1___99\": \"hospital_admission_1_for_other\",\n            \"unplan_adm_hosp_other1\": \"hospital_admission_1_for_other_text\",\n            \"unplaned_hos_adm_date1\": \"hospital_admission_1_admission_date\",\n            \"hospital_discharge_date1\": \"hospital_admission_1_discharge_date\",\n            \"unplanned_hospital_reason2___1\": \"hospital_admission_2_for_acute_severe_colitis\",\n            \"unplanned_hospital_reason2___2\": \"hospital_admission_2_for_ibd_flare_not_asc\",\n            \"unplanned_hospital_reason2___3\": \"hospital_admission_2_for_perianal_disease\",\n            \"unplanned_hospital_reason2___4\": \"hospital_admission_2_for_surgery\",\n            \"unplanned_hospital_reason2___5\": \"hospital_admission_2_for_investigation_not_meeting_other_criteria\",\n            \"unplanned_hospital_reason2___99\": \"hospital_admission_2_for_other\",\n            \"unplan_adm_hosp_other2\": \"hospital_admission_2_for_other_text\",\n            \"unplaned_hos_adm_date2\": \"hospital_admission_2_admission_date\",\n            \"hospital_discharge_date2\": \"hospital_admission_2_discharge_date\",\n            \"unplanned_hospital_comment\": \"hospital_admission_comments\",\n            \"dt_current_ibd_steroid\": \"new_oral_steroids_since_last_visit\",\n            \"montreal_rev_date\": \"montreal_classification_date\",\n            \"montrealcomments\": \"montreal_classification_comments\",\n            \"baseline_drug_check\": \"baseline_previous_ibd_treatment\",\n            \"baseline_eims___2\": \"baseline_eims_arthralgia\",\n            \"baseline_eims___3\": \"baseline_eims_ank_spon\",\n            \"baseline_eims___5\": \"baseline_eims_erythema_nodosum\",\n            \"baseline_eims___6\": \"baseline_eims_pyoderma\",\n            \"baseline_eims___10\": \"baseline_eims_uveitis\",\n            \"baseline_eims___12\": \"baseline_eims_episcleritis\",\n            \"baseline_eims___15\": \"baseline_eims_none\",\n            \"baseline_eims_subother___99\": \"baseline_eims_other\",\n            \"baseline_eims_subother___1\": \"baseline_eims_iritis_scleritis\",\n            \"baseline_eims_subother___8\": \"baseline_eims_sacroileitis\",\n            \"baseline_eims_subother___11\": \"baseline_eims_conjunctivitis\",\n            \"baseline_eims_subother___14\": \"baseline_eims_angular_cheilitis\",\n            \"baseline_eims_other\": \"baseline_eims_other_text\",\n            \"baseline_record_date_5\": \"endoscopy_prior_to_recruitment_date\",\n            \"endoscopy_type_2___2\": \"endoscopy_prior_to_recruitment_colonoscopy\",\n            \"endoscopy_type_2___3\": \"endoscopy_prior_to_recruitment_flexible_sigmoidoscopy\",\n            \"endoscopy_result2\": \"endoscopy_prior_to_recruitment_report\",\n            \"mayo_total_score_2\": \"endoscopy_prior_to_recruitment_mayo_score\",\n            \"uceis_total_score_2\": \"endoscopy_prior_to_recruitment_uceis_score\",\n            \"baseline_record_date_6\": \"radiology_prior_to_recruitment_date\",\n            \"baseline_radiology_type___3\": \"radiology_prior_to_recruitment_ctap\",\n            \"baseline_radiology_type___6\": \"radiology_prior_to_recruitment_mri_sb\",\n            \"baseline_radiology_type___7\": \"radiology_prior_to_recruitment_mri_pelvis\",\n            \"baseline_radiology_res_dsc\": \"radiology_prior_to_recruitment_report\",\n            \"baseline_record_date_7\": \"histology_prior_to_recruitment_date\",\n            \"baseline_histology_res_dsc\": \"histology_prior_to_recruitment_report\",\n            \"uceis_total_score\": \"uceis_calc\",\n            \"cdeis_total_score\": \"sescd_calc\",\n            \"est_severity\": \"physician_endoscopic_severity\",\n            \"sh_num\": \"surgical_history_number\",\n            \"surgery_date_ibd_sh\": \"surgical_history_1_date\",\n            \"ibd_proc_type_sh\": \"surgical_history_1_procedure_main\",\n            \"ibd_others_proc_type_sh\": \"surgical_history_1_procedure_other\",\n            \"other_surgery_hist_ibd\": \"surgical_history_1_procedure_other_text\",\n            \"baseline_sh_ibd_report\": \"surgical_history_1_report\",\n            \"surgery_date_ibd_sh_2\": \"surgical_history_2_date\",\n            \"ibd_proc_type_sh_2\": \"surgical_history_2_procedure_main\",\n            \"ibd_others_proc_type_sh_2\": \"surgical_history_2_procedure_other\",\n            \"other_surgery_hist_ibd_2\": \"surgical_history_2_procedure_other_text\",\n            \"baseline_sh_ibd_report_2\": \"surgical_history_2_report\",\n            \"surgery_date_ibd_sh_3\": \"surgical_history_3_date\",\n            \"ibd_proc_type_sh_3\": \"surgical_history_3_procedure_main\",\n            \"ibd_others_proc_type_sh_3\": \"surgical_history_3_procedure_other\",\n            \"other_surgery_hist_ibd_3\": \"surgical_history_3_procedure_other_text\",\n            \"baseline_sh_ibd_report_3\": \"surgical_history_3_report\",\n            \"drug_level_inflxi\": \"ifx_level\",\n            \"drug_level_adalimumab\": \"ada_level\",\n            \"drug_level_antibody_adali\": \"ada_antibody\",\n            \"drug_level_antibody_inflx\": \"ifx_antibody\",\n            \"date_test_adali_inflixi\": \"drug_level_date\",\n            \"faecal_test_date_2\": \"calprotectin_date\",\n            \"histologycomments_si_sh\": \"phenotyping_comments\",\n            \"mh_appendx1\": \"previous_appendicectomy\",\n            \"mh_tonsilout1\": \"previous_tonsillectomy\",\n            \"mh_appendix_date1\": \"appendicectomy_age\",\n            \"mh_tonsil_date1\": \"tonsillectomy_age\",\n            \"mh_1sd\": \"pmh_1_start_date\",\n            \"mh_1ed\": \"pmh_1_end_date\",\n            \"mh_diagnosis_1\": \"pmh_1_diagnosis\",\n            \"mh_2sd\": \"pmh_2_start_date\",\n            \"mh_2ed\": \"pmh_2_end_date\",\n            \"mh_diagnosis_2\": \"pmh_2_diagnosis\",\n            \"mh_3sd\": \"pmh_3_start_date\",\n            \"mh_3ed\": \"pmh_3_end_date\",\n            \"mh_diagnosis_3\": \"pmh_3_diagnosis\",\n            \"mh_4sd\": \"pmh_4_start_date\",\n            \"mh_4ed\": \"pmh_4_end_date\",\n            \"mh_diagnosis_4\": \"pmh_4_diagnosis\",\n            \"mh_5sd\": \"pmh_5_start_date\",\n            \"mh_5ed\": \"pmh_5_end_date\",\n            \"mh_diagnosis_5\": \"pmh_5_diagnosis\",\n            \"mh_6sd\": \"pmh_6_start_date\",\n            \"mh_6ed\": \"pmh_6_end_date\",\n            \"mh_diagnosis_6\": \"pmh_6_diagnosis\",\n            \"mh_7sd\": \"pmh_7_start_date\",\n            \"mh_7ed\": \"pmh_7_end_date\",\n            \"mh_diagnosis_7\": \"pmh_7_diagnosis\",\n            \"mh_comments\": \"pmh_comments\",\n            \"endoscopy_type___2\": \"endoscopy_type_colonoscopy\",\n            \"endoscopy_type___3\": \"endoscopy_type_flexible_sigmoidoscopy\",\n            \"fh_number_bs\": \"fh_number_siblings\",\n            \"fh_number_kids_daughter\": \"fh_number_daughters\",\n            \"fh_number_kids_son\": \"fh_number_sons\",\n            \"fh_number_kids\": \"fh_number_children\",\n            \"family_history_pfh\": \"fh_of_ibd_present\",\n            \"fhnumber_pfh\": \"fh_of_ibd_number_affected\",\n            \"relationship_pfh\": \"fh_1_relationship\",\n            \"age_at_diagnosis\": \"fh_1_age_at_diagnosis\",\n            \"fhdiagnosis_pfh_1\": \"fh_1_diagnosis\",\n            \"fhdiagnosis_pfh_other1\": \"fh_1_diagnosis_other\",\n            \"other_fhdiagnosis_oid1\": \"fh_1_diagnosis_other_text\",\n            \"relationship_pfh_2\": \"fh_2_relationship\",\n            \"age_at_diagnosis_2\": \"fh_2_age_at_diagnosis\",\n            \"fhdiagnosis_pfh_2\": \"fh_2_diagnosis\",\n            \"fhdiagnosis_pfh_other2\": \"fh_2_diagnosis_other\",\n            \"other_fhdiagnosis_oid2\": \"fh_2_diagnosis_other_text\",\n            \"relationship_pfh_3\": \"fh_3_relationship\",\n            \"age_at_diagnosis_3\": \"fh_3_age_at_diagnosis\",\n            \"fhdiagnosis_pfh_3\": \"fh_3_diagnosis\",\n            \"fhdiagnosis_pfh_other3\": \"fh_3_diagnosis_other\",\n            \"other_fhdiagnosis_oid3\": \"fh_3_diagnosis_other_text\",\n            \"relationship_pfh_4\": \"fh_4_relationship\",\n            \"age_at_diagnosis_4\": \"fh_4_age_at_diagnosis\",\n            \"fhdiagnosis_pfh_4\": \"fh_4_diagnosis\",\n            \"fhdiagnosis_pfh_other4\": \"fh_4_diagnosis_other\",\n            \"other_fhdiagnosis_oid4\": \"fh_4_diagnosis_other_text\",\n            \"relationship_pfh_5\": \"fh_5_relationship\",\n            \"age_at_diagnosis_5\": \"fh_5_age_at_diagnosis\",\n            \"fhdiagnosis_pfh_5\": \"fh_5_diagnosis\",\n            \"fhdiagnosis_pfh_other5\": \"fh_5_diagnosis_other\",\n            \"other_fhdiagnosis_oid5\": \"fh_5_diagnosis_other_text\",\n            \"patdetailscomments_pfh\": \"fh_comments\",\n            \"ct_abdomen_and_or_pelvis\": \"ct_abdomen_pelvis\",\n            \"abdominal_uss\": \"uss_abdomen\",\n            \"abdominal_x_ray\": \"axr\",\n            \"radilogy_r_ctabdo_pelvic\": \"ct_abdomen_pelvis_report\",\n            \"radiology_r_abdo_x_ray\": \"axr_report\",\n            \"radiology_r_abdo_uss\": \"uss_abdomen_report\",\n            \"radiology_r_mri_sml_bowel\": \"mri_small_bowel_report\",\n            \"radiology_r_mri_pelvis\": \"mri_pelvis_report\",\n            \"radiologyfindingcomments\": \"radiology_report_summary\",\n            \"ibd_surgery_si\": \"ibd_surgery_performed\",\n            \"surgery_date_si\": \"ibd_surgery_date\",\n            \"ibd_procedure_type\": \"ibd_surgery_procedure\",\n            \"ibd_procedure_type_other\": \"ibd_surgery_procedure_other\",\n            \"ibd_other_specify_proc\": \"ibd_surgery_procedure_other_text\",\n            \"ibd_procedure_result\": \"ibd_surgery_comments\",\n            \"histologycomments_si\": \"ibd_surgery_histology_report\",\n        },\n        inplace=True,\n    )\n\n    df[\"fh_of_ibd_present\"] = df[\"fh_of_ibd_present\"].map(\n        {\"1\": \"yes\", \"2\": \"no\", \"3\": \"unclear\"}\n    )\n\n    fh_diagnosis_map = {\n        \"6\": \"cd\",\n        \"7\": \"uc\",\n        \"9\": \"ibdu\",\n        \"10\": \"possible_cd\",\n        \"11\": \"possible_uc\",\n        \"12\": \"possible_ibd\",\n        \"99\": \"other\",\n    }\n\n    fh_diagnosis_other_map = {\n        \"1\": \"multiple_sclerosis\",\n        \"2\": \"psoriasis\",\n        \"3\": \"coeliac_disease\",\n        \"4\": \"ankylosing_spondylitis\",\n        \"5\": \"colorectal_cancer\",\n        \"8\": \"ibs\",\n        \"13\": \"any_cancer\",\n        \"99\": \"other\",\n    }\n\n    fh_relationship_map = {\n        \"1\": \"parent\",\n        \"27\": \"mother\",\n        \"28\": \"father\",\n        \"2\": \"sibling\",\n        \"3\": \"sister\",\n        \"4\": \"brother\",\n        \"5\": \"cousin\",\n        \"6\": \"uncle\",\n        \"7\": \"aunt\",\n        \"8\": \"uncle_maternal\",\n        \"9\": \"aunt_maternal\",\n        \"10\": \"uncle_paternal\",\n        \"11\": \"aunt_paternal\",\n        \"29\": \"grandparent\",\n        \"12\": \"grandmother_paternal\",\n        \"24\": \"grandmother_maternal\",\n        \"25\": \"grandfather_paternal\",\n        \"26\": \"grandfather_maternal\",\n        \"30\": \"granduncle_paternal\",\n        \"31\": \"granduncle_maternal\",\n        \"13\": \"half_brother\",\n        \"14\": \"half_sister\",\n        \"15\": \"nephew\",\n        \"16\": \"niece\",\n        \"17\": \"grandson\",\n        \"18\": \"granddaughter\",\n        \"19\": \"other_2nd_degree\",\n        \"20\": \"other_3rd_degree\",\n        \"21\": \"other_4th_degree\",\n        \"22\": \"dizygotic_twin\",\n        \"23\": \"monozygotic_twin\",\n    }\n\n    df[\"fh_1_diagnosis\"] = df[\"fh_1_diagnosis\"].map(fh_diagnosis_map)\n    df[\"fh_2_diagnosis\"] = df[\"fh_2_diagnosis\"].map(fh_diagnosis_map)\n    df[\"fh_3_diagnosis\"] = df[\"fh_3_diagnosis\"].map(fh_diagnosis_map)\n    df[\"fh_4_diagnosis\"] = df[\"fh_4_diagnosis\"].map(fh_diagnosis_map)\n\n    # df['fh_1_diagnosis_other'] = df['fh_1_diagnosis_other'].map(fh_diagnosis_other_map)\n    df[\"fh_2_diagnosis_other\"] = df[\"fh_2_diagnosis_other\"].map(fh_diagnosis_other_map)\n    df[\"fh_3_diagnosis_other\"] = df[\"fh_3_diagnosis_other\"].map(fh_diagnosis_other_map)\n    # df['fh_4_diagnosis_other'] = df['fh_4_diagnosis_other'].map(fh_diagnosis_other_map)\n\n    df[\"fh_1_relationship\"] = df[\"fh_1_relationship\"].map(fh_relationship_map)\n    df[\"fh_2_relationship\"] = df[\"fh_2_relationship\"].map(fh_relationship_map)\n    df[\"fh_3_relationship\"] = df[\"fh_3_relationship\"].map(fh_relationship_map)\n    df[\"fh_4_relationship\"] = df[\"fh_4_relationship\"].map(fh_relationship_map)\n\n    surgical_history_procedure_main_map = {\n        \"2\": \"colectomy\",\n        \"7\": \"ibd_resection\",\n        \"8\": \"ileocaecal_resection\",\n        \"23\": \"small_bowel_resection\",\n        \"10\": \"eua_perianal_fistula\",\n    }\n\n    surgical_history_procedure_other_map = {\n        \"1\": \"appendicectomy\",\n        \"3\": \"completion_colectomy\",\n        \"4\": \"completion_proctectomy\",\n        \"5\": \"pouch_excision\",\n        \"6\": \"rectal_stump_excision\",\n        \"9\": \"ileocolic_resection\",\n        \"10\": \"ileotransverse_colectomy\",\n        \"11\": \"left_hemicolectomy\",\n        \"12\": \"segmental_colonic_resection\",\n        \"13\": \"colovaginal_fistula_repair\",\n        \"14\": \"other_segmental_resection\",\n        \"15\": \"panproctocolectomy\",\n        \"16\": \"panproctocolectomy_with_pouch\",\n        \"17\": \"stoma_revision\",\n        \"18\": \"right_hemicolectomy\",\n        \"19\": \"right_hemicolectomy_with_ileal_stricturoplasty\",\n        \"20\": \"right_hemicoloectomy_with_ileal_resection\",\n        \"21\": \"ileocaecal_resection\",\n        \"22\": \"segmental_colonic_resection\",\n        \"24\": \"subtotal_colectomy\",\n    }\n\n    df[\"surgical_history_1_procedure_main\"] = df[\n        \"surgical_history_1_procedure_main\"\n    ].map(surgical_history_procedure_main_map)\n    df[\"surgical_history_1_procedure_other\"] = df[\n        \"surgical_history_1_procedure_other\"\n    ].map(surgical_history_procedure_other_map)\n    df[\"surgical_history_2_procedure_main\"] = df[\n        \"surgical_history_2_procedure_main\"\n    ].map(surgical_history_procedure_main_map)\n    df[\"surgical_history_2_procedure_other\"] = df[\n        \"surgical_history_2_procedure_other\"\n    ].map(surgical_history_procedure_other_map)\n    df[\"surgical_history_3_procedure_main\"] = df[\n        \"surgical_history_3_procedure_main\"\n    ].map(surgical_history_procedure_main_map)\n    df[\"surgical_history_3_procedure_other\"] = df[\n        \"surgical_history_3_procedure_other\"\n    ].map(surgical_history_procedure_other_map)\n\n    df[\"surgical_history_1_procedure\"] = df[\n        [\n            \"surgical_history_1_procedure_main\",\n            \"surgical_history_1_procedure_other\",\n            \"surgical_history_1_procedure_other_text\",\n        ]\n    ].apply(lambda x: \", \".join(x.dropna()), axis=1)\n    df.drop(\n        columns=[\n            \"surgical_history_1_procedure_main\",\n            \"surgical_history_1_procedure_other\",\n            \"surgical_history_1_procedure_other_text\",\n        ],\n        inplace=True,\n    )\n    df[\"surgical_history_2_procedure\"] = df[\n        [\n            \"surgical_history_2_procedure_main\",\n            \"surgical_history_2_procedure_other\",\n            \"surgical_history_2_procedure_other_text\",\n        ]\n    ].apply(lambda x: \", \".join(x.dropna()), axis=1)\n    df.drop(\n        columns=[\n            \"surgical_history_2_procedure_main\",\n            \"surgical_history_2_procedure_other\",\n            \"surgical_history_2_procedure_other_text\",\n        ],\n        inplace=True,\n    )\n    df[\"surgical_history_3_procedure\"] = df[\n        [\n            \"surgical_history_3_procedure_main\",\n            \"surgical_history_3_procedure_other\",\n            \"surgical_history_3_procedure_other_text\",\n        ]\n    ].apply(lambda x: \", \".join(x.dropna()), axis=1)\n    df.drop(\n        columns=[\n            \"surgical_history_3_procedure_main\",\n            \"surgical_history_3_procedure_other\",\n            \"surgical_history_3_procedure_other_text\",\n        ],\n        inplace=True,\n    )\n\n    df[\"surgical_history_1_procedure\"].replace(\"\", pd.NA, inplace=True)\n    df[\"surgical_history_2_procedure\"].replace(\"\", pd.NA, inplace=True)\n    df[\"surgical_history_3_procedure\"].replace(\"\", pd.NA, inplace=True)\n\n    df[\"steroid_use_1_reason\"] = df[\"steroid_use_1_reason\"].map(\n        {\"1\": \"flare_up\", \"99\": \"other\"}\n    )\n    df[\"steroid_use_1_drug\"] = df[\"steroid_use_1_drug\"].map(\n        {\n            \"8\": \"steroid_enema\",\n            \"9\": \"steroid_suppositories\",\n            \"7\": \"prednisolone\",\n            \"13\": \"budesonide\",\n            \"21\": \"budesonide\",\n            \"20\": \"hydrocortisone\",\n            \"19\": \"methylprednisolone\",\n            \"99\": \"other\",\n        }\n    )\n    df[\"steroid_use_1_frequency\"] = df[\"steroid_use_1_frequency\"].map(\n        {\n            \"1\": \"od\",\n            \"2\": \"bd\",\n            \"3\": \"tds\",\n            \"4\": \"qds\",\n            \"5\": \"once_a_week\",\n            \"6\": \"fortnightly\",\n            \"7\": \"monthly\",\n            \"8\": \"six_weekly\",\n            \"9\": \"eight_weekly\",\n            \"10\": \"three_monthly\",\n            \"11\": \"prn\",\n            \"12\": \"alternate_days\",\n            \"13\": \"six_times_a_day\",\n            \"14\": \"five_times_a_day\",\n            \"99\": \"other\",\n        }\n    )\n    df[\"steroid_use_1_still_taking\"] = df[\"steroid_use_1_still_taking\"].map(\n        {\"1\": \"yes\", \"0\": \"no\"}\n    )\n    df[\"steroid_use_1_reason_stopped\"] = df[\"steroid_use_1_reason_stopped\"].map(\n        {\n            \"1\": \"primary_non_response\",\n            \"2\": \"secondary_non_response\",\n            \"3\": \"significant_dose_change_of_existing_steroid\",\n            \"9\": \"intolerance\",\n            \"7\": \"adverse_effects\",\n            \"10\": \"confirmed_immunogenicity\",\n            \"99\": \"other\",\n        }\n    )\n\n    df[\"steroid_use_2_reason\"] = df[\"steroid_use_2_reason\"].map(\n        {\"1\": \"flare_up\", \"99\": \"other\"}\n    )\n    df[\"steroid_use_2_drug\"] = df[\"steroid_use_2_drug\"].map(\n        {\n            \"8\": \"steroid_enema\",\n            \"9\": \"steroid_suppositories\",\n            \"7\": \"prednisolone\",\n            \"13\": \"budesonide\",\n            \"21\": \"budesonide\",\n            \"20\": \"hydrocortisone\",\n            \"19\": \"methylprednisolone\",\n            \"99\": \"other\",\n        }\n    )\n    df[\"steroid_use_2_frequency\"] = df[\"steroid_use_2_frequency\"].map(\n        {\n            \"1\": \"od\",\n            \"2\": \"bd\",\n            \"3\": \"tds\",\n            \"4\": \"qds\",\n            \"5\": \"once_a_week\",\n            \"6\": \"fortnightly\",\n            \"7\": \"monthly\",\n            \"8\": \"six_weekly\",\n            \"9\": \"eight_weekly\",\n            \"10\": \"three_monthly\",\n            \"11\": \"prn\",\n            \"12\": \"alternate_days\",\n            \"13\": \"six_times_a_day\",\n            \"14\": \"five_times_a_day\",\n            \"99\": \"other\",\n        }\n    )\n    df[\"steroid_use_2_still_taking\"] = df[\"steroid_use_2_still_taking\"].map(\n        {\"1\": \"yes\", \"0\": \"no\"}\n    )\n    df[\"steroid_use_2_reason_stopped\"] = df[\"steroid_use_2_reason_stopped\"].map(\n        {\n            \"1\": \"primary_non_response\",\n            \"2\": \"secondary_non_response\",\n            \"3\": \"significant_dose_change_of_existing_steroid\",\n            \"9\": \"intolerance\",\n            \"7\": \"adverse_effects\",\n            \"10\": \"confirmed_immunogenicity\",\n            \"99\": \"other\",\n        }\n    )\n\n    df[\"new_oral_steroids_since_last_visit\"] = df[\n        \"new_oral_steroids_since_last_visit\"\n    ].map({\"1\": \"yes\", \"0\": \"no\", \"3\": \"ongoing_since_last_visit\"})\n\n    df[\"study_group_name\"] = df[\"study_group_name\"].map(\n        {\n            \"1\": \"cd\",\n            \"2\": \"uc\",\n        }\n    )\n\n    df[\"sex\"] = df[\"sex\"].map(\n        {\n            \"1\": \"male\",\n            \"2\": \"female\",\n        }\n    )\n\n    df[\"smoking_status\"] = df[\"smoking_status\"].map(\n        {\n            \"1\": \"smoker\",\n            \"2\": \"ex_smoker\",\n            \"3\": \"non_smoker\",\n        }\n    )\n\n    df[\"when_smoking_stopped_units\"] = df[\"when_smoking_stopped_units\"].map(\n        {\n            \"1\": \"weeks\",\n            \"2\": \"months\",\n            \"3\": \"years\",\n        }\n    )\n\n    df[\"sccai_general_well_being\"] = df[\"sccai_general_well_being\"].map(\n        {\n            \"0\": \"very_well\",\n            \"1\": \"slightly_below_par\",\n            \"2\": \"poor\",\n            \"3\": \"very_poor\",\n            \"4\": \"terrible\",\n        }\n    )\n\n    df[\"sccai_bowel_frequency_day\"] = df[\"sccai_bowel_frequency_day\"].map(\n        {\"0\": \"0-3\", \"1\": \"4-6\", \"2\": \"7-9\", \"3\": \"&gt;9\"}\n    )\n\n    df[\"sccai_bowel_frequency_night\"] = df[\"sccai_bowel_frequency_night\"].map(\n        {\n            \"0\": \"0\",\n            \"1\": \"1-3\",\n            \"2\": \"4-6\",\n        }\n    )\n\n    df[\"sccai_urgency\"] = df[\"sccai_urgency\"].map(\n        {\n            \"0\": \"none\",\n            \"1\": \"hurry\",\n            \"2\": \"immediately\",\n            \"3\": \"incontinence\",\n        }\n    )\n\n    df[\"sccai_blood_in_stool\"] = df[\"sccai_blood_in_stool\"].map(\n        {\n            \"0\": \"none\",\n            \"1\": \"trace\",\n            \"2\": \"occasionally_frank\",\n            \"3\": \"usually_frank\",\n        }\n    )\n\n    df[\"hbi_abdominal_mass\"] = df[\"hbi_abdominal_mass\"].map(\n        {\n            \"0\": \"none\",\n            \"1\": \"dubious\",\n            \"2\": \"definite\",\n            \"3\": \"definite_and_tender\",\n        }\n    )\n\n    df[\"hbi_general_well_being\"] = df[\"hbi_general_well_being\"].map(\n        {\n            \"0\": \"very_well\",\n            \"1\": \"slightly_below_par\",\n            \"2\": \"poor\",\n            \"3\": \"very_poor\",\n            \"4\": \"terrible\",\n        }\n    )\n\n    df[\"hbi_abdominal_pain\"] = df[\"hbi_abdominal_pain\"].map(\n        {\n            \"0\": \"none\",\n            \"1\": \"mild\",\n            \"2\": \"moderate\",\n            \"3\": \"severe\",\n        }\n    )\n\n    df[\"hbi_liquid_stools_present\"] = df[\"hbi_liquid_stools_present\"].map(\n        {\n            \"0\": \"no\",\n            \"1\": \"yes\",\n        }\n    )\n\n    df[\"mayo_stool_frequency\"] = df[\"mayo_stool_frequency\"].map(\n        {\n            \"0\": \"normal\",\n            \"1\": \"1-2_above_normal\",\n            \"2\": \"3-4_above_normal\",\n            \"3\": \"&gt;5_above_normal\",\n        }\n    )\n\n    df[\"mayo_rectal_bleeding\"] = df[\"mayo_rectal_bleeding\"].map(\n        {\n            \"0\": \"none\",\n            \"1\": \"less_than_half\",\n            \"2\": \"more_than_half\",\n            \"3\": \"blood_alone\",\n        }\n    )\n\n    df[\"mayo_physician_global_assessment\"] = df[\"mayo_physician_global_assessment\"].map(\n        {\n            \"0\": \"normal\",\n            \"1\": \"mild\",\n            \"2\": \"moderate\",\n            \"3\": \"severe\",\n        }\n    )\n\n    df[\"new_flare_up\"] = df[\"new_flare_up\"].map(\n        {\n            \"0\": \"no\",\n            \"1\": \"yes\",\n            \"3\": \"ongoing_from_previous_visit\",\n        }\n    )\n\n    df[\"unplanned_hospital_admission\"] = df[\"unplanned_hospital_admission\"].map(\n        {\n            \"0\": \"no\",\n            \"1\": \"yes\",\n        }\n    )\n\n    df[\"steroid_use_1_reason\"] = df[\"steroid_use_1_reason\"].map(\n        {\n            \"1\": \"flare_up\",\n            \"99\": \"other\",\n        }\n    )\n\n    df[\"redcap_event_name\"] = df[\"redcap_event_name\"].map(\n        {\n            \"timepoint_1_arm_1\": \"timepoint_1\",\n            \"timepoint_2_arm_1\": \"timepoint_2\",\n            \"timepoint_3_arm_1\": \"timepoint_3\",\n            \"timepoint_4_arm_1\": \"timepoint_4\",\n            \"timepoint_5_arm_1\": \"timepoint_5\",\n        }\n    )\n\n    df[\"physician_global_assessment\"] = df[\"physician_global_assessment\"].map(\n        {\n            \"1\": \"remission\",\n            \"2\": \"mild\",\n            \"3\": \"moderate\",\n            \"4\": \"severe\",\n        }\n    )\n\n    df[\"disease_activity\"] = df[\"disease_activity\"].map(\n        {\n            \"1\": \"biochem_remission\",\n            \"2\": \"remission\",\n            \"3\": \"active\",\n            \"4\": \"biochem_active\",\n            \"5\": \"not_applicable\",\n        }\n    )  # this field almost maps to ibd_status in gi-damps but differ in highly_active vs biochem_active\n\n    df[\"change_in_montreal\"] = df[\"change_in_montreal\"].map(\n        {\n            \"0\": \"no\",\n            \"1\": \"yes\",\n        }\n    )\n\n    df[\"montreal_cd_location\"] = df[\"montreal_cd_location\"].map(\n        {\"0\": \"L1\", \"1\": \"L2\", \"2\": \"L3\"}\n    )\n\n    df[\"montreal_cd_behaviour\"] = df[\"montreal_cd_behaviour\"].map(\n        {\"0\": \"B1\", \"1\": \"B2\", \"2\": \"B3\"}\n    )\n\n    df[\"montreal_uc_extent\"] = df[\"montreal_uc_extent\"].map(\n        {\"0\": \"E1\", \"1\": \"E2\", \"2\": \"E3\"}\n    )\n\n    df[\"montreal_uc_severity\"] = df[\"montreal_uc_severity\"].map(\n        {\"0\": \"S0\", \"1\": \"S1\", \"2\": \"S2\", \"3\": \"S3\"}\n    )\n\n    df[\"study_center\"] = df[\"study_id\"].apply(\n        lambda x: \"glasgow\"\n        if \"91-\" in x\n        else (\n            \"dundee\"\n            if \"92-\" in x\n            else (\n                \"edinburgh\" if \"90-\" in x else (\"fate_cd\" if \"191-\" in x else \"unknown\")\n            )\n        )\n    )\n\n    # Data harmonization\n    df.rename(columns={\"study_group_name\": \"study_group\"}, inplace=True)\n    df[\"study_id\"] = df[\"study_id\"].apply(lambda x: f\"MID-{x}\")\n\n    # Endoscopic Mucosal Healing Data\n    # Merge endoscopic scores into single column\n    df[\"sescd_noncalc\"] = pd.to_numeric(df[\"sescd_noncalc\"], errors=\"coerce\")\n    df[\"sescd_calc\"] = df[\"sescd_calc\"].fillna(df[\"sescd_noncalc\"])\n\n    df[\"uceis_noncalc\"] = pd.to_numeric(df[\"uceis_noncalc\"], errors=\"coerce\")\n    df[\"uceis_calc\"] = df[\"uceis_calc\"].fillna(df[\"uceis_noncalc\"])\n\n    df.rename(\n        {\n            \"sescd_calc\": \"sescd\",\n            \"uceis_calc\": \"uceis\",\n            \"mayo_endoscopic_findings\": \"mayo_endoscopic_score\",\n        },\n        axis=1,\n        inplace=True,\n    )\n    df.drop({\"sescd_noncalc\", \"uceis_noncalc\"}, axis=1, inplace=True)\n\n    # Map and rename endo_healing and cmh columns\n\n    df[\"endo_healing\"] = df[\"endo_healing\"].map(\n        {\n            \"1\": \"yes\",\n            \"2\": \"no\",\n        }\n    )\n\n    df[\"cmh\"] = df[\"cmh\"].map({\"1\": \"yes\", \"2\": \"no\", \"3\": \"partial\"})\n\n    df.rename(\n        {\n            \"endo_healing\": \"endoscopic_mucosal_healing\",\n            \"cmh\": \"complete_mucosal_healing\",\n        },\n        axis=1,\n        inplace=True,\n    )\n\n    # Create new columns for endoscopic outcome at 3 months and 12 months\n    # and fill it in timepoint 1 to use for demographics\n\n    timepoint_2_mapping_df = df[df[\"redcap_event_name\"] == \"timepoint_2\"][\n        [\"study_id\", \"endoscopic_mucosal_healing\", \"complete_mucosal_healing\"]\n    ]\n    df[\"endoscopic_mucosal_healing_at_3_6_months\"] = df[\"study_id\"].map(\n        timepoint_2_mapping_df.set_index(\"study_id\")[\"endoscopic_mucosal_healing\"]\n    )\n    df[\"complete_mucosal_healing_at_3_6_months\"] = df[\"study_id\"].map(\n        timepoint_2_mapping_df.set_index(\"study_id\")[\"complete_mucosal_healing\"]\n    )\n\n    timepoint_5_mapping_df = df[df[\"redcap_event_name\"] == \"timepoint_5\"][\n        [\"study_id\", \"endoscopic_mucosal_healing\", \"complete_mucosal_healing\"]\n    ]\n    df[\"endoscopic_mucosal_healing_at_12_months\"] = df[\"study_id\"].map(\n        timepoint_5_mapping_df.set_index(\"study_id\")[\"endoscopic_mucosal_healing\"]\n    )\n    df[\"complete_mucosal_healing_at_12_months\"] = df[\"study_id\"].map(\n        timepoint_5_mapping_df.set_index(\"study_id\")[\"complete_mucosal_healing\"]\n    )\n\n\n    # Ensure df['hbi_liquid_stools'] is numeric\n    df[\"hbi_liquid_stools\"] = pd.to_numeric(df[\"hbi_liquid_stools\"], errors=\"coerce\")\n\n    # Add 3 columns: cd_pro2_raw, cd_pro2_weighted and uc_pro2\n\n    df[\"cd_pro2_raw\"] = df[\"hbi_liquid_stools\"] + df[\"hbi_abdominal_pain\"].map(\n        {\n            \"none\": 0,\n            \"mild\": 1,\n            \"moderate\": 2,\n            \"severe\": 3,\n        }\n    )\n    df[\"cd_pro2_weighted\"] = (\n        df[\"hbi_liquid_stools\"] * 2\n        + df[\"hbi_abdominal_pain\"].map(\n            {\n                \"none\": 0,\n                \"mild\": 1,\n                \"moderate\": 2,\n                \"severe\": 3,\n            }\n        )\n        * 5\n    )\n    df[\"uc_pro2\"] = df[\"mayo_stool_frequency\"].map(\n        {\n            \"normal\": 0,\n            \"1-2_above_normal\": 1,\n            \"3-4_above_normal\": 2,\n            \"&gt;5_above_normal\": 3,\n        }\n    ) + df[\"mayo_rectal_bleeding\"].map(\n        {\n            \"none\": 0,\n            \"less_than_half\": 1,\n            \"more_than_half\": 2,\n            \"blood_alone\": 3,\n        }\n    )\n\n    # For CD criteria - liquid stools \u2265 4 AND abdominal pain is moderate or severe\n    df[\"ibdresponse_criteria_cd_met\"] = (df[\"hbi_liquid_stools\"] &gt;= 4) &amp; (\n        (df[\"hbi_abdominal_pain\"] == \"moderate\")\n        | (df[\"hbi_abdominal_pain\"] == \"severe\")\n    )\n\n    # For UC criteria - stool frequency is \"&gt;5_above_normal\" OR rectal bleeding is not \"none\"\n    df[\"ibdresponse_criteria_uc_met\"] = (\n        df[\"mayo_stool_frequency\"] == \"&gt;5_above_normal\"\n    ) | (df[\"mayo_rectal_bleeding\"] != \"none\")\n\n\n    rows, columns = df.shape\n    context.add_output_metadata(\n        {\n            \"dagster/row_count\": rows,\n            \"column_count\": columns,\n            \"columns\": df.columns.to_list(),\n            \"preview\": MetadataValue.md(df.head(3).to_markdown()),\n        }\n    )\n    return df\n\n\n@asset(\n    description=\"Creates abbreviated music demographics dataframe\", group_name=\"music\"\n)\ndef music_demographics_dataframe(\n    context: AssetExecutionContext,\n    music_cleaned_dataframe: pd.DataFrame,\n) -&gt; pd.DataFrame:\n    df = music_cleaned_dataframe\n\n    demographics_df = df[df[\"redcap_event_name\"] == \"timepoint_1\"]\n\n    demographics_columns = [\n        \"study_id\",\n        \"redcap_event_name\",\n        \"age\",\n        \"sex\",\n        \"study_group\",\n        \"diagnosis_comments\",\n        \"date_of_diagnosis\",\n        \"age_at_diagnosis\",\n        \"smoking_status\",\n        \"when_smoking_stopped\",\n        \"when_smoking_stopped_units\",\n        \"height\",\n        \"weight\",\n        \"bmi\",\n        \"has_active_symptoms\",\n        \"visit_date\",\n        \"physician_global_assessment\",\n        \"disease_activity\",\n        \"symptoms_description\",\n        \"cucq_total\",\n        \"change_in_montreal\",\n        \"disease_activity_score_date\",\n        \"sccai_total\",\n        \"hbi_total\",\n        \"disease_activity_score_comments\",\n        \"mayo_total\",\n        \"montreal_classification_date\",\n        \"montreal_cd_location\",\n        \"montreal_cd_behaviour\",\n        \"montreal_perianal\",\n        \"montreal_upper_gi\",\n        \"montreal_uc_extent\",\n        \"montreal_uc_severity\",\n        \"montreal_classification_comments\",\n        \"baseline_previous_ibd_treatment\",\n        \"baseline_eims_arthralgia\",\n        \"baseline_eims_ank_spon\",\n        \"baseline_eims_erythema_nodosum\",\n        \"baseline_eims_pyoderma\",\n        \"baseline_eims_uveitis\",\n        \"baseline_eims_episcleritis\",\n        \"baseline_eims_none\",\n        \"baseline_eims_iritis_scleritis\",\n        \"baseline_eims_sacroileitis\",\n        \"baseline_eims_conjunctivitis\",\n        \"baseline_eims_angular_cheilitis\",\n        \"baseline_eims_other\",\n        \"baseline_eims_other_text\",\n        \"baseline_surgical_history\",\n        \"endoscopy_prior_to_recruitment_date\",\n        \"endoscopy_prior_to_recruitment_colonoscopy\",\n        \"endoscopy_prior_to_recruitment_flexible_sigmoidoscopy\",\n        \"endoscopy_prior_to_recruitment_report\",\n        \"endoscopy_prior_to_recruitment_mayo_score\",\n        \"endoscopy_prior_to_recruitment_uceis_score\",\n        \"radiology_prior_to_recruitment_date\",\n        \"radiology_prior_to_recruitment_ctap\",\n        \"radiology_prior_to_recruitment_mri_sb\",\n        \"radiology_prior_to_recruitment_mri_pelvis\",\n        \"radiology_prior_to_recruitment_report\",\n        \"histology_prior_to_recruitment_date\",\n        \"histology_prior_to_recruitment_report\",\n        \"surgical_history_number\",\n        \"surgical_history_1_date\",\n        \"surgical_history_1_report\",\n        \"surgical_history_2_date\",\n        \"surgical_history_2_report\",\n        \"surgical_history_3_date\",\n        \"surgical_history_3_report\",\n        \"phenotyping_comments\",\n        \"previous_appendicectomy\",\n        \"previous_tonsillectomy\",\n        \"appendicectomy_age\",\n        \"tonsillectomy_age\",\n        \"pmh_1_start_date\",\n        \"pmh_1_end_date\",\n        \"pmh_1_diagnosis\",\n        \"pmh_2_start_date\",\n        \"pmh_2_end_date\",\n        \"pmh_2_diagnosis\",\n        \"pmh_3_start_date\",\n        \"pmh_3_end_date\",\n        \"pmh_3_diagnosis\",\n        \"pmh_4_start_date\",\n        \"pmh_4_end_date\",\n        \"pmh_4_diagnosis\",\n        \"pmh_5_start_date\",\n        \"pmh_5_end_date\",\n        \"pmh_5_diagnosis\",\n        \"pmh_comments\",\n        \"fh_number_brothers\",\n        \"fh_number_sisters\",\n        \"fh_number_siblings\",\n        \"fh_number_daughters\",\n        \"fh_number_sons\",\n        \"fh_number_children\",\n        \"fh_of_ibd_present\",\n        \"fh_of_ibd_number_affected\",\n        \"fh_1_relationship\",\n        \"fh_1_age_at_diagnosis\",\n        \"fh_1_diagnosis\",\n        \"fh_2_relationship\",\n        \"fh_2_age_at_diagnosis\",\n        \"fh_2_diagnosis\",\n        \"fh_2_diagnosis_other\",\n        \"fh_2_diagnosis_other_text\",\n        \"fh_3_relationship\",\n        \"fh_3_age_at_diagnosis\",\n        \"fh_3_diagnosis\",\n        \"fh_3_diagnosis_other\",\n        \"fh_4_relationship\",\n        \"fh_4_age_at_diagnosis\",\n        \"fh_4_diagnosis\",\n        \"fh_comments\",\n        \"baseline_asa\",\n        \"baseline_mtx\",\n        \"baseline_ifx\",\n        \"baseline_ada\",\n        \"baseline_aza\",\n        \"baseline_mp\",\n        \"baseline_uste\",\n        \"baseline_vedo\",\n        \"baseline_goli\",\n        \"baseline_tofa\",\n        \"baseline_filgo\",\n        \"baseline_risa\",\n        \"surgical_history_1_procedure\",\n        \"surgical_history_2_procedure\",\n        \"surgical_history_3_procedure\",\n        \"sescd\",\n        \"uceis\",\n        \"mayo_endoscopic_score\",\n        \"physician_endoscopic_severity\",\n        \"endoscopic_mucosal_healing_at_3_6_months\",\n        \"complete_mucosal_healing_at_3_6_months\",\n        \"endoscopic_mucosal_healing_at_12_months\",\n        \"complete_mucosal_healing_at_12_months\",\n    ]\n    demographics_df = demographics_df[demographics_columns]\n\n    rows, columns = demographics_df.shape\n    context.add_output_metadata(\n        {\n            \"dagster/row_count\": rows,\n            \"column_count\": columns,\n            \"columns\": demographics_df.columns.to_list(),\n            \"preview\": MetadataValue.md(demographics_df.head().to_markdown()),\n        }\n    )\n\n    return demographics_df\n</code></pre>"}]}